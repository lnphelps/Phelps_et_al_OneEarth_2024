
#Phelps et al shared code: isotopic niches / liveilhood characteristics
rm(list=ls()) #clear environment

```{r}
#import clustered dataset (humans_corr, dom_corr, domenamel_corr, wild_corr)
all_corr_exp<-read.csv("[path]all_corr_exp.csv")

#import livelihood information
livelihood_info<-read.csv(file="[path]0_AppendixA.csv")
```

```{r}

#Load AfriArch data & shapefile
library(rgdal)
library(readxl)
db<-read_excel("[path to AfriArch dataset]",sheet="Compilation")
db<-db[!is.na(db$ID),] #remove entries w/ no ID
mask_of_africa <- shapefile("path to .shp")
mask_of_africa <- mask_of_africa[mask_of_africa$COUNTRY!="Madagascar" & mask_of_africa$COUNTRY!="Comoros" & mask_of_africa$COUNTRY!="Seychelles",] #select continental Africa only

#SITE-BASED AVERAGING OF REPEAT INDIVIDUALS
#average Luyt enamel multiples
todo<-db[db$dup==TRUE & is.na(db$avg_d13C_inorg) & is.na(db$avg_d13C_org) & is.na(db$avg_d15N) & db$`Publication year`==2018 & db$Material_Type=="Enamel",]
todo<-todo[!is.na(todo$ID),]
sites_luyt<-unique(todo$Specimen_ID)
for(i in sites_luyt){
  test<-todo[todo$Specimen_ID==i,]
  db$avg_d13C_inorg[db$Specimen_ID==i]<-mean(test$d13C_inorg)}
###############################
#AVERAGE LUKENYA HILL REPEATS
test<-db[db$Lab_ID=="OxA-37358",]
test<-test[!is.na(test$ID),]
db$dup[db$Lab_ID=="OxA-37358"]<-"suspected-repeat-LUK003"
db$avg_d13C_org[db$Lab_ID=="OxA-37358"]<-mean(test$d13C_org)
db$avg_d15N[db$Lab_ID=="OxA-37358"]<-mean(test$d15N)
db$avg_d13C_inorg[db$Lab_ID=="OxA-37358"]<-mean(test$d13C_inorg)
test<-db[db$Lab_ID=="OxA-37356" | db$Lab_ID=="OxA-37357",]
test<-test[!is.na(test$ID),]
db$dup[db$Lab_ID=="OxA-37356"]<-"suspected-repeat-LUK001"
db$dup[db$Specimen_ID=="LUK001"]<-"suspected-repeat-LUK001"
db$avg_d13C_org[db$Lab_ID=="OxA-37356" | db$Lab_ID=="OxA-37357"]<-mean(test$d13C_org)
db$avg_d15N[db$Lab_ID=="OxA-37356" | db$Lab_ID=="OxA-37357"]<-mean(test$d15N)
db$avg_d13C_inorg[db$Lab_ID=="OxA-37356" | db$Lab_ID=="OxA-37357"]<-mean(test$d13C_inorg)
###############################
#AVERAGE MOLO CAVE REPEATS
test<-db[db$Lab_ID=="OxA-37361",]
test<-test[!is.na(test$ID),]
db$dup[db$Lab_ID=="OxA-37361"]<-"suspected-repeat-OxA-37361"
db$avg_d13C_org[db$Lab_ID=="OxA-37361"]<-mean(test$d13C_org)
db$avg_d13C_inorg[db$Lab_ID=="OxA-37361"]<-mean(test$d13C_inorg)
db$avg_d15N[db$Lab_ID=="OxA-37361"]<-mean(test$d15N)
###############################
#BOM JESUS SHIPWRECK
test<-db[ db$ID >= 1927 & db$ID <= 1948, ]
test<-test[ !is.na(test$ID),]
db$avg_d13C_org[db$ID >= 1927 & db$ID <= 1948]<-mean(test$d13C_org)
db$avg_d13C_inorg[db$ID >= 1927 & db$ID <= 1948]<-mean(test$d13C_inorg)
db$avg_d15N[db$ID >= 1927 & db$ID <= 1948]<-mean(test$d15N)
test<-db[ db$ID >= 1949 & db$ID <= 1959, ]
test<-test[ !is.na(test$ID),]
db$avg_d13C_org[db$ID >= 1949 & db$ID <= 1959]<-mean(test$d13C_org)
db$avg_d13C_inorg[db$ID >= 1949 & db$ID <= 1959]<-mean(test$d13C_inorg)
db$avg_d15N[db$ID >= 1949 & db$ID <= 1959]<-mean(test$d15N)
test<-db[ db$ID >= 1960 & db$ID <= 1968, ]
test<-test[ !is.na(test$ID),]
db$avg_d13C_org[db$ID >= 1960 & db$ID <= 1968]<-mean(test$d13C_org)
db$avg_d13C_inorg[db$ID >= 1960 & db$ID <= 1968]<-mean(test$d13C_inorg)
db$avg_d15N[db$ID >= 1960 & db$ID <= 1968]<-mean(test$d15N)
test<-db[ db$ID >= 1969 & db$ID <= 1973, ]
test<-test[ !is.na(test$ID),]
db$avg_d13C_org[db$ID >= 1969 & db$ID <= 1973]<-mean(test$d13C_org)
db$avg_d13C_inorg[db$ID >= 1969 & db$ID <= 1973]<-mean(test$d13C_inorg)
db$avg_d15N[db$ID >= 1969 & db$ID <= 1973]<-mean(test$d15N)
###############################
#SK400
test<-db[ db$ID >= 2831 & db$ID <= 2846, ]
test<-test[ !is.na(test$ID),]
db$avg_d13C_org[db$ID >= 2831 & db$ID <= 2846]<-mean(test$d13C_org)
db$avg_d13C_inorg[db$ID >= 2831 & db$ID <= 2846]<-mean(test$d13C_inorg)
db$avg_d15N[db$ID >= 2831 & db$ID <= 2846]<-mean(test$d15N)
test<-db[ db$ID >= 2847 & db$ID <= 2859, ]
test<-test[ !is.na(test$ID),]
db$avg_d13C_org[db$ID >= 2847 & db$ID <= 2859]<-mean(test$d13C_org)
db$avg_d13C_inorg[db$ID >= 2847 & db$ID <= 2859]<-mean(test$d13C_inorg)
db$avg_d15N[db$ID >= 2847 & db$ID <= 2859]<-mean(test$d15N)
test<-db[ db$ID >= 2860 & db$ID <= 2872, ]
test<-test[ !is.na(test$ID),]
db$avg_d13C_org[db$ID >= 2860 & db$ID <= 2872]<-mean(test$d13C_org)
db$avg_d13C_inorg[db$ID >= 2860 & db$ID <= 2872]<-mean(test$d13C_inorg)
db$avg_d15N[db$ID >= 2860 & db$ID <= 2872]<-mean(test$d15N)
test<-db[ db$ID >= 2873 & db$ID <= 2888, ]
test<-test[ !is.na(test$ID),]
db$avg_d13C_org[db$ID >= 2873 & db$ID <= 2888]<-mean(test$d13C_org)
db$avg_d13C_inorg[db$ID >= 2873 & db$ID <= 2888]<-mean(test$d13C_inorg)
db$avg_d15N[db$ID >= 2873 & db$ID <= 2888]<-mean(test$d15N)
test<-db[ db$ID >= 2889 & db$ID <= 2902, ]
test<-test[ !is.na(test$ID),]
db$avg_d13C_org[db$ID >= 2889 & db$ID <= 2902]<-mean(test$d13C_org)
db$avg_d13C_inorg[db$ID >= 2889 & db$ID <= 2902]<-mean(test$d13C_inorg)
db$avg_d15N[db$ID >= 2889 & db$ID <= 2902]<-mean(test$d15N)
test<-db[ db$ID >= 2903 & db$ID <= 2916, ]
test<-test[ !is.na(test$ID),]
db$avg_d13C_org[db$ID >= 2903 & db$ID <= 2916]<-mean(test$d13C_org)
db$avg_d13C_inorg[db$ID >= 2903 & db$ID <= 2916]<-mean(test$d13C_inorg)
db$avg_d15N[db$ID >= 2903 & db$ID <= 2916]<-mean(test$d15N)
test<-db[ db$ID >= 2917 & db$ID <= 2932, ]
test<-test[ !is.na(test$ID),]
db$avg_d13C_org[db$ID >= 2917 & db$ID <= 2932]<-mean(test$d13C_org)
db$avg_d13C_inorg[db$ID >= 2917 & db$ID <= 2932]<-mean(test$d13C_inorg)
db$avg_d15N[db$ID >= 2917 & db$ID <= 2932]<-mean(test$d15N)
test<-db[ db$ID >= 2933 & db$ID <= 2947, ]
test<-test[ !is.na(test$ID),]
db$avg_d13C_org[db$ID >= 2933 & db$ID <= 2947]<-mean(test$d13C_org)
db$avg_d13C_inorg[db$ID >= 2933 & db$ID <= 2947]<-mean(test$d13C_inorg)
db$avg_d15N[db$ID >= 2933 & db$ID <= 2947]<-mean(test$d15N)
test<-db[ db$ID >= 2948 & db$ID <= 2957, ]
test<-test[ !is.na(test$ID),]
db$avg_d13C_org[db$ID >= 2948 & db$ID <= 2957]<-mean(test$d13C_org)
db$avg_d13C_inorg[db$ID >= 2948 & db$ID <= 2957]<-mean(test$d13C_inorg)
db$avg_d15N[db$ID >= 2948 & db$ID <= 2957]<-mean(test$d15N)
###############################
#AVERAGE MEZBER
test<-db[db$Specimen_ID=="A1.60.111 #1566" & db$Taxon == "Bos taurus",]
test<-test[!is.na(test$ID),]
db$dup[db$Specimen_ID=="A1.60.111 #1566" & db$Taxon == "Bos taurus"]<-"potential-repeat-individual-A1.60.111 #1566-cattle"
test<-db[db$Specimen_ID=="A1.60.111 #1566" & db$Taxon == "Ovis aries",]
test<-test[!is.na(test$ID),]
db$dup[db$Specimen_ID=="A1.60.111 #1566" & db$Taxon == "Ovis aries"]<-"potential-repeat-individual-A1.60.111 #1566-sheep"
###############################
#WADI HALFA 
db$Specimen_ID[db$Site == "Wadi Halfa"]<-c("Group1","Group2","Group3")
db$dup[db$Site == "Wadi Halfa"]<-FALSE
###############################
#KELLIS
test<-db[db$Site=="Kellis",]
db<-db[db$ID!=3887,]
db<-db[db$ID!=3888,]
db<-db[db$ID!=3891,]
db<-db[db$ID!=3895,]
db<-db[db$ID!=3898,]
db<-db[db$ID!=3901,]
db<-db[db$ID!=3905,]
db<-db[db$ID!=3908,]
db<-db[db$ID!=3911,]
db<-db[db$ID!=3914,]
db<-db[db$ID!=3920,]
db<-db[db$ID!=3923,]
db<-db[db$ID!=3926,]
db<-db[db$ID!=3929,]
db<-db[db$ID!=3934,]
db<-db[db$ID!=3938,]
db<-db[db$ID!=3945,]
db<-db[db$ID!=3917,]
db<-db[db$ID!=3963,]
db<-db[db$ID!=3965,]
db<-db[db$ID!=3967,]
db<-db[db$ID!=4211,]
db<-db[db$ID!=4165,]
db<-db[db$ID!=4200,]
db<-db[db$ID!=4214,]
db<-db[db$ID!=4220,]
db<-db[db$ID!=4233,]
db<-db[db$ID!=4236,]
db<-db[db$ID!=4239,]
db<-db[db$ID!=4242,]
db<-db[db$ID!=4296,]
db<-db[db$ID!=4316,]
db<-db[db$ID!=4319,]
db<-db[db$ID!=4338,]
db<-db[db$ID!=4345,]
carousel = c("(02) Body D","(02) Body P","(03) Body A","(03) Body B","(03) Body D","(03) Body H","(03) Body J","(03) Body K","(03) Body N1","(03) Body N2","(03) Leg O", "(04) Body E","(08) Body 04","(12) Body 01","(13) Body 02","(13) Body 07","B045","B046","B047","B051","B057","B059T","B063T","B064T","B069T","B070T","B071T","B073T","B079T","B080T","B081T","B086T","B091T","B094T","B095T","B097T","B103T","B107T","B108T","B115T","B131","B138","B149","B155","B159","B168","B189","B043","B044","B049","B050","B052","B053","B058","B132","B143","B170","B177","B187","B190","B191","B192","B213","B220","B228","B019","B021","B026","B064","B081","B091","B097","B107","B265","B269","B271","B279","B310","B370","B015","B022","B023","B024","B056","B089","B104","B113T","B147","B197","B204","B222","B239","B240","B243","B249","B260","B261","B275","B276","B278","B280","B281","B282","B284","B288","B289","B291","B293","B295","B299","B302","B305","B306","B307","B309","B314","B318A","B321","B327","B328","B330","B334","B335","B336","B347","B349","B356","B357","B358","B360","B362","B374","B388","B393","B396","B402","B410","B412","B426","B430","B431","B434","B437","B457","B460","B461","B463","B466","B467","B468","B469","B487","B488","B490","B506","B511","B512","B513A","B519","B520","B528","B534","B538","B543","B560","B562","B571","B577","B579","B582","B583A","B583B","B584","B587","B593A","B596","B599","B600","B602","B603","B605","B606","B608","B609","B619","B620","B621","B624","B626","B628")

for(i in carousel){
test<-db[db$Site=="Kellis" & db$Specimen_ID==i & db$Material_Type=="Hair",]
test<-test[!is.na(test$ID),]
db$avg_d13C_org[db$Site=="Kellis" & db$Specimen_ID== i & db$Material_Type=="Hair"]<-mean(test$d13C_org)
db$avg_d13C_inorg[db$Site=="Kellis" & db$Specimen_ID==i & db$Material_Type=="Hair"]<-mean(test$d13C_inorg)
db$avg_d15N[db$Site=="Kellis" & db$Specimen_ID==i & db$Material_Type=="Hair"]<-mean(test$d15N)
test<-db[db$Site=="Kellis" & db$Specimen_ID==i & db$Material_Type=="Skin",]
test<-test[!is.na(test$ID),]
db$avg_d13C_org[db$Site=="Kellis" & db$Specimen_ID== i & db$Material_Type=="Skin"]<-mean(test$d13C_org)
db$avg_d13C_inorg[db$Site=="Kellis" & db$Specimen_ID==i & db$Material_Type=="Skin"]<-mean(test$d13C_inorg)
db$avg_d15N[db$Site=="Kellis" & db$Specimen_ID==i & db$Material_Type=="Skin"]<-mean(test$d15N)
test<-db[db$Site=="Kellis" & db$Specimen_ID==i & db$Material_Type=="Nail",]
test<-test[!is.na(test$ID),]
db$avg_d13C_org[db$Site=="Kellis" & db$Specimen_ID== i & db$Material_Type=="Nail"]<-mean(test$d13C_org)
db$avg_d13C_inorg[db$Site=="Kellis" & db$Specimen_ID==i & db$Material_Type=="Nail"]<-mean(test$d13C_inorg)
db$avg_d15N[db$Site=="Kellis" & db$Specimen_ID==i & db$Material_Type=="Nail"]<-mean(test$d15N)
test<-db[db$Site=="Kellis" & db$Specimen_ID==i & db$Material_Type=="Tooth",]
test<-test[!is.na(test$ID),]
db$avg_d13C_org[db$Site=="Kellis" & db$Specimen_ID== i & db$Material_Type=="Tooth"]<-mean(test$d13C_org)
db$avg_d13C_inorg[db$Site=="Kellis" & db$Specimen_ID==i & db$Material_Type=="Tooth"]<-mean(test$d13C_inorg)
db$avg_d15N[db$Site=="Kellis" & db$Specimen_ID==i & db$Material_Type=="Tooth"]<-mean(test$d15N)
test<-db[db$Site=="Kellis" & db$Specimen_ID==i & db$Material_Type=="Bone",]
test<-test[!is.na(test$ID),]
db$avg_d13C_org[db$Site=="Kellis" & db$Specimen_ID== i & db$Material_Type=="Bone"]<-mean(test$d13C_org)
db$avg_d13C_inorg[db$Site=="Kellis" & db$Specimen_ID==i & db$Material_Type=="Bone"]<-mean(test$d13C_inorg)
db$avg_d15N[db$Site=="Kellis" & db$Specimen_ID==i & db$Material_Type=="Bone"]<-mean(test$d15N)}
#
#B168
db$dup[db$ID==4187 & db$Specimen_ID =="B168"]<-"C:N ratio only"
test<-db[db$Site=="Kellis" & db$Specimen_ID=="B168" & db$Material_Type=="Hair",]
test<-test[!is.na(test$ID),]
db$avg_d13C_org[db$Site=="Kellis" & db$Specimen_ID=="B168" & db$Material_Type=="Hair"]<-mean(test$d13C_org[!is.na(test$d13C_org)])
db$avg_d13C_inorg[db$Site=="Kellis" & db$Specimen_ID=="B168" & db$Material_Type=="Hair"]<-mean(test$d13C_inorg)
db$avg_d15N[db$Site=="Kellis" & db$Specimen_ID=="B168" & db$Material_Type=="Hair"]<-mean(test$d15N[!is.na(test$d15N)])
#B190
db$dup[db$ID==4305 & db$Specimen_ID =="B190"]<-"C:N ratio only"
db$dup[db$ID==4306 & db$Specimen_ID =="B190"]<-"C:N ratio only"
db$dup[db$ID==4307 & db$Specimen_ID =="B190"]<-"C:N ratio only"
test<-db[db$Site=="Kellis" & db$Specimen_ID=="B190" & db$Material_Type=="Hair",]
test<-test[!is.na(test$ID),]
db$avg_d13C_org[db$Site=="Kellis" & db$Specimen_ID=="B190" & db$Material_Type=="Hair"]<-mean(test$d13C_org[!is.na(test$d13C_org)])
db$avg_d13C_inorg[db$Site=="Kellis" & db$Specimen_ID=="B190" & db$Material_Type=="Hair"]<-mean(test$d13C_inorg)
db$avg_d15N[db$Site=="Kellis" & db$Specimen_ID=="B190" & db$Material_Type=="Hair"]<-mean(test$d15N[!is.na(test$d15N)])
#B069T
test<-db[db$Site=="Kellis" & db$Specimen_ID=="B069T" & db$Material_Type=="Hair",]
test<-test[!is.na(test$ID),]
db$dup[db$Site=="Kellis" & db$Specimen_ID=="B069T" & db$Material_Type=="Hair"]<-"C:N ratio only"
#B064T
test<-db[db$Site=="Kellis" & db$Specimen_ID=="B064T" & db$Material_Type=="Hair",]
test<-test[!is.na(test$ID),]
db$dup[db$Site=="Kellis" & db$Specimen_ID=="B064T" & db$Material_Type=="Hair"]<-"C:N ratio only"
#B070T
test<-db[db$Site=="Kellis" & db$Specimen_ID=="B070T" & db$Material_Type=="Hair",]
test<-test[!is.na(test$ID),]
db$dup[db$Site=="Kellis" & db$Specimen_ID=="B070T" & db$Material_Type=="Hair"]<-"C:N ratio only"
#B071T
test<-db[db$Site=="Kellis" & db$Specimen_ID=="B071T" & db$Material_Type=="Hair",]
test<-test[!is.na(test$ID),]
db$dup[db$Site=="Kellis" & db$Specimen_ID=="B071T" & db$Material_Type=="Hair"]<-"C:N ratio only"
#B220
test<-db[db$Site=="Kellis" & db$Specimen_ID=="B220",]
test<-test[!is.na(test$ID),]
db$dup[db$Site=="Kellis" & db$Specimen_ID=="B220"]<-"separate_enamel_bone"
test<-db[db$Site=="Kellis" & is.na(db$Specimen_ID),]
test<-test[!is.na(test$ID),]
db$Specimen_ID[db$Site=="Kellis" & db$ID==3853]<-"NA1"
db$Specimen_ID[db$Site=="Kellis" & db$ID==3854]<-"NA2"
db$Specimen_ID[db$Site=="Kellis" & db$ID==3855]<-"NA3"
db$Specimen_ID[db$Site=="Kellis" & db$ID==3856]<-"NA4"
db$Specimen_ID[db$Site=="Kellis" & db$ID==3857]<-"NA5"
db$Specimen_ID[db$Site=="Kellis" & db$ID==3858]<-"NA6"
db$Specimen_ID[db$Site=="Kellis" & db$ID==3859]<-"NA7"
db$Specimen_ID[db$Site=="Kellis" & db$ID==3860]<-"NA8"
db$Specimen_ID[db$Site=="Kellis" & db$ID==3861]<-"NA9"
db$Specimen_ID[db$Site=="Kellis" & db$ID==3862]<-"NA10"
db$Specimen_ID[db$Site=="Kellis" & db$ID==3863]<-"NA11"
db$Specimen_ID[db$Site=="Kellis" & db$ID==3864]<-"NA12"
db$Specimen_ID[db$Site=="Kellis" & db$ID==3865]<-"NA13"
db$Specimen_ID[db$Site=="Kellis" & db$ID==3866]<-"NA14"
db$Specimen_ID[db$Site=="Kellis" & db$ID==3867]<-"NA15"
db$Specimen_ID[db$Site=="Kellis" & db$ID==3868]<-"NA16"
db$Specimen_ID[db$Site=="Kellis" & db$ID==3869]<-"NA17"
db$Specimen_ID[db$Site=="Kellis" & db$ID==3870]<-"NA18"
db$Specimen_ID[db$Site=="Kellis" & db$ID==3871]<-"NA19"
db$Specimen_ID[db$Site=="Kellis" & db$ID==3872]<-"NA20"
db$Specimen_ID[db$Site=="Kellis" & db$ID==3873]<-"NA21"
db$Specimen_ID[db$Site=="Kellis" & db$ID==3874]<-"NA22"
db$Specimen_ID[db$Site=="Kellis" & db$ID==3875]<-"NA23"
db$Specimen_ID[db$Site=="Kellis" & db$ID==3876]<-"NA24"
db$Specimen_ID[db$Site=="Kellis" & db$ID==3877]<-"NA25"
db$Specimen_ID[db$Site=="Kellis" & db$ID==3878]<-"NA26"
db$Specimen_ID[db$Site=="Kellis" & db$ID==3879]<-"NA27"
db$Specimen_ID[db$Site=="Kellis" & db$ID==3880]<-"NA28"
db$Specimen_ID[db$Site=="Kellis" & db$ID==3881]<-"NA29"
db$Specimen_ID[db$Site=="Kellis" & db$ID==3882]<-"NA30"
db$Specimen_ID[db$Site=="Kellis" & db$ID==3883]<-"NA31"
db$Specimen_ID[db$Site=="Kellis" & db$ID==3884]<-"NA32"
db$Specimen_ID[db$Site=="Kellis" & db$ID==3885]<-"NA33"
db$Specimen_ID[db$Site=="Kellis" & db$ID==3886]<-"NA34"
for(i in c(3853:3886)){ db$dup[db$ID==i]<-FALSE }
#########################
#FALSE BAY
test<-db[db$Site=="False Bay" & db$Specimen_ID=="unspecified",]
test<-test[!is.na(test$ID),]
db$dup[db$Site %in% test$Site]<-"assumed_individual"
###############################
#GOURNAH
db<-db[db$ID!=5445,]
db<-db[db$ID!=5458,]
db<-db[db$ID!=5463,]
db<-db[db$ID!=5438,]
db<-db[db$ID!=5440,]
db<-db[db$ID!=5442,]
db<-db[db$ID!=5446,]
db<-db[db$ID!=5448,]
db<-db[db$ID!=5450,]
db<-db[db$ID!=5453,]
db<-db[db$ID!=5455,]
db<-db[db$ID!=5457,]
db<-db[db$ID!=5470,]
db<-db[db$ID!=5471,]
db<-db[db$ID!=5472,]
carousel=c("30000158","30000160","90001244","30000163","30000164","30000162","30000118","30000196","30000169","30000197","30000241","30000248","30000157","30000159","30000291","30000292","30000238")
for(i in carousel){
test<-db[db$Site=="Gournah" & db$Specimen_ID==i & db$Material_Type=="Hair",]
test<-test[!is.na(test$ID),]
db$avg_d13C_org[db$Site=="Gournah" & db$Specimen_ID== i & db$Material_Type=="Hair"]<-mean(test$d13C_org)
db$avg_d13C_inorg[db$Site=="Gournah" & db$Specimen_ID==i & db$Material_Type=="Hair"]<-mean(test$d13C_inorg)
db$avg_d15N[db$Site=="Gournah" & db$Specimen_ID==i & db$Material_Type=="Hair"]<-mean(test$d15N)
test<-db[db$Site=="Gournah" & db$Specimen_ID==i & db$Material_Type=="Skin",]
test<-test[!is.na(test$ID),]
db$avg_d13C_org[db$Site=="Gournah" & db$Specimen_ID== i & db$Material_Type=="Skin"]<-mean(test$d13C_org)
db$avg_d13C_inorg[db$Site=="Gournah" & db$Specimen_ID==i & db$Material_Type=="Skin"]<-mean(test$d13C_inorg)
db$avg_d15N[db$Site=="Gournah" & db$Specimen_ID==i & db$Material_Type=="Skin"]<-mean(test$d15N)
test<-db[db$Site=="Gournah" & db$Specimen_ID==i & db$Material_Type=="Nail",]
test<-test[!is.na(test$ID),]
db$avg_d13C_org[db$Site=="Gournah" & db$Specimen_ID== i & db$Material_Type=="Nail"]<-mean(test$d13C_org)
db$avg_d13C_inorg[db$Site=="Gournah" & db$Specimen_ID==i & db$Material_Type=="Nail"]<-mean(test$d13C_inorg)
db$avg_d15N[db$Site=="Gournah" & db$Specimen_ID==i & db$Material_Type=="Nail"]<-mean(test$d15N)
test<-db[db$Site=="Gournah" & db$Specimen_ID==i & db$Material_Type=="Tooth",]
test<-test[!is.na(test$ID),]
db$avg_d13C_org[db$Site=="Gournah" & db$Specimen_ID== i & db$Material_Type=="Tooth"]<-mean(test$d13C_org)
db$avg_d13C_inorg[db$Site=="Gournah" & db$Specimen_ID==i & db$Material_Type=="Tooth"]<-mean(test$d13C_inorg)
db$avg_d15N[db$Site=="Gournah" & db$Specimen_ID==i & db$Material_Type=="Tooth"]<-mean(test$d15N)
test<-db[db$Site=="Gournah" & db$Specimen_ID==i & db$Material_Type=="Bone",]
test<-test[!is.na(test$ID),]
db$avg_d13C_org[db$Site=="Gournah" & db$Specimen_ID== i & db$Material_Type=="Bone"]<-mean(test$d13C_org)
db$avg_d13C_inorg[db$Site=="Gournah" & db$Specimen_ID==i & db$Material_Type=="Bone"]<-mean(test$d13C_inorg)
db$avg_d15N[db$Site=="Gournah" & db$Specimen_ID==i & db$Material_Type=="Bone"]<-mean(test$d15N)}
#30000158
test<-db[db$Site=="Gournah" & db$Specimen_ID==30000158 & db$Material_Type=="Bone",]
db$avg_d13C_org[db$Site=="Gournah" & db$Specimen_ID==30000158 & db$Material_Type=="Bone"]<-mean(test$d13C_org)
db$avg_d13C_inorg[db$Site=="Gournah" & db$Specimen_ID==30000158 & db$Material_Type=="Bone"]<-mean(test$d13C_inorg)
db$avg_d15N[db$Site=="Gournah" & db$Specimen_ID==30000158 & db$Material_Type=="Bone"]<-mean(test$d15N)
#30000160
test<-db[db$Site=="Gournah" & db$Specimen_ID==30000160 & db$Material_Type=="Bone",]
db$avg_d13C_org[db$Site=="Gournah" & db$Specimen_ID==30000160 & db$Material_Type=="Bone"]<-mean(test$d13C_org)
db$avg_d13C_inorg[db$Site=="Gournah" & db$Specimen_ID==30000160 & db$Material_Type=="Bone"]<-mean(test$d13C_inorg)
db$avg_d15N[db$Site=="Gournah" & db$Specimen_ID==30000160 & db$Material_Type=="Bone"]<-mean(test$d15N)
#90001244
test<-db[db$Site=="Gournah" & db$Specimen_ID==90001244,]
db$avg_d13C_org[db$Site=="Gournah" & db$Specimen_ID==90001244]<-mean(test$d13C_org)
db$avg_d13C_inorg[db$Site=="Gournah" & db$Specimen_ID==90001244]<-mean(test$d13C_inorg)
db$avg_d15N[db$Site=="Gournah" & db$Specimen_ID==90001244]<-mean(test$d15N)
###############################
#JENNE-JENO
test<-db[db$Site=="Jenne-jeno" & db$Specimen_ID=="J-j L34",]
db$avg_d13C_org[db$Site=="Jenne-jeno" & db$Specimen_ID=="J-j L34"]<-mean(test$d13C_org)
db$avg_d13C_inorg[db$Site=="Jenne-jeno" & db$Specimen_ID=="J-j L34"]<-mean(test$d13C_inorg)
db$avg_d15N[db$Site=="Jenne-jeno" & db$Specimen_ID=="J-j L34"]<-mean(test$d15N)
test<-db[db$Site=="Jenne-jeno" & db$Specimen_ID=="J-j F21",]
db$avg_d13C_org[db$Site=="Jenne-jeno" & db$Specimen_ID=="J-j F21"]<-mean(test$d13C_org)
db$avg_d13C_inorg[db$Site=="Jenne-jeno" & db$Specimen_ID=="J-j F21"]<-mean(test$d13C_inorg)
db$avg_d15N[db$Site=="Jenne-jeno" & db$Specimen_ID=="J-j F21"]<-mean(test$d15N)
test<-db[db$Site=="Jenne-jeno" & db$Specimen_ID=="J-j L27",]
db$avg_d13C_org[db$Site=="Jenne-jeno" & db$Specimen_ID=="J-j L27"]<-mean(test$d13C_org)
db$avg_d13C_inorg[db$Site=="Jenne-jeno" & db$Specimen_ID=="J-j L27"]<-mean(test$d13C_inorg)
db$avg_d15N[db$Site=="Jenne-jeno" & db$Specimen_ID=="J-j L27"]<-mean(test$d15N)
###############################
#KATOTO
carousel=c("T11","T13","T21A","T21B","T21C","T25","T26","T37","T48","T49","T50","T63","T64") 
for(i in carousel){
test<-db[db$Site=="Katoto" & db$Specimen_ID==i,]
test<-test[!is.na(test$ID),]
db$avg_d13C_org[db$Site=="Katoto" & db$Specimen_ID== i]<-mean(test$d13C_org)
db$avg_d13C_inorg[db$Site=="Katoto" & db$Specimen_ID==i]<-mean(test$d13C_inorg)
db$avg_d15N[db$Site=="Katoto" & db$Specimen_ID==i]<-mean(test$d15N)}
###############################
#FALSE BAY
db$dup[db$Site=="False Bay" & db$Specimen_ID=="unspecified"]<-"assumed_modern_individual"
###############################
#KHAMI
carousel=c("KNPM110","KM1095") 
for(i in carousel){
test<-db[db$Site=="Khami" & db$Specimen_ID==i & db$Material_Type=="Bone",]
test<-test[!is.na(test$ID),]
db$avg_d13C_org[db$Site=="Khami" & db$Specimen_ID== i & db$Material_Type=="Bone"]<-mean(test$d13C_org)
db$avg_d13C_inorg[db$Site=="Khami" & db$Specimen_ID==i & db$Material_Type=="Bone"]<-mean(test$d13C_inorg)
db$avg_d15N[db$Site=="Khami" & db$Specimen_ID==i & db$Material_Type=="Bone"]<-mean(test$d15N)
test<-db[db$Site=="Khami" & db$Specimen_ID==i & db$Material_Type=="Dentine",]
test<-test[!is.na(test$ID),]
db$avg_d13C_org[db$Site=="Khami" & db$Specimen_ID== i & db$Material_Type=="Dentine"]<-mean(test$d13C_org)
db$avg_d13C_inorg[db$Site=="Khami" & db$Specimen_ID==i & db$Material_Type=="Dentine"]<-mean(test$d13C_inorg)
db$avg_d15N[db$Site=="Khami" & db$Specimen_ID==i & db$Material_Type=="Dentine"]<-mean(test$d15N)}
###############################
#KHOZAN
db<-db[db$ID!=5483,]
db<-db[db$ID!=5484,]
db<-db[db$ID!=5485,]
###############################
#MATJES RIVER ROCKS SHELTER
db$Specimen_ID[db$ID==1007]<-"M (juvenile) - UCT 9152"
db$Specimen_ID[db$ID==1020]<-"M (juvenile) - UCT 9824"
db$dup[db$ID==1007]<-FALSE
db$dup[db$ID==1020]<-FALSE
###############################
#TAKARKORI ROCK SHELTER
test<-db[db$Site=="Takarkori Rock Shelter" & db$Specimen_ID=="RS H1",]
test<-test[!is.na(test$ID),]
db$avg_d13C_org[db$Site=="Takarkori Rock Shelter" & db$Specimen_ID== "RS H1"]<-mean(test$d13C_org)
db$avg_d13C_inorg[db$Site=="Takarkori Rock Shelter" & db$Specimen_ID=="RS H1"]<-mean(test$d13C_inorg)
db$avg_d15N[db$Site=="Takarkori Rock Shelter" & db$Specimen_ID=="RS H1"]<-mean(test$d15N[!is.na(test$d15N)])
test<-db[db$Site=="Takarkori Rock Shelter" & db$Specimen_ID=="RS H5",]
test<-test[!is.na(test$ID),]
db$avg_d13C_org[db$Site=="Takarkori Rock Shelter" & db$Specimen_ID== "RS H5"]<-mean(test$d13C_org)
db$avg_d13C_inorg[db$Site=="Takarkori Rock Shelter" & db$Specimen_ID=="RS H5"]<-mean(test$d13C_inorg)
db$avg_d15N[db$Site=="Takarkori Rock Shelter" & db$Specimen_ID=="RS H5"]<-mean(test$d15N[!is.na(test$d15N)])
test<-db[db$Site=="Takarkori Rock Shelter" & db$Specimen_ID=="RS H9",]
test<-test[!is.na(test$ID),]
db$avg_d13C_org[db$Site=="Takarkori Rock Shelter" & db$Specimen_ID== "RS H9"]<-mean(test$d13C_org)
db$avg_d13C_inorg[db$Site=="Takarkori Rock Shelter" & db$Specimen_ID=="RS H9"]<-mean(test$d13C_inorg)
db$avg_d15N[db$Site=="Takarkori Rock Shelter" & db$Specimen_ID=="RS H9"]<-mean(test$d15N[!is.na(test$d15N)])
###############################
#TATO A SANOUNA
test<-db[db$Site=="Tato a Sanouna" & db$Specimen_ID=="TaS L18",]
test<-test[!is.na(test$ID),]
db$avg_d13C_org[db$Site=="Tato a Sanouna" & db$Specimen_ID== "TaS L18"]<-mean(test$d13C_org)
db$avg_d13C_inorg[db$Site=="Tato a Sanouna" & db$Specimen_ID=="TaS L18"]<-mean(test$d13C_inorg)
db$avg_d15N[db$Site=="Tato a Sanouna" & db$Specimen_ID=="TaS L18"]<-mean(test$d15N)
###############################
#RODA
test<-db[db$Site=="Roda" & db$Specimen_ID=="90002402",]
test<-test[!is.na(test$ID),]
db<-db[db$ID!=5333,]
test<-db[db$Site=="Roda" & db$Specimen_ID=="90001252",]
test<-test[!is.na(test$ID),]
db<-db[db$ID!=5334,]
###############################
#SANGA
test<-db[db$Site=="Sanga" & db$Specimen_ID=="T42",]
test<-test[!is.na(test$ID),]
db$avg_d13C_org[db$Site=="Sanga" & db$Specimen_ID== "T42"]<-mean(test$d13C_org)
db$avg_d13C_inorg[db$Site=="Sanga" & db$Specimen_ID=="T42"]<-mean(test$d13C_inorg)
db$avg_d15N[db$Site=="Sanga" & db$Specimen_ID=="T42"]<-mean(test$d15N)
test<-db[db$Site=="Sanga" & db$Specimen_ID=="T58",]
test<-test[!is.na(test$ID),]
db$avg_d13C_org[db$Site=="Sanga" & db$Specimen_ID== "T58"]<-mean(test$d13C_org)
db$avg_d13C_inorg[db$Site=="Sanga" & db$Specimen_ID=="T58"]<-mean(test$d13C_inorg)
db$avg_d15N[db$Site=="Sanga" & db$Specimen_ID=="T58"]<-mean(test$d15N)
###############################
#THEBES
test<-db[db$Site=="Thebes" & db$Specimen_ID=="30000139",]
test<-test[!is.na(test$ID),]
db<-db[db$ID!=5475,]
test<-db[db$Site=="Thebes" & db$Specimen_ID=="30000161",]
test<-test[!is.na(test$ID),]
db<-db[db$ID!=5477,]
###############################
#EQUID SITE
db$dup[db$Site=="Equid Site" & db$Specimen_ID=="KC12-14AE"]<-FALSE
###############################
#LOTHAGAM LOKAM
db$dup[db$Site=="Lothagam Lokam" & db$Specimen_ID=="KKC11-21"]<-FALSE
db$dup[db$Site=="Lothagam Lokam" & db$Specimen_ID=="KKC11-25"]<-FALSE
###############################
#LEPTIMINUS (humans)
db<-db[db$ID!=3669 & db$ID!=3674 & db$ID!=3677 & db$ID!=3684 & db$ID!=3686 & db$ID!= 3689 &
       db$ID!=3692 & db$ID!= 3694 & db$ID!= 3702 & db$ID!= 3699 & db$ID!= 3704 & db$ID!= 3706 & db$ID!= 3708 &
       db$ID!= 3713 & db$ID!= 3715 & db$ID!= 3717 & db$ID!= 3719 & db$ID!= 3721 & db$ID!= 3723 & db$ID!= 3725 &
       db$ID!= 3727 & db$ID!= 3729 & db$ID!= 3731 & db$ID!= 3733 & db$ID!= 3735 & db$ID!= 3737 & db$ID!= 3739 &
       db$ID!= 3741 & db$ID!= 3743 & db$ID!= 3745 & db$ID!= 3747 & db$ID!= 3749 & db$ID!= 3751 & db$ID!= 3753 &
       db$ID!= 3755 & db$ID!= 3757 & db$ID!= 3760 & db$ID!= 3762 & db$ID!= 3764 & db$ID!= 3766 & db$ID!= 3769 & 
       db$ID!= 3771 & db$ID!= 3676 & db$ID!= 3682 & db$ID!= 3688 & db$ID!= 3696 & db$ID!= 3697 & db$ID!= 3773 & 
       db$ID!= 3775 & db$ID!= 3777 & db$ID!= 3779 & db$ID!= 3781 & db$ID!= 3783 & db$ID!= 3785 & db$ID!= 3787 &          db$ID!= 3789 & db$ID!= 3791 & db$ID!= 3793 & db$ID!= 3795 & db$ID!= 3797 & db$ID!= 3799 & db$ID!= 3801 &          db$ID!= 3804 & db$ID!= 3806 & db$ID!= 3808 & db$ID!= 3810 & db$ID!= 3812 & db$ID!= 3813 & db$ID!= 3814 &          db$ID!= 3815 & db$ID!= 3816 & db$ID!= 3818 & db$ID!= 3820 & db$ID!= 3822 & db$ID!= 3824 & db$ID!= 3826 &          db$ID!= 3828 & db$ID!= 3830 & db$ID!= 3832 & db$ID!= 3834 & db$ID!= 3836 & db$ID!= 3838 & db$ID!= 3840 &          db$ID!= 3842,]
db<-db[db$ID!=3671,]
db$dup[db$Site=="Leptiminus" & db$Specimen_ID==78]<-FALSE
  #133: 13C(ap) = human bone carbonate; 13C(co) = collagen samples: which to use?
db<-db[db$ID!=3672,]
db$dup[db$Site=="Leptiminus" & db$Specimen_ID==133]<-FALSE
db$Specimen_ID[db$ID==3668]<-"2_caprine"
db$Specimen_ID[db$ID==3756]<-"2_human"
db$Specimen_ID[db$ID==3665]<-"7_pig"
db$Specimen_ID[db$ID==3761]<-"7_human"
db$Specimen_ID[db$ID==3661]<-"10_goat"
db$Specimen_ID[db$ID==3763]<-"10_human"
db$Specimen_ID[db$ID==3662]<-"16_equid"
db$Specimen_ID[db$ID==3770]<-"16_human"
todo<-db[db$dup==TRUE & is.na(db$avg_d13C_inorg) & is.na(db$avg_d13C_org) & is.na(db$avg_d15N),]
todo<-todo[!is.na(todo$ID),]
unique(todo$Specimen_ID[todo$Site=="Leptiminus"])
#
#remove false duplicates
carousel= c("181","3067","3247","3270","3315","3342","3345","3158d","3193a","3193b","3375/6","3421a","1133","1143","1222","1249","1312","1327","1335","1349","1564","1652","1748","1759","1830","1833","1862","2027","2034","2046","2135","2155","1","2_human","5","7_human","10_human","12","14","16_human","17","19","20","1205","1236","1251","1344","1020","1033","1032a","1836","139","766","832","838","1045","3117","3178","3231","3392","3408","3211a","3211b","1315","1346","1440","1472","1484","1537","1538","1850","1901","1907")
hi=vector()
for(i in carousel){
test<-db[db$Site=="Leptiminus" & db$Specimen_ID==i,]
test<-test[!is.na(test$ID),]
hi[i]=nrow(test)
if( hi[i]==1) {
  db$dup[db$Site=="Leptiminus" & db$Specimen_ID==i]<-FALSE
  }else{print("NO!")}}
###############################
#ABYDOS
db$Specimen_ID[db$Site=="Abydos" & db$d13C_org==-20.2]<-"E16"
db$dup[db$Site=="Abydos" & db$d13C_org==-20.2]<-FALSE
db$Specimen_ID[db$Site=="Abydos" & db$d13C_org==-19.90]<-"E29"
db$dup[db$Site=="Abydos" & db$d13C_org==-19.90]<-FALSE
db$Specimen_ID[db$Site=="Abydos" & db$d13C_org==-19.4]<-"E35"
db$dup[db$Site=="Abydos" & db$d13C_org==-19.4]<-FALSE
db$Specimen_ID[db$Site=="Abydos" & db$d13C_org==-18.4]<-"E36"
db$dup[db$Site=="Abydos" & db$d13C_org==-18.4]<-FALSE
db$Specimen_ID[db$Site=="Abydos" & db$d13C_org==-18.5]<-"E4"
db$dup[db$Site=="Abydos" & db$d13C_org==-18.5]<-FALSE
db$Specimen_ID[db$Site=="Abydos" & db$d13C_org==-21.5]<-"E5"
db$dup[db$Site=="Abydos" & db$d13C_org==-21.5]<-FALSE
db$Specimen_ID[db$Site=="Abydos" & db$d13C_org==-25.0]<-"E11"
db$dup[db$Site=="Abydos" & db$d13C_org==-25.0]<-FALSE
###############################
#ANTINOPOLIS
test<-db[db$Site=="Antinopolis" & db$Specimen_ID=="N/A",]
db$Specimen_ID[db$Site=="Antinopolis" & db$Specimen_ID=="N/A"]<-c("NA1","NA2","NA3","NA4","NA5")
db$dup[db$Site=="Antinopolis" & db$Specimen_ID=="NA1"]<-FALSE
db$dup[db$Site=="Antinopolis" & db$Specimen_ID=="NA2"]<-FALSE
db$dup[db$Site=="Antinopolis" & db$Specimen_ID=="NA3"]<-FALSE
db$dup[db$Site=="Antinopolis" & db$Specimen_ID=="NA4"]<-FALSE
db$dup[db$Site=="Antinopolis" & db$Specimen_ID=="NA5"]<-FALSE
###############################
#BAMBO
db$Specimen_ID[db$ID==96]<-"(2329CD9C)"
db$Specimen_ID[db$ID==97]<-"(2329CD9A, no. 3)"
db$Specimen_ID[db$ID==98]<-"(2329CD9A, no. 1)"
db$dup[db$ID==96]<-FALSE
db$dup[db$ID==97]<-FALSE
db$dup[db$ID==98]<-FALSE
###############################
#BYNESKRANSKOP
test<-db[db$Site =="Byneskranskop" & db$Specimen_ID=="N/A",]
db$Specimen_ID[db$ID==168]<-"SAM-AP 6060"
db$dup[db$ID==168]<-FALSE
db$Specimen_ID[db$ID==169]<-"Byneskranskop 3 (no. 10) "
db$dup[db$ID==169]<-FALSE
db$Specimen_ID[db$ID==170]<-"Byneskranskop 3 (no. 3) "
db$dup[db$ID==170]<-FALSE
db$Specimen_ID[db$ID==171]<-"Byneskranskop 3 (no. 4) "
db$dup[db$ID==171]<-FALSE
###############################
#DAMASSOGOU
test<-db[db$Site=="Damassogou" & db$Specimen_ID=="N/A",]
db$Specimen_ID[db$Site=="Damassogou" & db$Specimen_ID=="N/A"]<-c("NA1","NA2","NA3","NA4","NA5")
db$dup[db$Site=="Damassogou" & db$Specimen_ID=="NA1"]<-FALSE
db$dup[db$Site=="Damassogou" & db$Specimen_ID=="NA2"]<-FALSE
db$dup[db$Site=="Damassogou" & db$Specimen_ID=="NA3"]<-FALSE
db$dup[db$Site=="Damassogou" & db$Specimen_ID=="NA4"]<-FALSE
db$dup[db$Site=="Damassogou" & db$Specimen_ID=="NA5"]<-FALSE
###############################
#DEN STAAT
test<-db[db$Site=="Den Staat" & db$Taxon_Common_Name=="Plains zebra",]
db$Specimen_ID[db$Site=="Den Staat" & db$Taxon_Common_Name=="Plains zebra"]<-c("NA1","NA2","NA3")
db$dup[db$Site=="Den Staat" & db$Specimen_ID=="NA1"]<-FALSE
db$dup[db$Site=="Den Staat" & db$Specimen_ID=="NA2"]<-FALSE
db$dup[db$Site=="Den Staat" & db$Specimen_ID=="NA3"]<-FALSE
###############################
#EL-BADARI
test<-db[db$Site=="el-Badari",]
db$Specimen_ID[db$ID==321]<-"E28"
db$dup[db$ID==321]<-FALSE
db$Specimen_ID[db$ID==322]<-"E42"
db$dup[db$ID==322]<-FALSE
db$Specimen_ID[db$ID==323]<-"E49"
db$dup[db$ID==323]<-FALSE
db$Specimen_ID[db$ID==324]<-"E51"
db$dup[db$ID==324]<-FALSE
db$Specimen_ID[db$ID==325]<-"E54"
db$dup[db$ID==325]<-FALSE
###############################
#ELANDS BAY CAVE
test<-db[db$Site=="Elands Bay Cave",]
db$Specimen_ID[db$Site=="Elands Bay Cave" & db$ID==330]<-"ElandCave1"
db$Specimen_ID[db$Site=="Elands Bay Cave" & db$ID==331]<-"ElandCave2"
db$dup[db$ID==330]<-FALSE
db$dup[db$ID==331]<-FALSE
###############################
#GIZEH
test<-db[db$Site=="Gizeh",]
db$Specimen_ID[db$Site=="Gizeh" & db$ID==419]<-"E14"
db$Specimen_ID[db$Site=="Gizeh" & db$ID==420]<-"E15"
db$Specimen_ID[db$Site=="Gizeh" & db$ID==421]<-"E18"
db$Specimen_ID[db$Site=="Gizeh" & db$ID==422]<-"E19"
db$Specimen_ID[db$Site=="Gizeh" & db$ID==423]<-"E21"
db$Specimen_ID[db$Site=="Gizeh" & db$ID==424]<-"E23"
db$dup[db$ID==419]<-FALSE
db$dup[db$ID==420]<-FALSE
db$dup[db$ID==421]<-FALSE
db$dup[db$ID==422]<-FALSE
db$dup[db$ID==423]<-FALSE
db$dup[db$ID==424]<-FALSE
###############################
#HIERAKONPOLIS
test<-db[db$Site=="Hierakonpolis",]
db$Specimen_ID[db$Site=="Hierakonpolis" & db$ID==566]<-"E41"
db$Specimen_ID[db$Site=="Hierakonpolis" & db$ID==567]<-"E43"
db$Specimen_ID[db$Site=="Hierakonpolis" & db$ID==568]<-"E45"
db$dup[db$ID==566]<-FALSE
db$dup[db$ID==567]<-FALSE
db$dup[db$ID==568]<-FALSE
###############################
#KERMA
db$Specimen_ID[db$Site=="Kerma" & db$ID==736]<-"1024"
db$Specimen_ID[db$Site=="Kerma" & db$ID==737]<-"1029"
db$Specimen_ID[db$Site=="Kerma" & db$ID==738]<-"1029.2"
db$Specimen_ID[db$Site=="Kerma" & db$ID==739]<-"1042"
db$Specimen_ID[db$Site=="Kerma" & db$ID==740]<-"1044"
db$Specimen_ID[db$Site=="Kerma" & db$ID==741]<-"1048.1"
db$Specimen_ID[db$Site=="Kerma" & db$ID==742]<-"IV414E"
db$Specimen_ID[db$Site=="Kerma" & db$ID==743]<-"1067"
db$Specimen_ID[db$Site=="Kerma" & db$ID==744]<-"1084"
db$Specimen_ID[db$Site=="Kerma" & db$ID==745]<-"1805"
db$Specimen_ID[db$Site=="Kerma" & db$ID==746]<-"1024(2)"
db$Specimen_ID[db$Site=="Kerma" & db$ID==747]<-"1029AII"
db$Specimen_ID[db$Site=="Kerma" & db$ID==748]<-"1030B"
db$Specimen_ID[db$Site=="Kerma" & db$ID==749]<-"1030X"
db$Specimen_ID[db$Site=="Kerma" & db$ID==750]<-"1041D"
db$Specimen_ID[db$Site=="Kerma" & db$ID==751]<-"1044X"
db$Specimen_ID[db$Site=="Kerma" & db$ID==752]<-"1045B"
db$Specimen_ID[db$Site=="Kerma" & db$ID==753]<-"1045II"
db$Specimen_ID[db$Site=="Kerma" & db$ID==754]<-"1045III"
db$Specimen_ID[db$Site=="Kerma" & db$ID==755]<-"1050A"
db$Specimen_ID[db$Site=="Kerma" & db$ID==756]<-"1058D"
db$Specimen_ID[db$Site=="Kerma" & db$ID==757]<-"1058IIB"
db$Specimen_ID[db$Site=="Kerma" & db$ID==758]<-"1065G"
db$Specimen_ID[db$Site=="Kerma" & db$ID==759]<-"1065II"
db$Specimen_ID[db$Site=="Kerma" & db$ID==760]<-"1088A"
db$Specimen_ID[db$Site=="Kerma" & db$ID==761]<-"1625D"
db$Specimen_ID[db$Site=="Kerma" & db$ID==762]<-"323B"
db$Specimen_ID[db$Site=="Kerma" & db$ID==763]<-"332B"
db$Specimen_ID[db$Site=="Kerma" & db$ID==764]<-"339B"
db$Specimen_ID[db$Site=="Kerma" & db$ID==765]<-"437C"
db$Specimen_ID[db$Site=="Kerma" & db$ID==766]<-"C1802"
db$Specimen_ID[db$Site=="Kerma" & db$ID==767]<-"XBZIT"
db$Specimen_ID[db$Site=="Kerma" & db$ID==768]<-"IA1029"
db$Specimen_ID[db$Site=="Kerma" & db$ID==769]<-"IIG1803"
db$Specimen_ID[db$Site=="Kerma" & db$ID==770]<-"III313"
db$Specimen_ID[db$Site=="Kerma" & db$ID==771]<-"IT420i"
db$Specimen_ID[db$Site=="Kerma" & db$ID==772]<-"IV414E"
db$Specimen_ID[db$Site=="Kerma" & db$ID==773]<-"IVBDA"
db$Specimen_ID[db$Site=="Kerma" & db$ID==774]<-"IVBFA"
db$Specimen_ID[db$Site=="Kerma" & db$ID==775]<-"IVBSA"
db$Specimen_ID[db$Site=="Kerma" & db$ID==776]<-"K309A"
db$Specimen_ID[db$Site=="Kerma" & db$ID==777]<-"K420A"
db$Specimen_ID[db$Site=="Kerma" & db$ID==778]<-"K420i"
db$Specimen_ID[db$Site=="Kerma" & db$ID==779]<-"K421"
db$Specimen_ID[db$Site=="Kerma" & db$ID==780]<-"K423"
db$Specimen_ID[db$Site=="Kerma" & db$ID==781]<-"K425B"
db$Specimen_ID[db$Site=="Kerma" & db$ID==782]<-"XBMB"
db$Specimen_ID[db$Site=="Kerma" & db$ID==783]<-"XBOCA*"
db$Specimen_ID[db$Site=="Kerma" & db$ID==784]<-"K420A"
db$Specimen_ID[db$Site=="Kerma" & db$ID==785]<-"XBZC"
db$Specimen_ID[db$Site=="Kerma" & db$ID==786]<-"XBZIT"
db$Specimen_ID[db$Site=="Kerma" & db$ID==787]<-"El Rooda"
db$Specimen_ID[db$Site=="Kerma" & db$ID==788]<-"Lake Nasser Clarias sp"
db$Specimen_ID[db$Site=="Kerma" & db$ID==789]<-"Lake Nasser Tilapia sp"
db$Specimen_ID[db$Site=="Kerma" & db$ID==790]<-"Lake Nasser Hydrocyon sp"
db$Specimen_ID[db$Site=="Kerma" & db$ID==791]<-"Dog male1"
db$Specimen_ID[db$Site=="Kerma" & db$ID==792]<-"Dog male2"
db$Specimen_ID[db$Site=="Kerma" & db$ID==793]<-"Cattle1"
db$Specimen_ID[db$Site=="Kerma" & db$ID==794]<-"Cattle2"
db$Specimen_ID[db$Site=="Kerma" & db$ID==795]<-"Sheep"
db$Specimen_ID[db$Site=="Kerma" & db$ID==796]<-"Goat male"
db$Specimen_ID[db$Site=="Kerma" & db$ID==797]<-"Donkey1"
db$Specimen_ID[db$Site=="Kerma" & db$ID==798]<-"Donkey2"
db$Specimen_ID[db$Site=="Kerma" & db$ID==799]<-"Trionyx"
db$Specimen_ID[db$Site=="Kerma" & db$ID==818]<-"67 Dog bone AK"
db$Specimen_ID[db$Site=="Kerma" & db$ID==819]<-"77/1 Sheep copr AK"
db$Specimen_ID[db$Site=="Kerma" & db$ID==820]<-"85/1 Sheep copr AK"
db$Specimen_ID[db$Site=="Kerma" & db$ID==821]<-"89/3 Goat copr AK"
db$Specimen_ID[db$Site=="Kerma" & db$ID==822]<-"193 Sheep male AK"
db$Specimen_ID[db$Site=="Kerma" & db$ID==823]<-"116 Lamb male MK"
db$Specimen_ID[db$Site=="Kerma" & db$ID==824]<-"116 Coprolite MK"
db$Specimen_ID[db$Site=="Kerma" & db$ID==825]<-"185/1 Lamb male MK"
db$Specimen_ID[db$Site=="Kerma" & db$ID==826]<-"185/3 Cattle MK"
db$Specimen_ID[db$Site=="Kerma" & db$ID==827]<-"186 Goat male MK"
db$Specimen_ID[db$Site=="Kerma" & db$ID==828]<-"186 Sheep male MK"
db$Specimen_ID[db$Site=="Kerma" & db$ID==829]<-"189/9 Sheep male MK"
db$Specimen_ID[db$Site=="Kerma" & db$ID==830]<-"190/3 Sheep male MK"
db$Specimen_ID[db$Site=="Kerma" & db$ID==831]<-"190/7 sheep male MK"
db$Specimen_ID[db$Site=="Kerma" & db$ID==832]<-"156 cattle horn"
db$Specimen_ID[db$Site=="Kerma" & db$ID==833]<-"171 goat"
db$Specimen_ID[db$Site=="Kerma" & db$ID==834]<-"175 cattle horn"
for(i in c(736:799,818:834)){ db$dup[db$ID==i]<-FALSE }
#
test<-db[db$Site=="Kerma" & is.na(db$Specimen_ID),]
test<-test[!is.na(test$ID),]
db$Specimen_ID[db$Site=="Kerma" & db$ID==3581]<-"KER-7"
db$Specimen_ID[db$Site=="Kerma" & db$ID==3582]<-"KER-8"
db$Specimen_ID[db$Site=="Kerma" & db$ID==3583]<-"KER-9"
db$Specimen_ID[db$Site=="Kerma" & db$ID==3584]<-"KER-10"
db$Specimen_ID[db$Site=="Kerma" & db$ID==3585]<-"KER-11"
db$Specimen_ID[db$Site=="Kerma" & db$ID==3586]<-"KER-12"
db$Specimen_ID[db$Site=="Kerma" & db$ID==3587]<-"KER-13"
db$Specimen_ID[db$Site=="Kerma" & db$ID==3588]<-"KER-14"
db$Specimen_ID[db$Site=="Kerma" & db$ID==3589]<-"KER-15"
for(i in c(3581:3589)){ db$dup[db$ID==i]<-FALSE }
test<-db[db$Site=="Kerma",]
test<-test[!is.na(test$ID),]
###############################
#KNYSNA
test<-db[db$Site=="Knysna" & is.na(db$avg_d13C_inorg) & db$Specimen_ID=="N/A",]
db$Specimen_ID[db$Site=="Knysna" & db$ID==881]<-"(AI070A)"
db$Specimen_ID[db$Site=="Knysna" & db$ID==882]<-"(AI070B)"
db$dup[db$ID==881]<-FALSE
db$dup[db$ID==882]<-FALSE
###############################
#Malmesbury
test<-db[db$Site=="Malmesbury",]
db$Specimen_ID[db$Site=="Malmesbury" & db$ID==1000]<-"NA1"
db$Specimen_ID[db$Site=="Malmesbury" & db$ID==1001]<-"NA2"
db$Specimen_ID[db$Site=="Malmesbury" & db$ID==1002]<-"NA3"
db$dup[db$ID==1000]<-FALSE
db$dup[db$ID==1001]<-FALSE
db$dup[db$ID==1002]<-FALSE
###############################
#Mvae
test<-db[db$Site=="Mvae",]
db$Specimen_ID[db$Site=="Mvae" & db$ID==1083]<-"NA1"
db$Specimen_ID[db$Site=="Mvae" & db$ID==1084]<-"NA2"
db$dup[db$ID==1083]<-FALSE
db$dup[db$ID==1084]<-FALSE
###############################
#Naivasha
test<-db[db$Site=="Naivasha" & db$Specimen_ID=="N/A",]
db$Specimen_ID[db$Site=="Naivasha" & db$ID==1100]<-"Kikuyu-GsJj31"
db$Specimen_ID[db$Site=="Naivasha" & db$ID==1106]<-"NBS-KNM-NV43"
db$dup[db$ID==1100]<-FALSE
db$dup[db$ID==1106]<-FALSE
###############################
#Nanda
test<-db[db$Site=="Nanda" & db$Specimen_ID=="N/A",]
db$Specimen_ID[db$Site=="Nanda" & db$ID==1107]<-"SVP5"
db$Specimen_ID[db$Site=="Nanda" & db$ID==1110]<-"86/1-T4-B2"
db$dup[db$ID==1107]<-FALSE
db$dup[db$ID==1110]<-FALSE
###############################
#Naqada
test<-db[db$Site=="Naqada" & db$Specimen_ID=="N/A",]
db$Specimen_ID[db$Site=="Naqada" & db$ID==1111]<-"E31*"
db$Specimen_ID[db$Site=="Naqada" & db$ID==1112]<-"E32*"
db$Specimen_ID[db$Site=="Naqada" & db$ID==1113]<-"E34*"
db$Specimen_ID[db$Site=="Naqada" & db$ID==1114]<-"E44"
db$dup[db$ID==1111]<-FALSE
db$dup[db$ID==1112]<-FALSE
db$dup[db$ID==1113]<-FALSE
db$dup[db$ID==1114]<-FALSE
###############################
#Oakhurst
test<-db[db$Site=="Oakhurst",]
db$Specimen_ID[db$Site=="Oakhurst" & db$ID==1158]<-"UCT 202"
db$Specimen_ID[db$Site=="Oakhurst" & db$ID==1159]<-"UCT 203"
db$Specimen_ID[db$Site=="Oakhurst" & db$ID==1160]<-"UCT 204"
db$Specimen_ID[db$Site=="Oakhurst" & db$ID==1161]<-"UCT 205(2)"
db$Specimen_ID[db$Site=="Oakhurst" & db$ID==1162]<-"UCT 206(1)"
db$Specimen_ID[db$Site=="Oakhurst" & db$ID==1163]<-"UCT 207(H)"
db$Specimen_ID[db$Site=="Oakhurst" & db$ID==1164]<-"UCT 206(2)"
db$Specimen_ID[db$Site=="Oakhurst" & db$ID==1165]<-"UCT 210(10c)"
db$Specimen_ID[db$Site=="Oakhurst" & db$ID==1166]<-"UCT 211"
db$Specimen_ID[db$Site=="Oakhurst" & db$ID==1167]<-"UCT 199"
db$Specimen_ID[db$Site=="Oakhurst" & db$ID==1168]<-"UCT 200"
db$Specimen_ID[db$Site=="Oakhurst" & db$ID==1169]<-"UCT 201"
db$Specimen_ID[db$Site=="Oakhurst" & db$ID==1170]<-"UCT lZS(Q/D?)"
for(i in c(1158:1170)){ db$dup[db$ID==i]<-FALSE }
###############################
#Pégué Cave
test<-db[db$Site=="Pégué Cave" & db$Specimen_ID=="N/A",]
db$Specimen_ID[db$Site=="Pégué Cave" & db$ID==1295]<-"Btaurus-CaveC"
db$Specimen_ID[db$Site=="Pégué Cave" & db$ID==1296]<-"SyncerusCaffer-CaveC"
db$Specimen_ID[db$Site=="Pégué Cave" & db$ID==1297]<-"S.Caffer-CaveC"
for(i in c(1295:1297)){ db$dup[db$ID==i]<-FALSE }
###############################
#Riedel
test<-db[db$Site=="Riedel" & db$Specimen_ID=="N/A",]
db$Specimen_ID[db$Site=="Riedel" & db$ID==1347]<-"NA1"
db$Specimen_ID[db$Site=="Riedel" & db$ID==1348]<-"NA2"
db$Specimen_ID[db$Site=="Riedel" & db$ID==1349]<-"NA3"
db$Specimen_ID[db$Site=="Riedel" & db$ID==1350]<-"NA4"
db$Specimen_ID[db$Site=="Riedel" & db$ID==1351]<-"NA5"
db$Specimen_ID[db$Site=="Riedel" & db$ID==1352]<-"NA6"
for(i in c(1347:1352)){ db$dup[db$ID==i]<-FALSE }
###############################
#Sadia
test<-db[db$Site=="Sadia" & db$Specimen_ID=="N/A",]
db$Specimen_ID[db$Site=="Sadia" & db$ID==1378]<-"Gallus sp"
db$Specimen_ID[db$Site=="Sadia" & db$ID==1379]<-"Columbidae"
db$Specimen_ID[db$Site=="Sadia" & db$ID==1380]<-"Ictonyx sp"
db$Specimen_ID[db$Site=="Sadia" & db$ID==1381]<-"Fish1"
db$Specimen_ID[db$Site=="Sadia" & db$ID==1382]<-"Fish2"
for(i in c(1378:1382)){ db$dup[db$ID==i]<-FALSE }
###############################
#Sechikuencho Cairns
test<-db[db$Site=="Sechikuencho Cairns" & db$Specimen_ID=="N/A",]
db$Specimen_ID[db$Site=="Sechikuencho Cairns" & db$ID==1425]<-"NA1"
db$Specimen_ID[db$Site=="Sechikuencho Cairns" & db$ID==1426]<-"NA2"
db$Specimen_ID[db$Site=="Sechikuencho Cairns" & db$ID==1427]<-"NA3"
for(i in c(1425:1427)){ db$dup[db$ID==i]<-FALSE }
###############################
#SLRB (Venetia)
test<-db[db$Site=="SLRB (Venetia)" & db$Specimen_ID=="N/A",]
db$Specimen_ID[db$Site=="SLRB (Venetia)" & db$ID==1436]<-"NA1"
db$Specimen_ID[db$Site=="SLRB (Venetia)" & db$ID==1437]<-"NA2"
db$Specimen_ID[db$Site=="SLRB (Venetia)" & db$ID==1438]<-"NA3"
db$Specimen_ID[db$Site=="SLRB (Venetia)" & db$ID==1439]<-"NA4"
db$Specimen_ID[db$Site=="SLRB (Venetia)" & db$ID==1440]<-"NA5"
db$Specimen_ID[db$Site=="SLRB (Venetia)" & db$ID==1441]<-"NA6"
db$Specimen_ID[db$Site=="SLRB (Venetia)" & db$ID==1442]<-"NA7"
db$Specimen_ID[db$Site=="SLRB (Venetia)" & db$ID==1443]<-"NA8"
db$Specimen_ID[db$Site=="SLRB (Venetia)" & db$ID==1444]<-"NA9"
db$Specimen_ID[db$Site=="SLRB (Venetia)" & db$ID==1445]<-"NA10"
db$Specimen_ID[db$Site=="SLRB (Venetia)" & db$ID==1446]<-"NA11"
db$Specimen_ID[db$Site=="SLRB (Venetia)" & db$ID==1447]<-"NA12"
for(i in c(1436:1447)){ db$dup[db$ID==i]<-FALSE }
###############################
#Soutpansberg (Mara)
test<-db[db$Site=="Soutpansberg (Mara)" & db$Specimen_ID=="N/A",]
db$Specimen_ID[db$Site=="Soutpansberg (Mara)" & db$ID==1449]<-"NA1"
db$Specimen_ID[db$Site=="Soutpansberg (Mara)" & db$ID==1450]<-"NA2"
db$Specimen_ID[db$Site=="Soutpansberg (Mara)" & db$ID==1451]<-"NA3"
db$Specimen_ID[db$Site=="Soutpansberg (Mara)" & db$ID==1452]<-"NA4"
db$Specimen_ID[db$Site=="Soutpansberg (Mara)" & db$ID==1453]<-"NA5"
db$Specimen_ID[db$Site=="Soutpansberg (Mara)" & db$ID==1454]<-"NA6"
db$Specimen_ID[db$Site=="Soutpansberg (Mara)" & db$ID==1455]<-"NA7"
db$Specimen_ID[db$Site=="Soutpansberg (Mara)" & db$ID==1456]<-"NA8"
db$Specimen_ID[db$Site=="Soutpansberg (Mara)" & db$ID==1457]<-"NA9"
db$Specimen_ID[db$Site=="Soutpansberg (Mara)" & db$ID==1458]<-"NA10"
db$Specimen_ID[db$Site=="Soutpansberg (Mara)" & db$ID==1459]<-"NA11"
db$Specimen_ID[db$Site=="Soutpansberg (Mara)" & db$ID==1460]<-"NA12"
db$Specimen_ID[db$Site=="Soutpansberg (Mara)" & db$ID==1461]<-"NA13"
db$Specimen_ID[db$Site=="Soutpansberg (Mara)" & db$ID==1462]<-"NA14"
for(i in c(1449:1462)){ db$dup[db$ID==i]<-FALSE }
###############################
#Tongo Maaré Diabal
test<-db[db$Site=="Tongo Maaré Diabal" & db$Specimen_ID=="N/A",]
db$Specimen_ID[db$Site=="Tongo Maaré Diabal" & db$ID==1594]<-"Caprinae1"
db$Specimen_ID[db$Site=="Tongo Maaré Diabal" & db$ID==1595]<-"Caprinae2"
db$Specimen_ID[db$Site=="Tongo Maaré Diabal" & db$ID==1596]<-"Caprinae3"
db$Specimen_ID[db$Site=="Tongo Maaré Diabal" & db$ID==1597]<-"Cricetomys gambianus"
for(i in c(1594:1597)){ db$dup[db$ID==i]<-FALSE }
###############################
#Wosi
test<-db[db$Site=="Wosi" & db$Specimen_ID=="N/A",]
db$Specimen_ID[db$Site=="Wosi" & db$ID==1777]<-"KCM 84/5 Burial 2"
db$Specimen_ID[db$Site=="Wosi" & db$ID==1778]<-"KCM 84/5 Burial 3"
for(i in c(1777:1778)){ db$dup[db$ID==i]<-FALSE }
###############################
#Zitzikama
test<-db[db$Site=="Zitzikama" & db$Specimen_ID=="N/A",]
db$Specimen_ID[db$Site=="Zitzikama" & db$ID==1790]<-"(AI155)"
db$Specimen_ID[db$Site=="Zitzikama" & db$ID==1791]<-"RockShelters A1112"
db$Specimen_ID[db$Site=="Zitzikama" & db$ID==1792]<-"RockShelters A1112 ZA2)"
for(i in c(1790:1792)){ db$dup[db$ID==i]<-FALSE }
###############################
#Panga ya Saidi
test<-db[db$Site=="Panga ya Saidi",]
test<-test[!is.na(test$ID),]
db$Specimen_ID[db$Site=="Panga ya Saidi" & db$ID==3470]<-"NA1"
db$Specimen_ID[db$Site=="Panga ya Saidi" & db$ID==3471]<-"NA2"
db$Specimen_ID[db$Site=="Panga ya Saidi" & db$ID==3472]<-"NA3"
db$Specimen_ID[db$Site=="Panga ya Saidi" & db$ID==3473]<-"NA4"
db$Specimen_ID[db$Site=="Panga ya Saidi" & db$ID==3474]<-"NA5"
db$Specimen_ID[db$Site=="Panga ya Saidi" & db$ID==3475]<-"NA6"
db$Specimen_ID[db$Site=="Panga ya Saidi" & db$ID==3476]<-"NA7"
db$Specimen_ID[db$Site=="Panga ya Saidi" & db$ID==3477]<-"NA8"
db$Specimen_ID[db$Site=="Panga ya Saidi" & db$ID==3478]<-"NA9"
db$Specimen_ID[db$Site=="Panga ya Saidi" & db$ID==3479]<-"NA10"
db$Specimen_ID[db$Site=="Panga ya Saidi" & db$ID==3480]<-"NA11"
db$Specimen_ID[db$Site=="Panga ya Saidi" & db$ID==3481]<-"NA12"
db$Specimen_ID[db$Site=="Panga ya Saidi" & db$ID==3482]<-"NA13"
db$Specimen_ID[db$Site=="Panga ya Saidi" & db$ID==3483]<-"NA14"
db$Specimen_ID[db$Site=="Panga ya Saidi" & db$ID==3484]<-"NA15"
db$Specimen_ID[db$Site=="Panga ya Saidi" & db$ID==3485]<-"NA16"
db$Specimen_ID[db$Site=="Panga ya Saidi" & db$ID==3486]<-"NA17"
db$Specimen_ID[db$Site=="Panga ya Saidi" & db$ID==3487]<-"NA18"
db$Specimen_ID[db$Site=="Panga ya Saidi" & db$ID==3488]<-"NA19"
db$Specimen_ID[db$Site=="Panga ya Saidi" & db$ID==3489]<-"NA20"
db$Specimen_ID[db$Site=="Panga ya Saidi" & db$ID==3490]<-"NA21"
for(i in c(3470:3490)){ db$dup[db$ID==i]<-FALSE }
###############################
#Porc Epic
test<-db[db$Site=="Porc Epic" & is.na(db$Specimen_ID),]
test<-test[!is.na(test$ID),]
db$Specimen_ID[db$Site=="Porc Epic" & db$ID==3491]<-"NA1"
db$Specimen_ID[db$Site=="Porc Epic" & db$ID==3492]<-"NA2"
db$Specimen_ID[db$Site=="Porc Epic" & db$ID==3493]<-"NA3"
db$Specimen_ID[db$Site=="Porc Epic" & db$ID==3494]<-"NA4"
db$Specimen_ID[db$Site=="Porc Epic" & db$ID==3495]<-"NA5"
db$Specimen_ID[db$Site=="Porc Epic" & db$ID==3496]<-"NA6"
db$Specimen_ID[db$Site=="Porc Epic" & db$ID==3497]<-"NA7"
db$Specimen_ID[db$Site=="Porc Epic" & db$ID==3498]<-"NA8"
db$Specimen_ID[db$Site=="Porc Epic" & db$ID==3499]<-"NA9"
db$Specimen_ID[db$Site=="Porc Epic" & db$ID==3500]<-"NA10"
db$Specimen_ID[db$Site=="Porc Epic" & db$ID==3501]<-"NA11"
db$Specimen_ID[db$Site=="Porc Epic" & db$ID==3502]<-"NA12"
db$Specimen_ID[db$Site=="Porc Epic" & db$ID==3503]<-"NA13"
db$Specimen_ID[db$Site=="Porc Epic" & db$ID==3504]<-"NA14"
db$Specimen_ID[db$Site=="Porc Epic" & db$ID==3505]<-"NA15"
db$Specimen_ID[db$Site=="Porc Epic" & db$ID==3506]<-"NA16"
db$Specimen_ID[db$Site=="Porc Epic" & db$ID==3507]<-"NA17"
db$Specimen_ID[db$Site=="Porc Epic" & db$ID==3508]<-"NA18"
db$Specimen_ID[db$Site=="Porc Epic" & db$ID==3509]<-"NA19"
db$Specimen_ID[db$Site=="Porc Epic" & db$ID==3510]<-"NA20"
db$Specimen_ID[db$Site=="Porc Epic" & db$ID==3511]<-"NA21"
db$Specimen_ID[db$Site=="Porc Epic" & db$ID==3512]<-"NA22"
db$Specimen_ID[db$Site=="Porc Epic" & db$ID==3513]<-"NA23"
db$Specimen_ID[db$Site=="Porc Epic" & db$ID==3514]<-"NA24"
db$Specimen_ID[db$Site=="Porc Epic" & db$ID==3515]<-"NA25"
db$Specimen_ID[db$Site=="Porc Epic" & db$ID==3516]<-"NA26"
db$Specimen_ID[db$Site=="Porc Epic" & db$ID==3517]<-"NA27"
db$Specimen_ID[db$Site=="Porc Epic" & db$ID==3518]<-"NA28"
db$Specimen_ID[db$Site=="Porc Epic" & db$ID==3519]<-"NA29"
db$Specimen_ID[db$Site=="Porc Epic" & db$ID==3520]<-"NA30"
db$Specimen_ID[db$Site=="Porc Epic" & db$ID==3521]<-"NA31"
db$Specimen_ID[db$Site=="Porc Epic" & db$ID==3522]<-"NA32"
db$Specimen_ID[db$Site=="Porc Epic" & db$ID==3523]<-"NA33"
db$Specimen_ID[db$Site=="Porc Epic" & db$ID==3524]<-"NA34"
db$Specimen_ID[db$Site=="Porc Epic" & db$ID==3525]<-"NA35"
db$Specimen_ID[db$Site=="Porc Epic" & db$ID==3526]<-"NA36"
db$Specimen_ID[db$Site=="Porc Epic" & db$ID==3527]<-"NA37"
db$Specimen_ID[db$Site=="Porc Epic" & db$ID==3528]<-"NA38"
db$Specimen_ID[db$Site=="Porc Epic" & db$ID==3529]<-"NA39"
db$Specimen_ID[db$Site=="Porc Epic" & db$ID==3530]<-"NA40"
db$Specimen_ID[db$Site=="Porc Epic" & db$ID==3531]<-"NA41"
db$Specimen_ID[db$Site=="Porc Epic" & db$ID==3532]<-"NA42"
db$Specimen_ID[db$Site=="Porc Epic" & db$ID==3533]<-"NA43"
db$Specimen_ID[db$Site=="Porc Epic" & db$ID==3534]<-"NA44"
db$Specimen_ID[db$Site=="Porc Epic" & db$ID==3535]<-"NA45"
db$Specimen_ID[db$Site=="Porc Epic" & db$ID==3536]<-"NA46"
db$Specimen_ID[db$Site=="Porc Epic" & db$ID==3537]<-"NA47"
db$Specimen_ID[db$Site=="Porc Epic" & db$ID==3538]<-"NA48"
db$Specimen_ID[db$Site=="Porc Epic" & db$ID==3539]<-"NA49"
db$Specimen_ID[db$Site=="Porc Epic" & db$ID==3540]<-"NA50"
db$Specimen_ID[db$Site=="Porc Epic" & db$ID==3541]<-"NA51"
db$Specimen_ID[db$Site=="Porc Epic" & db$ID==3542]<-"NA52"
db$Specimen_ID[db$Site=="Porc Epic" & db$ID==3543]<-"NA53"
db$Specimen_ID[db$Site=="Porc Epic" & db$ID==3544]<-"NA54"
db$Specimen_ID[db$Site=="Porc Epic" & db$ID==3545]<-"NA55"
db$Specimen_ID[db$Site=="Porc Epic" & db$ID==3546]<-"NA56"
db$Specimen_ID[db$Site=="Porc Epic" & db$ID==3547]<-"NA57"
db$Specimen_ID[db$Site=="Porc Epic" & db$ID==3548]<-"NA58"
db$Specimen_ID[db$Site=="Porc Epic" & db$ID==3549]<-"NA59"
db$Specimen_ID[db$Site=="Porc Epic" & db$ID==3550]<-"NA60"
for(i in c(3491:3550)){ db$dup[db$ID==i]<-FALSE }
###############################
#Kalemba Rockshelter
test<-db[db$Site=="Kalemba Rockshelter" & is.na(db$Specimen_ID),]
test<-test[!is.na(test$ID),]
db$Specimen_ID[db$Site=="Kalemba Rockshelter" & db$ID==3551]<-"NA1"
db$Specimen_ID[db$Site=="Kalemba Rockshelter" & db$ID==3552]<-"NA2"
db$Specimen_ID[db$Site=="Kalemba Rockshelter" & db$ID==3553]<-"NA3"
db$Specimen_ID[db$Site=="Kalemba Rockshelter" & db$ID==3554]<-"NA4"
db$Specimen_ID[db$Site=="Kalemba Rockshelter" & db$ID==3555]<-"NA5"
db$Specimen_ID[db$Site=="Kalemba Rockshelter" & db$ID==3556]<-"NA6"
db$Specimen_ID[db$Site=="Kalemba Rockshelter" & db$ID==3557]<-"NA7"
db$Specimen_ID[db$Site=="Kalemba Rockshelter" & db$ID==3558]<-"NA8"
for(i in c(3551:3558)){ db$dup[db$ID==i]<-FALSE }
###############################
#Amara West
test<-db[db$Site=="Amara West" & is.na(db$Specimen_ID),]
test<-test[!is.na(test$ID),]
db$Specimen_ID[db$Site=="Amara West" & db$ID==3559]<-"AMR-1"
db$Specimen_ID[db$Site=="Amara West" & db$ID==3560]<-"AMR-2"
db$Specimen_ID[db$Site=="Amara West" & db$ID==3561]<-"AMR-3"
db$Specimen_ID[db$Site=="Amara West" & db$ID==3562]<-"AMR-4"
db$Specimen_ID[db$Site=="Amara West" & db$ID==3563]<-"AMR-5"
db$Specimen_ID[db$Site=="Amara West" & db$ID==3564]<-"AMR-7"
db$Specimen_ID[db$Site=="Amara West" & db$ID==3565]<-"AMR-8"
db$Specimen_ID[db$Site=="Amara West" & db$ID==3566]<-"AMR-9"
db$Specimen_ID[db$Site=="Amara West" & db$ID==3567]<-"AMR-10"
for(i in c(3559:3567)){ db$dup[db$ID==i]<-FALSE }
###############################
#C-Group
test<-db[db$Site=="C-Group" & is.na(db$Specimen_ID),]
test<-test[!is.na(test$ID),]
db$Specimen_ID[db$Site=="C-Group" & db$ID==3568]<-"CGR-1"
db$Specimen_ID[db$Site=="C-Group" & db$ID==3569]<-"CGR-2"
db$Specimen_ID[db$Site=="C-Group" & db$ID==3570]<-"CGR-3"
db$Specimen_ID[db$Site=="C-Group" & db$ID==3571]<-"CGR-4"
db$Specimen_ID[db$Site=="C-Group" & db$ID==3572]<-"CGR-5"
db$Specimen_ID[db$Site=="C-Group" & db$ID==3573]<-"CGR-6"
db$Specimen_ID[db$Site=="C-Group" & db$ID==3574]<-"CGR-8"
db$Specimen_ID[db$Site=="C-Group" & db$ID==3575]<-"CGR-9"
db$Specimen_ID[db$Site=="C-Group" & db$ID==3576]<-"CGR-10"
db$Specimen_ID[db$Site=="C-Group" & db$ID==3577]<-"CGR-11"
db$Specimen_ID[db$Site=="C-Group" & db$ID==3578]<-"CGR-12"
db$Specimen_ID[db$Site=="C-Group" & db$ID==3579]<-"CGR-13"
db$Specimen_ID[db$Site=="C-Group" & db$ID==3580]<-"CGR-14"
for(i in c(3568:3580)){ db$dup[db$ID==i]<-FALSE }
###############################
#Memphis
test<-db[db$Site=="Memphis" & is.na(db$Specimen_ID),]
test<-test[!is.na(test$ID),]
db$Specimen_ID[db$Site=="Memphis" & db$ID==3590]<-"MEM-1"
db$Specimen_ID[db$Site=="Memphis" & db$ID==3591]<-"MEM-3"
db$Specimen_ID[db$Site=="Memphis" & db$ID==3592]<-"MEM-4"
db$Specimen_ID[db$Site=="Memphis" & db$ID==3593]<-"MEM-6"
db$Specimen_ID[db$Site=="Memphis" & db$ID==3594]<-"MEM-7"
db$Specimen_ID[db$Site=="Memphis" & db$ID==3595]<-"MEM-8"
db$Specimen_ID[db$Site=="Memphis" & db$ID==3596]<-"MEM-9"
db$Specimen_ID[db$Site=="Memphis" & db$ID==3597]<-"MEM-10"
db$Specimen_ID[db$Site=="Memphis" & db$ID==3598]<-"MEM-11"
db$Specimen_ID[db$Site=="Memphis" & db$ID==3599]<-"MEM-12"
db$Specimen_ID[db$Site=="Memphis" & db$ID==3600]<-"MEM-14"
db$Specimen_ID[db$Site=="Memphis" & db$ID==3601]<-"MEM-15"
for(i in c(3590:3601)){ db$dup[db$ID==i]<-FALSE }
###############################
#Pharaonic
test<-db[db$Site=="Pharaonic" & is.na(db$Specimen_ID),]
test<-test[!is.na(test$ID),]
db$Specimen_ID[db$Site=="Pharaonic" & db$ID==3602]<-"PHR-1"
db$Specimen_ID[db$Site=="Pharaonic" & db$ID==3603]<-"PHR-4"
db$Specimen_ID[db$Site=="Pharaonic" & db$ID==3604]<-"PHR-6"
db$Specimen_ID[db$Site=="Pharaonic" & db$ID==3605]<-"PHR-7"
db$Specimen_ID[db$Site=="Pharaonic" & db$ID==3606]<-"PHR-8"
db$Specimen_ID[db$Site=="Pharaonic" & db$ID==3607]<-"PHR-9"
db$Specimen_ID[db$Site=="Pharaonic" & db$ID==3608]<-"PHR-12"
db$Specimen_ID[db$Site=="Pharaonic" & db$ID==3609]<-"PHR-14"
db$Specimen_ID[db$Site=="Pharaonic" & db$ID==3610]<-"PHR-15"
for(i in c(3602:3610)){ db$dup[db$ID==i]<-FALSE }
###############################
#Qurneh
test<-db[db$Site=="Qurneh" & is.na(db$Specimen_ID),]
test<-test[!is.na(test$ID),]
db$Specimen_ID[db$Site=="Qurneh" & db$ID==3611]<-"QUR-1"
db$Specimen_ID[db$Site=="Qurneh" & db$ID==3612]<-"QUR-2"
db$Specimen_ID[db$Site=="Qurneh" & db$ID==3613]<-"QUR-3"
db$Specimen_ID[db$Site=="Qurneh" & db$ID==3614]<-"QUR-4"
db$Specimen_ID[db$Site=="Qurneh" & db$ID==3615]<-"QUR-6"
db$Specimen_ID[db$Site=="Qurneh" & db$ID==3616]<-"QUR-7"
db$Specimen_ID[db$Site=="Qurneh" & db$ID==3617]<-"QUR-8"
db$Specimen_ID[db$Site=="Qurneh" & db$ID==3618]<-"QUR-9"
db$Specimen_ID[db$Site=="Qurneh" & db$ID==3619]<-"QUR-10"
db$Specimen_ID[db$Site=="Qurneh" & db$ID==3620]<-"QUR-11"
db$Specimen_ID[db$Site=="Qurneh" & db$ID==3621]<-"QUR-12"
db$Specimen_ID[db$Site=="Qurneh" & db$ID==3622]<-"QUR-13"
db$Specimen_ID[db$Site=="Qurneh" & db$ID==3623]<-"QUR-14"
db$Specimen_ID[db$Site=="Qurneh" & db$ID==3624]<-"QUR-15"
for(i in c(3611:3624)){ db$dup[db$ID==i]<-FALSE }
###############################
#Shellal
test<-db[db$Site=="Shellal" & is.na(db$Specimen_ID),]
test<-test[!is.na(test$ID),]
db$Specimen_ID[db$Site=="Shellal" & db$ID==3625]<-"SHL-1"
db$Specimen_ID[db$Site=="Shellal" & db$ID==3626]<-"SHL-2"
db$Specimen_ID[db$Site=="Shellal" & db$ID==3627]<-"SHL-3"
db$Specimen_ID[db$Site=="Shellal" & db$ID==3628]<-"SHL-4"
db$Specimen_ID[db$Site=="Shellal" & db$ID==3629]<-"SHL-6"
db$Specimen_ID[db$Site=="Shellal" & db$ID==3630]<-"SHL-7"
db$Specimen_ID[db$Site=="Shellal" & db$ID==3631]<-"SHL-8"
db$Specimen_ID[db$Site=="Shellal" & db$ID==3632]<-"SHL-9"
db$Specimen_ID[db$Site=="Shellal" & db$ID==3633]<-"SHL-10"
db$Specimen_ID[db$Site=="Shellal" & db$ID==3634]<-"SHL-11"
db$Specimen_ID[db$Site=="Shellal" & db$ID==3635]<-"SHL-12"
db$Specimen_ID[db$Site=="Shellal" & db$ID==3636]<-"SHL-13"
db$Specimen_ID[db$Site=="Shellal" & db$ID==3637]<-"SHL-15"
for(i in c(3625:3637)){ db$dup[db$ID==i]<-FALSE }
###############################
#Tombos
test<-db[db$Site=="Tombos" & is.na(db$Specimen_ID),]
test<-test[!is.na(test$ID),]
db$Specimen_ID[db$Site=="Tombos" & db$ID==3638]<-"TOM-100"
db$Specimen_ID[db$Site=="Tombos" & db$ID==3639]<-"TOM-101"
db$Specimen_ID[db$Site=="Tombos" & db$ID==3640]<-"TOM-102"
db$Specimen_ID[db$Site=="Tombos" & db$ID==3641]<-"TOM-103"
db$Specimen_ID[db$Site=="Tombos" & db$ID==3642]<-"TOM-104"
db$Specimen_ID[db$Site=="Tombos" & db$ID==3643]<-"TOM-105"
db$Specimen_ID[db$Site=="Tombos" & db$ID==3644]<-"TOM-106"
db$Specimen_ID[db$Site=="Tombos" & db$ID==3645]<-"TOM-107"
db$Specimen_ID[db$Site=="Tombos" & db$ID==3646]<-"TOM-108"
db$Specimen_ID[db$Site=="Tombos" & db$ID==3647]<-"TOM-109"
db$Specimen_ID[db$Site=="Tombos" & db$ID==3648]<-"TOM-110"
db$Specimen_ID[db$Site=="Tombos" & db$ID==3649]<-"TOM-111"
db$Specimen_ID[db$Site=="Tombos" & db$ID==3650]<-"TOM-112"
db$Specimen_ID[db$Site=="Tombos" & db$ID==3651]<-"TOM-113"
db$Specimen_ID[db$Site=="Tombos" & db$ID==3652]<-"TOM-114"
db$Specimen_ID[db$Site=="Tombos" & db$ID==3653]<-"TOM-115"
db$Specimen_ID[db$Site=="Tombos" & db$ID==3654]<-"TOM-116"
db$Specimen_ID[db$Site=="Tombos" & db$ID==3655]<-"TOM-117"
db$Specimen_ID[db$Site=="Tombos" & db$ID==3656]<-"TOM-118"
db$Specimen_ID[db$Site=="Tombos" & db$ID==3657]<-"TOM-119"
db$Specimen_ID[db$Site=="Tombos" & db$ID==3658]<-"TOM-120"
db$Specimen_ID[db$Site=="Tombos" & db$ID==3659]<-"TOM-122"
db$Specimen_ID[db$Site=="Tombos" & db$ID==3660]<-"TOM-123"
for(i in c(3638:3660)){ db$dup[db$ID==i]<-FALSE }
###############################
#16D5
test<-db[db$Site=="16D5" & is.na(db$Specimen_ID),]
test<-test[!is.na(test$ID),]
db$Specimen_ID[db$Site=="16D5" & db$ID==5335]<-"SU462-1"
db$Specimen_ID[db$Site=="16D5" & db$ID==5336]<-"SU455-1"
db$Specimen_ID[db$Site=="16D5" & db$ID==5337]<-"SU455-2"
db$Specimen_ID[db$Site=="16D5" & db$ID==5338]<-"SU452-1"
db$Specimen_ID[db$Site=="16D5" & db$ID==5339]<-"SU452-2"
db$Specimen_ID[db$Site=="16D5" & db$ID==5340]<-"SU48-1"
db$Specimen_ID[db$Site=="16D5" & db$ID==5341]<-"SU48-2"
db$Specimen_ID[db$Site=="16D5" & db$ID==5342]<-"SU48-3"
db$Specimen_ID[db$Site=="16D5" & db$ID==5343]<-"SU38-1"
db$Specimen_ID[db$Site=="16D5" & db$ID==5344]<-"SU462-2"
db$Specimen_ID[db$Site=="16D5" & db$ID==5345]<-"SU462-3"
db$Specimen_ID[db$Site=="16D5" & db$ID==5346]<-"SU462-4"
db$Specimen_ID[db$Site=="16D5" & db$ID==5347]<-"SU462-5"
db$Specimen_ID[db$Site=="16D5" & db$ID==5348]<-"SU455-3"
db$Specimen_ID[db$Site=="16D5" & db$ID==5349]<-"SU455-4"
db$Specimen_ID[db$Site=="16D5" & db$ID==5350]<-"SU455-5"
db$Specimen_ID[db$Site=="16D5" & db$ID==5351]<-"SU48-4"
db$Specimen_ID[db$Site=="16D5" & db$ID==5352]<-"SU48-5"
db$Specimen_ID[db$Site=="16D5" & db$ID==5353]<-"SU452-3"
db$Specimen_ID[db$Site=="16D5" & db$ID==5354]<-"SU38-2"
db$Specimen_ID[db$Site=="16D5" & db$ID==5355]<-"SU38-3"
db$Specimen_ID[db$Site=="16D5" & db$ID==5356]<-"SU38-4"
db$Specimen_ID[db$Site=="16D5" & db$ID==5357]<-"SU452-4"
db$Specimen_ID[db$Site=="16D5" & db$ID==5358]<-"SU452-5"
db$Specimen_ID[db$Site=="16D5" & db$ID==5359]<-"SU38-5"
db$Specimen_ID[db$Site=="16D5" & db$ID==5360]<-"SU462-6"
db$Specimen_ID[db$Site=="16D5" & db$ID==5361]<-"SU455-6"
db$Specimen_ID[db$Site=="16D5" & db$ID==5362]<-"SU455-7"
db$Specimen_ID[db$Site=="16D5" & db$ID==5363]<-"SU444-1"
db$Specimen_ID[db$Site=="16D5" & db$ID==5364]<-"SU48-6"
db$Specimen_ID[db$Site=="16D5" & db$ID==5365]<-"SU38-6"
db$Specimen_ID[db$Site=="16D5" & db$ID==5366]<-"SU38-7"
db$Specimen_ID[db$Site=="16D5" & db$ID==5367]<-"SU38-8"
db$Specimen_ID[db$Site=="16D5" & db$ID==5368]<-"SU48-7"
db$Specimen_ID[db$Site=="16D5" & db$ID==5369]<-"SU48-8"
db$Specimen_ID[db$Site=="16D5" & db$ID==5370]<-"SU48-9"
db$Specimen_ID[db$Site=="16D5" & db$ID==5371]<-"SU38-9"
db$Specimen_ID[db$Site=="16D5" & db$ID==5372]<-"SU38-10"
db$Specimen_ID[db$Site=="16D5" & db$ID==5373]<-"SU38-11"
db$Specimen_ID[db$Site=="16D5" & db$ID==5374]<-"SU455-8"
db$Specimen_ID[db$Site=="16D5" & db$ID==5375]<-"SU456-1"
db$Specimen_ID[db$Site=="16D5" & db$ID==5376]<-"SU457-1"
db$Specimen_ID[db$Site=="16D5" & db$ID==5377]<-"SU458-1"
db$Specimen_ID[db$Site=="16D5" & db$ID==5378]<-"SU444-2"
db$Specimen_ID[db$Site=="16D5" & db$ID==5379]<-"SU445-1"
db$Specimen_ID[db$Site=="16D5" & db$ID==5380]<-"SU446-1"
db$Specimen_ID[db$Site=="16D5" & db$ID==5381]<-"SU48-10"
db$Specimen_ID[db$Site=="16D5" & db$ID==5382]<-"SU48-11"
db$Specimen_ID[db$Site=="16D5" & db$ID==5383]<-"SU38-12"
db$Specimen_ID[db$Site=="16D5" & db$ID==5384]<-"SU38-13"
db$Specimen_ID[db$Site=="16D5" & db$ID==5385]<-"SU455-9"
for(i in c(5335:5385)){ db$dup[db$ID==i]<-FALSE }
###############################
#16D4b
test<-db[db$Site=="16D4b" & is.na(db$Specimen_ID),]
test<-test[!is.na(test$ID),]
db$Specimen_ID[db$Site=="16D4b" & db$ID==5388]<-"F8-1"
db$Specimen_ID[db$Site=="16D4b" & db$ID==5389]<-"F8-2"
db$Specimen_ID[db$Site=="16D4b" & db$ID==5390]<-"US45-1"
db$Specimen_ID[db$Site=="16D4b" & db$ID==5391]<-"F1-1"
db$Specimen_ID[db$Site=="16D4b" & db$ID==5392]<-"F1-2"
db$Specimen_ID[db$Site=="16D4b" & db$ID==5393]<-"US45-2"
db$Specimen_ID[db$Site=="16D4b" & db$ID==5394]<-"F8-3"
db$Specimen_ID[db$Site=="16D4b" & db$ID==5395]<-"F6-1"
db$Specimen_ID[db$Site=="16D4" & db$ID==5396]<-"US97-1"
db$Specimen_ID[db$Site=="16D4b" & db$ID==5397]<-"F8-4"
db$Specimen_ID[db$Site=="16D4" & db$ID==5398]<-"US97-2"
db$Specimen_ID[db$Site=="16D4b" & db$ID==5399]<-"F1-3"
db$Specimen_ID[db$Site=="16D4b" & db$ID==5400]<-"F8-5"
db$Specimen_ID[db$Site=="16D4b" & db$ID==5401]<-"F6-2"
db$Specimen_ID[db$Site=="16D4b" & db$ID==5402]<-"F6-3"
db$Specimen_ID[db$Site=="16D4b" & db$ID==5403]<-"F1-4"
db$Specimen_ID[db$Site=="16D4b" & db$ID==5404]<-"F8-6"
db$Specimen_ID[db$Site=="16D4b" & db$ID==5405]<-"F1-5"
db$Specimen_ID[db$Site=="16D4b" & db$ID==5406]<-"US45-3"
db$Specimen_ID[db$Site=="16D4b" & db$ID==5407]<-"F6-4"
db$Specimen_ID[db$Site=="16D4" & db$ID==5408]<-"US97-3"
db$Specimen_ID[db$Site=="16D4b" & db$ID==5409]<-"F8-7"
db$Specimen_ID[db$Site=="16D4b" & db$ID==5410]<-"US45-4"
db$Specimen_ID[db$Site=="16D4b" & db$ID==5411]<-"F1-6"
db$Specimen_ID[db$Site=="16D4" & db$ID==5412]<-"US97-4"
db$Specimen_ID[db$Site=="16D4b" & db$ID==5413]<-"F8-8"
db$Specimen_ID[db$Site=="16D4b" & db$ID==5414]<-"F6-5"
for(i in c(5388:5414)){ db$dup[db$ID==i]<-FALSE }
###############################
#10W4
test<-db[db$Site=="10W4" & is.na(db$Specimen_ID),]
test<-test[!is.na(test$ID),]
db$Specimen_ID[db$Site=="10W4" & db$ID==5420]<-"BB3 A"
db$Specimen_ID[db$Site=="10W4" & db$ID==5421]<-"BB3 B"
db$Specimen_ID[db$Site=="10W4" & db$ID==5422]<-"BB3"
db$Specimen_ID[db$Site=="10W4" & db$ID==5423]<-"AA3"
db$Specimen_ID[db$Site=="10W4" & db$ID==5424]<-"AA1"
db$Specimen_ID[db$Site=="10W4" & db$ID==5425]<-"AA1 A"
db$Specimen_ID[db$Site=="10W4" & db$ID==5426]<-"AA1 B"
for(i in c(5420:5426)){ db$dup[db$ID==i]<-FALSE }
###############################
#Khartoum
test<-db[db$Site=="Khartoum" & is.na(db$Specimen_ID),]
test<-test[!is.na(test$ID),]
db$Specimen_ID[db$Site=="Khartoum" & db$ID==5427]<-"goat1"
db$Specimen_ID[db$Site=="Khartoum" & db$ID==5428]<-"sheep"
db$Specimen_ID[db$Site=="Khartoum" & db$ID==5429]<-"cow1"
db$Specimen_ID[db$Site=="Khartoum" & db$ID==5430]<-"cow2"
db$Specimen_ID[db$Site=="Khartoum" & db$ID==5431]<-"fish1"
db$Specimen_ID[db$Site=="Khartoum" & db$ID==5432]<-"fish2"
for(i in c(5427:5432)){ db$dup[db$ID==i]<-FALSE }
###############################
#Unknown Site South Africa - Tauhatswana
test<-db[db$Site=="Unknown Site South Africa - Tauhatswana" & db$Specimen_ID=="N/A",]
test<-test[!is.na(test$ID),]
db$Specimen_ID[db$Site=="Unknown Site South Africa - Tauhatswana" & db$ID==1486]<-"2329BB2A, no. I"
db$Specimen_ID[db$Site=="Unknown Site South Africa - Tauhatswana" & db$ID==1487]<-"2329BB2A, no. 2"
for(i in c(1486:1487)){ db$dup[db$ID==i]<-FALSE }
###############################
unique(db$dup)
todo<-db[db$dup=="unknown_specimen_id",]
unique(db$dup)
todo<-db[db$dup=="TRUE" & db$Specimen_ID=="N/A",]
todo<-db[db$dup==TRUE & is.na(db$avg_d13C_inorg) & is.na(db$avg_d13C_org) & is.na(db$avg_d15N),]
todo<-todo[!is.na(todo$ID),]
unique(todo$Specimen_ID[todo$Site=="Leptiminus"])
##################################################
#
unique(db$Material_Type)
db_bone<-db[db$Material_Type=="Bone",]
db_bone<-db_bone[!is.na(db_bone$Date_min) 
                     & !is.na(db_bone$Date_max) 
                     & !is.na(db_bone$d13C_org) 
                     & !is.na(db_bone$d15N),]
db_bone_1 = db_bone[!is.na(db_bone$avg_d13C_org),]
db_bone_2 = db_bone[is.na(db_bone$avg_d13C_org),]
db_bone_2$avg_d13C_org<-db_bone_2$d13C_org
db_bone_2$avg_d15N<-db_bone_2$d15N
db_bone<-rbind(db_bone_1,db_bone_2)
#unique values (same site,specimen type, material,date,avgs)
db_bone<-unique(db_bone[,c("Site","Site_Country","Longitude",
                      "Latitude","Kingdom","Class","Family",
                      "Taxon","Taxon_Common_Name","Category",
                      "Lab_ID","Date_max","Date_min",
                      "Material_Type","avg_d13C_org",
                      "avg_d15N","avg_d13C_inorg","Age","CN_ratio","Averaged_N",
                      "N_Samples","ID","Specimen_ID",
                      "Reference","DOI_or_Link")])
db_enamel<-db[db$Material_Type=="Enamel",]
db_enamel<-db_enamel[!is.na(db_enamel$Date_min) 
                     & !is.na(db_enamel$Date_max) 
                     & !is.na(db_enamel$d13C_inorg) ,]
db_enamel_1 = db_enamel[!is.na(db_enamel$avg_d13C_inorg),]
db_enamel_2 = db_enamel[is.na(db_enamel$avg_d13C_inorg),]
db_enamel_2$avg_d13C_inorg<-db_enamel_2$d13C_inorg
db_enamel_2$avg_d15N<-db_enamel_2$d15N
db_enamel<-rbind(db_enamel_1,db_enamel_2)
db_enamel<-unique(db_enamel[,c("Site","Site_Country","Longitude",
                      "Latitude","Kingdom","Class","Family",
                      "Taxon","Taxon_Common_Name","Category",
                      "Lab_ID","Date_max","Date_min",
                      "Material_Type","avg_d13C_org",
                      "avg_d15N","avg_d13C_inorg","Age","CN_ratio","Averaged_N",
                      "N_Samples","ID","Specimen_ID",
                      "Reference","DOI_or_Link")])
#add DATE_mean
db_bone$Date_mean = (db_bone$Date_min + db_bone$Date_max)/2
db_enamel$Date_mean = (db_enamel$Date_min + db_enamel$Date_max)/2
```


```{r}
#EXTRACT ENVIRONMENTAL INFO (bioclim, elevation)

#load data
elev <- raster("[path to elevation geotiff]")
elev2<-raster::mask(elev,mask_of_africa)
bioclim_bio_=list() #load bioclim info
for (i in 1:19){bioclim_bio_[[i]]=raster(paste("[path to bioclim info (WorldClim)]", sep = ""))} 

#extract variables for bone & enamel groups: bio1, bio12, bio15, elevation
db_bone$bioclim1<-extract(bioclim_bio_[[1]], db_bone[,c("Longitude","Latitude")])
db_bone$bioclim12<-extract(bioclim_bio_[[12]], db_bone[,c("Longitude","Latitude")])
db_bone$bioclim15<-extract(bioclim_bio_[[15]], db_bone[,c("Longitude","Latitude")])
db_bone$elev<-extract(elev, db_bone[,c("Longitude","Latitude")])
db_enamel$bioclim1<-extract(bioclim_bio_[[1]], db_enamel[,c("Longitude","Latitude")])
db_enamel$bioclim12<-extract(bioclim_bio_[[12]], db_enamel[,c("Longitude","Latitude")])
db_enamel$bioclim15<-extract(bioclim_bio_[[15]], db_enamel[,c("Longitude","Latitude")])
db_enamel$elev<-extract(elev, db_enamel[,c("Longitude","Latitude")])
```


```{r}

#BONE: separate human, plants, animals
humans = db_bone[db_bone$Taxon=="Homo sapiens",]
humans <- humans[!is.na(humans$Site),]
plants = db_bone[ db_bone$Kingdom=="Plantae" & db_bone$Family!="Hominidae",]
plants<-plants[!is.na(plants$Site),]
animals = db_bone[ db_bone$Kingdom=="Animalia" & db_bone$Family!="Hominidae",]
animals<-animals[!is.na(animals$Site),]
###############################

#ENAMEL: separate human, plants, animals
humans_enamel = db_enamel[db_enamel$Taxon=="Homo sapiens",]
humans_enamel<-humans_enamel[!is.na(humans_enamel$Site),]
plants_enamel = db_enamel[ db_enamel$Kingdom=="Plantae" & db_enamel$Family!="Hominidae",]
plants_enamel<-plants_enamel[!is.na(plants_enamel$Site),]
animals_enamel = db_enamel[ db_enamel$Kingdom=="Animalia" & db_enamel$Family!="Hominidae",]
animals_enamel<-animals_enamel[!is.na(animals_enamel$Site),]
###############################
```


```{r}

#HUMANS (bone): CLUSTERING & FILTERING:
test_corr = humans[!is.na(humans$avg_d13C_org),] #remove NA entries
test_corr<-test_corr[test_corr$Site!="el-Hobagi",] #remove no-neighbour outlier
test_corr1 = test_corr[test_corr$Date_mean > 1860 & test_corr$Date_mean <= 1965,]
test_corr1$avg_d13C_org <- test_corr1$avg_d13C_org+( 0.004*(test_corr1$Date_mean-1860))
test_corr2 = test_corr[test_corr$Date_mean > 1965 & test_corr$Date_mean < 2015,]
test_corr2$avg_d13C_org <- test_corr2$avg_d13C_org+0.42+( 0.02*(test_corr2$Date_mean-1965))
test_orig<-test_corr[test_corr$Date_mean < 1860,]
test_corr<-rbind(test_corr1,test_corr2,test_orig)
mini = min(test_corr$avg_d13C_org)
test_corr$adj_avg_d13C_org<-test_corr$avg_d13C_org-mini+1
distance_h_corr <- dist(test_corr[,c("adj_avg_d13C_org","avg_d15N")],method="euclidean",diag=FALSE)
#
#add cluster splits (2-12)
test<-test_corr
distance_h<-distance_h_corr
humansFiltered = test
clust_h_12<-hclust(distance_h, method = "complete")
clust_h_12<-cutree(clust_h_12,k=12)
clust_h_11<-hclust(distance_h, method = "complete")
clust_h_11<-cutree(clust_h_11,k=11)
clust_h_9<-hclust(distance_h, method = "complete")
clust_h_9<-cutree(clust_h_9,k=9)
clust_h_8<-hclust(distance_h, method = "complete")
clust_h_8<-cutree(clust_h_8,k=8)
clust_h_7<-hclust(distance_h, method = "complete")
clust_h_7<-cutree(clust_h_7,k=7)
clust_h_6<-hclust(distance_h, method = "complete")
clust_h_6<-cutree(clust_h_6,k=6)
clust_h_5<-hclust(distance_h, method = "complete")
clust_h_5<-cutree(clust_h_5,k=5)
clust_h_4<-hclust(distance_h, method = "complete")
clust_h_4<-cutree(clust_h_4,k=4)
clust_h_3<-hclust(distance_h, method = "complete")
clust_h_3<-cutree(clust_h_3,k=3)
clust_h_2<-hclust(distance_h, method = "complete")
clust_h_2<-cutree(clust_h_2, k=2)
test$clust_h_2 <- clust_h_2
test$clust_h_colors_2 <- "testy"
##########################
cols<-(c("green","blue"))
clustnum<-c(1:2)
index<-data.frame(cols,clustnum)
test$clust_h_colors_2<-index$cols[ match(test$clust_h_2,index$clustnum)]
humansFiltered$cluster2<-test$clust_h_colors_2
blue = humansFiltered[humansFiltered$cluster2=="blue",]
green = humansFiltered[humansFiltered$cluster2=="green",]
##########################
#preliminary 3-cluster plotting
test$clust_h_3 <- clust_h_3
test$clust_h_colors_3 <- "testy"
cols<-(c("green","blue","darkorchid")) #with suess
clustnum<-c(1:3)
index<-data.frame(cols,clustnum)
test$clust_h_colors_3<-index$cols[ match(test$clust_h_3,index$clustnum)]
humansFiltered$cluster3<-test$clust_h_colors_3
##########################
#preliminary 4-cluster plotting
test$clust_h_4 <- clust_h_4
test$clust_h_colors_4 <- "testy"
cols<-(c("pink","blue","green","darkorchid"))
clustnum<-c(1:4)
index<-data.frame(cols,clustnum)
test$clust_h_colors_4<-index$cols[ match(test$clust_h_4,index$clustnum)]
humansFiltered$cluster4<-test$clust_h_colors_4
##########################
#preliminary 5-cluster plotting
test$clust_h_5 <- clust_h_5
test$clust_h_colors_5 <- "testy"
cols<-(c("pink","blue","green","yellow","darkorchid")) #with suess
clustnum<-c(1:5)
index<-data.frame(cols,clustnum)
test$clust_h_colors_5<-index$cols[ match(test$clust_h_5,index$clustnum)]
humansFiltered$cluster5<-test$clust_h_colors_5
##########################
#preliminary 6-cluster plotting
test$clust_h_6 <- clust_h_6
test$clust_h_colors_6 <- "testy"
cols<-(c("pink","red","green","blue","yellow","darkorchid")) #with suess
clustnum<-c(1:6)
index<-data.frame(cols,clustnum)
test$clust_h_colors_6<-index$cols[ match(test$clust_h_6,index$clustnum)]
humansFiltered$cluster6<-test$clust_h_colors_6
##########################
#preliminary 7-cluster plotting
test$clust_h_7 <- clust_h_7
test$clust_h_colors_7 <- "testy"
cols<-(c("pink","red","green","blue","yellow","darkorchid","gray")) #with suess
clustnum<-c(1:7)
index<-data.frame(cols,clustnum)
test$clust_h_colors_7<-index$cols[ match(test$clust_h_7,index$clustnum)]
humansFiltered$cluster7<-test$clust_h_colors_7
##########################
#preliminary 8-cluster plotting
test$clust_h_8 <- clust_h_8
test$clust_h_colors_8 <- "testy"
cols<-(c("pink","red","green","blue","yellow","darkorchid","orange","gray")) #with suess
clustnum<-c(1:8)
index<-data.frame(cols,clustnum)
test$clust_h_colors_8<-index$cols[ match(test$clust_h_8,index$clustnum)]
humansFiltered$cluster8<-test$clust_h_colors_8
##########################
#preliminary 9-cluster plotting
test$clust_h_9 <- clust_h_9
test$clust_h_colors_9 <- "testy"
cols<-(c("pink","red","green","blue","yellow","darkorchid","orange","gray","yellow4")) #with suess
  #pink group removed due to overall association w/ poor C:N ratios +
clustnum<-c(1:9)
index<-data.frame(cols,clustnum)
test$clust_h_colors_9<-index$cols[ match(test$clust_h_9,index$clustnum)]
humansFiltered$cluster9<-test$clust_h_colors_9
##########################
##preliminary 11-cluster plotting
test$clust_h_11 <- clust_h_11
test$clust_h_colors_11 <- "testy"
cols<-(c("pink","red","green","blue","yellow","darkorchid","orange","gray","yellow","black","black")) #with suess
clustnum<-c(1:11)
index<-data.frame(cols,clustnum)
test$clust_h_colors_11<-index$cols[ match(test$clust_h_11,index$clustnum)]
humansFiltered$cluster11<-test$clust_h_colors_11
##########################
test$clust_h_12 <- clust_h_12
test$clust_h_colors_12 <- "testy"
cols<-(c("pink","red","green","blue","yellow","darkorchid","orange","gray","yellow","black","black","white")) 
clustnum<-c(1:12)
index<-data.frame(cols,clustnum)
test$clust_h_colors_12<-index$cols[ match(test$clust_h_12,index$clustnum)]
humansFiltered$cluster12<-test$clust_h_colors_12
##########################
humansFiltered$status=NA
humansFiltered$status[humansFiltered$CN_ratio < 2.9 | humansFiltered$CN_ratio > 3.6 ]<-"REMOVE"
humansFiltered$status[humansFiltered$Reference=="Froment & Ambrose (1995)"]<-"REMOVE"
humansFiltered$status[humansFiltered$cluster9=="pink"]<-"REMOVE" #lone outlier/individual without neighbours
humansFiltered$status[humansFiltered$Averaged_N==TRUE]<-"REMOVE" #pre-averaged Wadi Halfa indivdiuals
humans_corr=humansFiltered
humans_corr<-humans_corr[is.na(humans_corr$status),]
```


```{r}

#HUMAN ENAMEL FOR SUPPLEMENTARY COMPARISON (not used due to potential carbohydrate biases)
test_corr = humans_enamel[!is.na(humans_enamel$avg_d13C_inorg),]
#
# Apply Suess correction:
test_corr1 = test_corr[test_corr$Date_mean > 1860 & test_corr$Date_mean <= 1965,]
test_corr1$avg_d13C_org <- test_corr1$avg_d13C_org+( 0.004*(test_corr1$Date_mean-1860))
test_corr2 = test_corr[test_corr$Date_mean > 1965 & test_corr$Date_mean < 2015,]
test_corr2$avg_d13C_org <- test_corr2$avg_d13C_org+0.42+( 0.02*(test_corr2$Date_mean-1965))
test_orig<-test_corr[test_corr$Date_mean < 1860,]
test_corr<-rbind(test_corr1,test_corr2,test_orig)
mini = min(test_corr$avg_d13C_org)
test_corr$adj_avg_d13C_org<-test_corr$avg_d13C_org-mini+1
distance_h_corr <- dist(test_corr[,c("adj_avg_d13C_org","avg_d15N")],method="euclidean",diag=FALSE)
#
test <- test_corr
distance_h <- distance_h_corr
humenamelFiltered = test
humenamel_corr = humenamelFiltered
test<-rbind(db_bone,db_enamel)
```


```{r}

#DOMESTIC ANIMALS CLUSTERING
#select domestic animals included in analysis (caprines, cattle, pig, donkey, horse, dog, chicken, camel)
unique(animals$Taxon_Common_Name)
dom<-animals[!is.na(animals$avg_d13C_org),]
dom<-dom[dom$Taxon_Common_Name=="Caprine"|
           dom$Taxon_Common_Name=="Sheep"|  
           dom$Taxon_Common_Name=="Goat"|
           dom$Taxon_Common_Name=="Sheep/Goat"|
           dom$Taxon_Common_Name=="Sheep/goat"|
           dom$Taxon_Common_Name=="Cattle"|
           dom$Taxon_Common_Name=="Pig"|
           dom$Taxon_Common_Name=="Donkey"|
           dom$Taxon_Common_Name=="Horse"|
           dom$Taxon_Common_Name=="Dog"|
           dom$Taxon_Common_Name=="Chicken"|
           dom$Taxon_Common_Name=="Camel",]
#Suess corrections
dom1 = dom[dom$Date_mean > 1860 & dom$Date_mean <= 1965,]
dom1$avg_d13C_org <- dom1$avg_d13C_org+( 0.004*(dom1$Date_mean-1860))
dom2 = dom[dom$Date_mean > 1965 & dom$Date_mean < 2015,]
dom2$avg_d13C_org <- dom2$avg_d13C_org+0.42+( 0.02*(dom2$Date_mean-1965))
dom_orig<-dom[dom$Date_mean < 1860,]
dom<-rbind(dom1,dom2,dom_orig)
mini = min(dom$avg_d13C_org)
dom$adj_avg_d13C_org<-dom$avg_d13C_org-mini+1
#
#clustering
distance_a <- dist(dom[,c("adj_avg_d13C_org","avg_d15N")],method="euclidean",diag=FALSE)
cor.clust_a <- hclust(distance_a/max(distance_a),method="complete")
clust_a_9<-hclust(distance_a, method = "complete")
clust_a_9<-cutree(clust_a_9,k=9)
clust_a_8<-hclust(distance_a, method = "complete")
clust_a_8<-cutree(clust_a_8,k=8)
clust_a_7<-hclust(distance_a, method = "complete")
clust_a_7<-cutree(clust_a_7,k=7)
clust_a_6<-hclust(distance_a, method = "complete")
clust_a_6<-cutree(clust_a_6,k=6)
clust_a_5<-hclust(distance_a, method = "complete")
clust_a_5<-cutree(clust_a_5,k=5)
clust_a_4<-hclust(distance_a, method = "complete")
clust_a_4<-cutree(clust_a_4,k=4)
clust_a_3<-hclust(distance_a, method = "complete")
clust_a_3<-cutree(clust_a_3,k=3)
clust_a_2<-hclust(distance_a, method = "complete")
clust_a_2<-cutree(clust_a_2, k=2)
#########################################
#2-clustering split
dom$clust_a_2 <- clust_a_2
dom$clust_a_colors_2 <- "domy"
cols<-(c("dodgerblue","orange"))
clustnum<-c(1:2)
index<-data.frame(cols,clustnum)
dom$clust_a_colors_2<-index$cols[ match(dom$clust_a_2,index$clustnum)]
dom$cluster2<-dom$clust_a_colors_2
#
#3-clustering split
dom$clust_a_3 <- clust_a_3
dom$clust_a_colors_3 <- "domy"
cols<-(c("dodgerblue","forestgreen","firebrick"))
clustnum<-c(1:3)
index<-data.frame(cols,clustnum)
dom$clust_a_colors_3<-index$cols[ match(dom$clust_a_3,index$clustnum)]
dom$cluster3<-dom$clust_a_colors_3
#
#4-clustering split
dom$clust_a_4 <- clust_a_4
dom$clust_a_colors_4 <- "domy"
cols<-(c("dodgerblue","forestgreen","darkorange3","firebrick"))
clustnum<-c(1:4)
index<-data.frame(cols,clustnum)
dom$clust_a_colors_4<-index$cols[ match(dom$clust_a_4,index$clustnum)]
dom$cluster4<-dom$clust_a_colors_4
unique(dom$cluster4)
##########
#5-clustering split
dom$clust_a_5 <- clust_a_5
dom$clust_a_colors_5 <- "domy"
cols<-(c("dodgerblue","forestgreen","firebrick","orange","darkorange3"))
clustnum<-c(1:5)
index<-data.frame(cols,clustnum)
dom$clust_a_colors_5<-index$cols[ match(dom$clust_a_5,index$clustnum)]
dom$cluster5<-dom$clust_a_colors_5
unique(dom$cluster5)
#6-clustering split
dom$clust_a_6 <- clust_a_6
dom$clust_a_colors_6 <- "domy"
cols<-(c("cornsilk","dodgerblue","forestgreen","firebrick","orange","darkorange3"))
clustnum<-c(1:6)
index<-data.frame(cols,clustnum)
dom$clust_a_colors_6<-index$cols[ match(dom$clust_a_6,index$clustnum)]
dom$cluster6<-dom$clust_a_colors_6
unique(dom$cluster6)
#7-clustering split
dom$clust_a_7 <- clust_a_7
dom$clust_a_colors_7 <- "domy"
cols<-(c("cornsilk","dodgerblue","forestgreen","firebrick","orange","darkorange3","tan"))
clustnum<-c(1:7)
index<-data.frame(cols,clustnum)
dom$clust_a_colors_7<-index$cols[ match(dom$clust_a_7,index$clustnum)]
dom$cluster7<-dom$clust_a_colors_7
unique(dom$cluster7)
#8-clustering split
dom$clust_a_8 <- clust_a_8
dom$clust_a_colors_8 <- "domy"
cols<-(c("cornsilk","dodgerblue","forestgreen","firebrick","orange","darkorange3","chocolate","tan"))
clustnum<-c(1:8)
index<-data.frame(cols,clustnum)
dom$clust_a_colors_8<-index$cols[ match(dom$clust_a_8,index$clustnum)]
dom$cluster8<-dom$clust_a_colors_8
unique(dom$cluster8)
#9-clustering split
dom$clust_a_9 <- clust_a_9
dom$clust_a_colors_9 <- "domy"
cols<-(c("cornsilk","darkgray","forestgreen","firebrick","dodgerblue","orange","darkorange3","chocolate","tan"))
clustnum<-c(1:9)
index<-data.frame(cols,clustnum)
dom$clust_a_colors_9<-index$cols[ match(dom$clust_a_9,index$clustnum)]
dom$cluster9<-dom$clust_a_colors_9
unique(dom$cluster9)
#####################
dom$clust_a_2<-NULL
dom$clust_a_3<-NULL
dom$clust_a_4<-NULL
dom$clust_a_5<-NULL
dom$clust_a_6<-NULL
dom$clust_a_7<-NULL
dom$clust_a_8<-NULL
dom$clust_a_colors_2<-NULL
dom$clust_a_colors_3<-NULL
dom$clust_a_colors_4<-NULL
dom$clust_a_colors_5<-NULL
dom$clust_a_colors_6<-NULL
dom$clust_a_colors_7<-NULL
dom$clust_a_colors_8<-NULL
rbPal = colorRampPalette(c('black',"lightgray"))
unique(dom$cluster3)
unique(dom$cluster5)
#
#FILTER FOR  ACCURACY OF PLOTS/SITE-SPECIFIC INTERPRETATION
dom_corr = dom
dom_corr <- dom_corr[dom_corr$CN_ratio >= 2.9 & dom_corr$CN_ratio <= 3.6,]
dom_corr<-dom_corr[!is.na(dom_corr$Site),]
dom_corr_sub = dom_corr
dom_corr_sub$C3C4split <- dom_corr$cluster8
dom_corr_sub$C3C4split[dom_corr_sub$C3C4split=="firebrick"|dom_corr_sub$C3C4split=="dodgerblue"|dom_corr_sub$C3C4split=="cornsilk"]<-"dodgerblue"
dom_corr_sub$C3C4split[dom_corr_sub$C3C4split=="forestgreen"|dom_corr_sub$C3C4split=="tan"|dom_corr_sub$C3C4split=="orange"]<-"forestgreen"
dom_corr$cluster2[dom_corr$cluster2=="orange"]<-"forestgreen"
dom_corr$cluster8[dom_corr$cluster8=="orange"]<-"darkorange2"
```


```{r}

#DOMESTIC ENAMEL
domenamel<-animals_enamel[!is.na(animals_enamel$avg_d13C_inorg),]
domenamel<-domenamel[domenamel$Taxon_Common_Name=="Caprine"|
           domenamel$Taxon_Common_Name=="Sheep"|  
           domenamel$Taxon_Common_Name=="Goat"|
           domenamel$Taxon_Common_Name=="Sheep/Goat"|
           domenamel$Taxon_Common_Name=="Sheep/goat"|
           domenamel$Taxon_Common_Name=="Cattle"|
           domenamel$Taxon_Common_Name=="Pig"|
           domenamel$Taxon_Common_Name=="Donkey"|
           domenamel$Taxon_Common_Name=="Horse"|
           domenamel$Taxon_Common_Name=="Dog"|
           domenamel$Taxon_Common_Name=="Chicken"|
           domenamel$Taxon_Common_Name=="Camel",]
domenamel<-domenamel[domenamel$Site != "Boomplaas Cave",]
#
#Apply Suess corrections for domestic enamel
corr1 = domenamel[domenamel$Date_mean > 1860 & domenamel$Date_mean <= 1965,]
corr1$avg_d13C_inorg <- corr1$avg_d13C_inorg+( 0.004*(corr1$Date_mean-1860))
corr2 = domenamel[domenamel$Date_mean > 1965 & domenamel$Date_mean < 2015,]
corr2$avg_d13C_inorg <- corr2$avg_d13C_inorg+0.42+( 0.02*(corr2$Date_mean-1965))
test<-domenamel[domenamel$Date_mean < 1860,]
domenamel<-rbind(corr1,corr2,test)
#adjust to remove enamel 13C enrichment (
  #Krueger & Sullivan 1984; Lee-Thorp et al. 1989; Fernandes et al. 2012
domenamel$avg_d13C_inorg_corr1 <- domenamel$avg_d13C_inorg-8.2 #6.8±1.4 [8.2 - 5.4]
domenamel$avg_d13C_inorg_corr2 <- domenamel$avg_d13C_inorg-5.4 #6.8±1.4 [8.2 - 5.4]
#########################################
#
#MANUAL CLUSTER DESIGNATION BASED ON BONE RANGES
domenamel$clusterManualGeneral<-NA
domenamel$clusterManualSpecific<-NA
domenamel$clusterManualGeneral[domenamel$avg_d13C_inorg_corr1 > -14.6 & 
                                 domenamel$avg_d13C_inorg_corr2 > -14.6]<-"dodgerblue"
domenamel$clusterManualSpecific[domenamel$avg_d13C_inorg_corr1 > -8.93]<-"dodgerblue"
domenamel$clusterManualSpecific[domenamel$avg_d13C_inorg_corr1 > -14.7 & 
                                 domenamel$avg_d13C_inorg_corr1 < -9.7 & 
                                 domenamel$avg_d13C_inorg_corr2 > -14.7 & 
                                 domenamel$avg_d13C_inorg_corr2 < -9.7]<-"cornsilk"
domenamel$clusterManualGeneral[domenamel$avg_d13C_inorg_corr1 < -14.8 & 
                                 domenamel$avg_d13C_inorg_corr2 < -14.8]<-"forestgreen"
domenamel_corr = domenamel
domenamel_corr$livelihoodDescrip = NA
```


```{r}

#WILD ANIMALS (not domestic)
wild<-animals[!is.na(animals$avg_d13C_org),]
wild<-wild[wild$Taxon_Common_Name!="Caprine"&
           wild$Taxon_Common_Name!="Sheep"&  
           wild$Taxon_Common_Name!="Goat"&
           wild$Taxon_Common_Name!="Sheep/Goat"&
           wild$Taxon_Common_Name!="Sheep/goat"&
           wild$Taxon_Common_Name!="Camel"&
           wild$Taxon_Common_Name!="Cattle"&
           wild$Taxon_Common_Name!="Pig"&
           wild$Taxon_Common_Name!="Donkey"&
           wild$Taxon_Common_Name!="Horse"&
           wild$Taxon_Common_Name!="Dog"&
           wild$Taxon_Common_Name!="Chicken"&
           wild$Taxon_Common_Name!="Camel"&
           wild$Taxon_Common_Name!="Bovid"&
           wild$Taxon_Common_Name!="Caprini"&
           wild$Taxon_Common_Name!="Equid" & 
           wild$Taxon_Common_Name!="Bovid Size 1-2" & 
           wild$Taxon_Common_Name!="Bovid Size 3" & 
           wild$Taxon_Common_Name!="Bovid Size 3-4" &
           wild$Taxon_Common_Name!="Bovid Size 3-4 cf. Bovini",]
unique(wild$Taxon_Common_Name)
#
#Add Suess corrections (wild: bone, enamel)
wild_corr = wild[wild$Date_mean > 1860 & wild$Date_mean <= 1965,]
wild_corr$avg_d13C_org <- wild_corr$avg_d13C_org+( 0.004*(wild_corr$Date_mean-1860))
wild_corr2 = wild[wild$Date_mean > 1965 & wild$Date_mean < 2015,]
wild_corr2$avg_d13C_org
wild_corr2$avg_d13C_org <- wild_corr2$avg_d13C_org+0.42+( 0.02*(wild_corr2$Date_mean-1965))
test<-wild[wild$Date_mean < 1860,]
wild_corr<-rbind(wild_corr,wild_corr2,test)
wildenamel<-animals_enamel[!is.na(animals_enamel$avg_d13C_inorg),]
wildenamel<-wildenamel[wildenamel$Taxon_Common_Name!="Caprine"&
           wildenamel$Taxon_Common_Name!="Sheep"&  
           wildenamel$Taxon_Common_Name!="Goat"&
           wildenamel$Taxon_Common_Name!="Sheep/Goat"&
           wildenamel$Taxon_Common_Name!="Sheep/goat"&
           wildenamel$Taxon_Common_Name!="Cattle"&
           wildenamel$Taxon_Common_Name!="Pig"&
           wildenamel$Taxon_Common_Name!="Donkey"&
           wildenamel$Taxon_Common_Name!="Horse"&
           wildenamel$Taxon_Common_Name!="Dog"&
           wildenamel$Taxon_Common_Name!="Chicken"&
           wildenamel$Taxon_Common_Name!="Camel" &
           wildenamel$Taxon_Common_Name!="Bovid"&
           wildenamel$Taxon_Common_Name!="Caprini"&
           wildenamel$Taxon_Common_Name!="Equid" & 
           wildenamel$Taxon_Common_Name!="Bovid Size 1-2" & 
           wildenamel$Taxon_Common_Name!="Bovid Size 3" & 
           wildenamel$Taxon_Common_Name!="Bovid Size 3-4" &
           wildenamel$Taxon_Common_Name!="Bovid Size 3-4 cf. Bovini",]
wildenamel_corr = wildenamel[wildenamel$Date_mean > 1860 & wildenamel$Date_mean <= 1965,]
wildenamel_corr$avg_d13C_org <- wildenamel_corr$avg_d13C_org+( 0.004*(wildenamel_corr$Date_mean-1860))
wildenamel_corr2 = wildenamel[wildenamel$Date_mean > 1965 & wildenamel$Date_mean < 2015,]
wildenamel_corr2$avg_d13C_org
wildenamel_corr2$avg_d13C_org <- wildenamel_corr2$avg_d13C_org+0.42+( 0.02*(wildenamel_corr2$Date_mean-1965))
test<-wildenamel[wildenamel$Date_mean < 1860,]
wildenamel_corr<-rbind(wildenamel_corr,wildenamel_corr2,test)
```


```{r}

#FIGURE S1: compare 13C & 15N with climate variables
test13Co<-lm(humans_corr$avg_d13C_org~humans_corr$bioclim1)
test13C<-lm(humans_corr$avg_d13C_org~humans_corr$bioclim12)
test15N<-lm(humans_corr$avg_d15N~humans_corr$bioclim12)
test13Cb<-lm(humans_corr$avg_d13C_org~humans_corr$bioclim15)
test15Nb<-lm(humans_corr$avg_d15N~humans_corr$bioclim15)
test13Cc<-lm(humans_corr$avg_d13C_org~humans_corr$elev)
test15Nc<-lm(humans_corr$avg_d15N~humans_corr$elev)
#
#time slices for comparison (AHP; AHP termination; recent millennium)
multiEarly <- humans_corr[humans_corr$Date_mean < -3000,]
multiMid <- humans_corr[humans_corr$Date_mean >= -3000 & 
                          humans_corr$Date_mean < 1000,]
multiRecent <- humans_corr[humans_corr$Date_mean >= 1000,]
multiple13C<-lm(humans_corr$avg_d13C_org~humans_corr$bioclim12+humans_corr$bioclim15+humans_corr$elev)
multiple15N<-lm(humans_corr$avg_d15N~humans_corr$bioclim12+humans_corr$bioclim15+humans_corr$elev)
multiple13CEarly<-lm(multiEarly$avg_d13C_org~multiEarly$bioclim12+multiEarly$bioclim15+multiEarly$elev)
multiple15NEarly<-lm(multiEarly$avg_d15N~multiEarly$bioclim12+multiEarly$bioclim15+multiEarly$elev)
multiple13CMid<-lm(multiMid$avg_d13C_org~multiMid$bioclim12+multiMid$bioclim15+multiMid$elev)
multiple15NMid<-lm(multiMid$avg_d15N~multiMid$bioclim12+multiMid$bioclim15+multiMid$elev)
multiple13CRecent<-lm(multiRecent$avg_d13C_org~multiRecent$bioclim12+multiRecent$bioclim15+multiRecent$elev)
multiple15NRecent<-lm(multiRecent$avg_d15N~multiRecent$bioclim12+multiRecent$bioclim15+multiRecent$elev)
test1<-c(summary(multiple13CEarly)$coefficients[,4][2],
         summary(multiple13CMid)$coefficients[,4][2],
         summary(multiple13CRecent)$coefficients[,4][2])
test2<-c(summary(multiple13CEarly)$r.squared,
         summary(multiple13CMid)$r.squared, 
         summary(multiple13CRecent)$r.squared)
test3<-c(summary(multiple15NEarly)$coefficients[,4][2],
         summary(multiple15NMid)$coefficients[,4][2], 
         summary(multiple15NRecent)$coefficients[,4][2])
test4<-c(summary(multiple15NEarly)$r.squared,
         summary(multiple15NMid)$r.squared, 
         summary(multiple15NRecent)$r.squared)
test<-data.frame(test1,test2,test3,test4)
test[4,][,1]<-summary(multiple13C)$coefficients[,4][2]
test[4,][,2]<-summary(multiple13C)$r.squared
test[4,][,3]<-summary(multiple15N)$coefficients[,4][2]
test[4,][,4]<-summary(multiple15N)$r.squared
colnames(test)<-c("pval.13C","r^2.13C","pval.15N","r^2.15N")
rownames(test)<-c("<5000 BP","5000-1000 BP","1000-0 BP","All Holocene")
test$pval.13C[test$pval.13C<0.001]<-"***"
test$pval.15N[test$pval.13C<0.001]<-"***"
test$pval.13C[test$pval.13C<0.01 & test$pval.13C>=0.001]<-"**"
test$pval.15N[test$pval.13C<0.01 & test$pval.13C>=0.001]<-"**"
write.csv(test,file="[path to file csv]")
```

```{r}
#Figure 1
C3Human = humans_corr[humans_corr$cluster2=="green",]
C4Human = humans_corr[humans_corr$cluster2=="blue",]
greenHumanDescrip = humans_corr[humans_corr$cluster9=="green",]
yellowHumanDescrip = humans_corr[humans_corr$cluster9=="yellow",]
blueHumanDescrip = humans_corr[humans_corr$cluster9=="blue",]
redHumanDescrip = humans_corr[humans_corr$cluster9=="red",]
orangeHumanDescrip = humans_corr[humans_corr$cluster9=="orange",]
purpleHumanDescrip = humans_corr[humans_corr$cluster9=="darkorchid",]
grayHumanDescrip = humans_corr[humans_corr$cluster9=="gray",]
#
#identify pre-agricultural diets
subsaharan = humans_corr[humans_corr$Latitude <= 11 & humans_corr$Latitude >= -9 & humans_corr$Date_mean < -3500,]
southern = humans_corr[humans_corr$Latitude < -9 & humans_corr$Date_mean < -500,]
preAg = rbind(subsaharan,southern)
preAgPeriod=list()
for(i in 1:110){ preAgPeriod[[i]]<-humans_corr[humans_corr$Date_min < -9000+(100*i),]}
preAgPeriod2=list()
for(i in 1:11){ preAgPeriod2[[i]]<-humans_corr[humans_corr$Date_mean < -9000+(1000*i) & 
                                                humans_corr$Date_mean > -10000+(1000*i),]}
preAgPeriod2bin = list()
preAgPeriod2bin[[1]] = rbind(preAgPeriod2[[1]],preAgPeriod2[[2]],preAgPeriod2[[3]],preAgPeriod2[[4]]) # 10000 - 7000BP
preAgPeriod2bin[[2]] = rbind(preAgPeriod2[[5]],preAgPeriod2[[6]]) #6000-5000 BP
preAgPeriod2bin[[3]] = rbind(preAgPeriod2[[7]],preAgPeriod2[[8]]) #4000-3000 BP
preAgPeriod2bin[[4]] = preAgPeriod2[[9]] #2000 BP
preAgPeriod2bin[[5]] = preAgPeriod2[[10]] #1000 BP
preAgPeriod2bin[[6]] = preAgPeriod2[[11]] #0 BP
nrow(preAg[preAg$cluster9=="yellow",])/nrow(preAg)
nrow(preAg[preAg$cluster9=="orange",])/nrow(preAg)
#
date = c(1,2,3,4,5,6,7,8,9,10,11)
C3cult_count=c()
C4past_count=c()
FoodGather_count=c()
FoodGatherOr_count=c()
for(i in 1:11){C3cult_count[i] = nrow(preAgPeriod2[[i]][ preAgPeriod2[[i]]$cluster9 == "green" | preAgPeriod2[[i]]$cluster9 == "darkorchid",] )}
for(i in 1:11){C4past_count[i] = nrow(preAgPeriod2[[i]][ preAgPeriod2[[i]]$cluster9 == "blue" | preAgPeriod2[[i]]$cluster9 == "red",] )}
for(i in 1:11){FoodGather_count[i] = nrow(preAgPeriod2[[i]][ preAgPeriod2[[i]]$cluster9 == "yellow",] )}
for(i in 1:11){FoodGatherOr_count[i] = nrow(preAgPeriod2[[i]][ preAgPeriod2[[i]]$cluster9 == "orange",] )}
#
C3cult_count=data.frame(date,C3cult_count)
C3cult_count$prop = NA
for(i in 1:11){C3cult_count[i,][,"prop"] = C3cult_count[i,][,"C3cult_count"]/nrow(preAgPeriod2[[i]])}
C3cult_count$prop[is.nan(C3cult_count$prop)]<-0
C4past_count=data.frame(date,C4past_count)
C4past_count$prop = NA
for(i in 1:11){C4past_count[i,][,"prop"] = C4past_count[i,][,"C4past_count"]/nrow(preAgPeriod2[[i]])}
C4past_count$prop[is.nan(C4past_count$prop)]<-0
FoodGather_count=data.frame(date,FoodGather_count)
FoodGather_count$prop = NA
for(i in 1:11){FoodGather_count[i,][,"prop"] = FoodGather_count[i,][,"FoodGather_count"]/nrow(preAgPeriod2[[i]])}
FoodGather_count$prop[is.nan(FoodGather_count$prop)]<-0
FoodGatherOr_count=data.frame(date,FoodGatherOr_count)
FoodGatherOr_count$prop = NA
for(i in 1:11){FoodGatherOr_count[i,][,"prop"] = FoodGatherOr_count[i,][,"FoodGatherOr_count"]/nrow(preAgPeriod2[[i]])}
FoodGatherOr_count$prop[is.nan(FoodGatherOr_count$prop)]<-0
C3cult_count2 = C3cult_count
C3cult_count2[1:10,][,"C3cult_count"]<-0
C3cult_count2[1:10,][,"prop"]<-0
hallo = preAgPeriod2
for(i in 1:11){hallo[[i]]<-hallo[[i]][hallo[[i]]$cluster9=="blue"|hallo[[i]]$cluster9=="red",] }
```


```{r}
#related to Figure 1, 2

#temporal development: animal production systems
humans_corr$cluster9[humans_corr$cluster2=="blue"]
preAgPeriod_dom=list()
for(i in 1:11){ preAgPeriod_dom[[i]]<-dom_corr[dom_corr$Date_min < -9000+(1000*i),]}
for(time in 1:11){HFsub1 = preAgPeriod_dom[[time]]}
HFsub1 = humans_corr
HFsub1[HFsub1=="blue"]<-"blue4"
HFsub1[HFsub1=="green"]<-"green4"
#
#clustering
domenamel_sub = domenamel_corr
domenamel_sub$C3C4split <- domenamel$clusterManualGeneral
domenamel_sub$cluster8 <- domenamel$clusterManualSpecific
domenamel_sub<-domenamel_sub[!is.na(domenamel_sub$C3C4split),]
domAndDomenamel_sub = rbind(dom_corr_sub[,c("Site","Site_Country","Date_mean","C3C4split","cluster8","bioclim1","bioclim12","bioclim15","elev","Taxon_Common_Name")],domenamel_sub[,c("Site","Site_Country","Date_mean","C3C4split","cluster8","bioclim1","bioclim12","bioclim15","elev","Taxon_Common_Name")])
#
# % of AP systems C3/C4
nrow(domAndDomenamel_sub[domAndDomenamel_sub$C3C4split=="dodgerblue",])
nrow(domAndDomenamel_sub[domAndDomenamel_sub$C3C4split=="dodgerblue",])/nrow(domAndDomenamel_sub)
nrow(domAndDomenamel_sub[domAndDomenamel_sub$C3C4split=="forestgreen",])
nrow(domAndDomenamel_sub[domAndDomenamel_sub$C3C4split=="forestgreen",])/nrow(domAndDomenamel_sub)
#
# sites C3/C4
length(unique(domAndDomenamel_sub$Site[domAndDomenamel_sub$C3C4split=="dodgerblue"]))
length(unique(domAndDomenamel_sub$Site[domAndDomenamel_sub$C3C4split=="dodgerblue"]))/length(unique(domAndDomenamel_sub$Site))
length(unique(domAndDomenamel_sub$Site[domAndDomenamel_sub$C3C4split=="forestgreen"]))
length(unique(domAndDomenamel_sub$Site[domAndDomenamel_sub$C3C4split=="forestgreen"]))/length(unique(domAndDomenamel_sub$Site))
#
####################
#variability
cv(dom_corr_sub$avg_d13C_org[dom_corr_sub$cluster3=="dodgerblue"])
cv(humans_corr$avg_d13C_org[humans_corr$cluster9=="blue"|humans_corr$cluster9=="red"|humans_corr$cluster9=="gray"])
cv(dom_corr_sub$avg_d15N[dom_corr_sub$cluster3=="dodgerblue"])
cv(humans_corr$avg_d15N[humans_corr$cluster8=="blue"|humans_corr$cluster9=="red"|humans_corr$cluster9=="gray"])
cv(dom_corr_sub$avg_d13C_org[dom_corr_sub$cluster8=="firebrick"])
cv(humans_corr$avg_d15N[humans_corr$cluster8=="yellow"])
cv(humans_corr$avg_d15N[humans_corr$cluster8=="green"])
####################
cv(dom_corr$avg_d13C_org[dom_corr_sub$C3C4split=="forestgreen"])
cv(humans_corr$avg_d13C_org[humans_corr$cluster2=="green"])
cv(humans_corr$avg_d15N[humans_corr$cluster2=="green"])
####################
cv(dom_corr$avg_d13C_org[dom_corr_sub$cluster8=="forestgreen" & dom_corr_sub$avg_d15N < 8])
cv(humans_corr$avg_d13C_org[humans_corr$cluster9=="orange"])
cv(dom_corr$avg_d15N[dom_corr_sub$cluster8=="forestgreen" & dom_corr_sub$avg_d15N < 8])
cv(humans_corr$avg_d15N[humans_corr$cluster9=="orange"])
####################
cv(dom_corr$avg_d13C_org[dom_corr_sub$cluster8=="forestgreen" & dom_corr_sub$avg_d15N > 8])
cv(humans_corr$avg_d13C_org[humans_corr$cluster9=="orange"])
cv(dom_corr$avg_d15N[dom_corr_sub$cluster8=="forestgreen" & dom_corr_sub$avg_d15N > 8])
cv(humans_corr$avg_d15N[humans_corr$cluster9=="orange"])
C4dom = dom_corr[dom_corr$cluster2=="dodgerblue",]
C3dom = dom_corr[dom_corr$cluster2=="forestgreen",]
####################
test<-humans_corr[humans_corr$Site %in% grayHumanDescrip$Site,]
test2<-wild_corr[wild_corr$Site %in% grayHumanDescrip$Site,]
test2<-animals[animals$Site %in% grayHumanDescrip$Site,]
hFsub = humans_corr
hFsub[hFsub=="blue"]<-"#3846e8"
```


```{r}

#Figure S5 - weaning/breastfeeding (Juvenile v. adult)
humansFiltered_sub = humans_corr
humansFiltered_sub[humansFiltered_sub=="blue"]<-"dodgerblue"
juveniles = humans_corr[humans_corr$Age=="Juvenile",]
juveniles<-juveniles[!is.na(juveniles$Site),]
vec = c("Kellis","Leptiminus","N!oma","Sanga","Kgaswe","Toutswemogala",
        "Bonwapitse","Taukome","Bosutswe","Thatswane")
juvenilescheck = juveniles[juveniles$Site %in% vec,]
8/nrow(juvenilescheck)
adults=humans_corr[humans_corr$Age=="Adult",]
adults<-adults[!is.na(adults$Site),]
#
adultsdf=list()
adultsdf[[1]] = adults[adults$cluster9=="yellow",]
adultsdf[[2]] = adults[adults$cluster9=="darkorchid",]
adultsdf[[3]] = adults[adults$cluster9=="blue",]
adultsdf[[4]] = adults[adults$cluster9=="red",]
adultsdf[[5]] = adults[adults$cluster9=="green",]
juvenilesdf = list()
juvenilesdf[[1]] = juveniles[juveniles$cluster9=="yellow",]
juvenilesdf[[2]] = juveniles[juveniles$cluster9=="darkorchid",]
juvenilesdf[[3]] = juveniles[juveniles$cluster9=="blue",]
juvenilesdf[[4]] = juveniles[juveniles$cluster9=="red",]
juvenilesdf[[5]] = juveniles[juveniles$cluster9=="green",]
colours=vector()
juv=list()
juv[[1]] = humansFiltered_sub[humansFiltered_sub$cluster9 == "dodgerblue" | 
                             humansFiltered_sub$cluster9 == "red",]
juv[[2]] = humansFiltered_sub[humansFiltered_sub$cluster9 == "pink" | 
                             humansFiltered_sub$cluster9 == "green"|
                              humansFiltered_sub$cluster9 == "orange" ,]
juv[[3]] = humansFiltered_sub[humansFiltered_sub$cluster9 == "yellow" | 
                             humansFiltered_sub$cluster9 == "darkorchid"|
                             humansFiltered_sub$cluster9 == "gray",]
for(i in 1:3){colours[i]<-nrow(juv[[i]][!is.na(juv[[i]]$Age) &
                               juv[[i]]$Age=="Juvenile",]) / nrow(juv[[i]])}
coloursb = c("dodgerblue","green","yellow")
coloursdf = data.frame(colours,coloursb)
test<-juv[[3]]
########################################
unique(humans_corr$cluster9)
colours=vector()
n=vector()
juv=list()
juv[[1]] = humans_corr[humans_corr$cluster9 == "blue",]
juv[[2]] = humans_corr[humans_corr$cluster9 == "red",]
juv[[3]] = humans_corr[humans_corr$cluster9 == "pink",]  
juv[[4]] = humans_corr[humans_corr$cluster9 == "green",]  
juv[[5]] = humans_corr[humans_corr$cluster9 == "yellow",]
juv[[6]] = humans_corr[humans_corr$cluster9 == "gray",]
juv[[7]] = humans_corr[humans_corr$cluster9 == "darkorchid",]
juv[[8]] = humans_corr[humans_corr$cluster9 == "orange",]
for(i in 1:8){colours[i]<-nrow(juv[[i]][!is.na(juv[[i]]$Age) &
                               juv[[i]]$Age=="Juvenile",]) / nrow(juv[[i]])}
for(i in 1:8){n[i]<-nrow(juv[[i]][!is.na(juv[[i]]$Age) &
                               juv[[i]]$Age=="Juvenile",])}
coloursb = c("blue","red","pink","green","yellow","gray","purple","orange")
coloursdf = data.frame(colours,coloursb,n)
test<-juv[[5]]
test2<-juv[[3]]
test<-humansFiltered_sub[humansFiltered_sub$Age=="Juvenile",]
####################
colours=vector()
adult=list()
adult[[1]] = humansFiltered_sub[humansFiltered_sub$cluster9 == "blue",]
adult[[2]] = humansFiltered_sub[humansFiltered_sub$cluster9 == "red",]
adult[[3]] = humansFiltered_sub[humansFiltered_sub$cluster9 == "pink",]  
adult[[4]] = humansFiltered_sub[humansFiltered_sub$cluster9 == "green",]  
adult[[5]] = humansFiltered_sub[humansFiltered_sub$cluster9 == "yellow",]
adult[[6]] = humansFiltered_sub[humansFiltered_sub$cluster9 == "gray",]
adult[[7]] = humansFiltered_sub[humansFiltered_sub$cluster9 == "darkorchid",]
for(i in 1:7){colours[i]<-nrow(adult[[i]][!is.na(adult[[i]]$Age) &
                               adult[[i]]$Age=="Adult",]) / nrow(adult[[i]])}
coloursb = c("blue","red","pink","green","yellow","gray","purple")
coloursdf_adult = data.frame(colours,coloursb)
test<-adult[[5]]
test2<-adult[[3]]
test<-humansFiltered_sub[humansFiltered_sub$Age=="Adult",]
#
#PLOT BY SITE(S)
kellis = humansFiltered_sub[humansFiltered_sub$Site=="Kellis",]
kellisjuveniles = kellis[kellis$Age=="Juvenile",]
kellisadults = kellis[kellis$Age=="Adult",]
kellisadults<-kellisadults[!is.na(kellisadults$Site),]
pdf("[path]kellisjuveniles.pdf")
par(mfrow=c(2,2))
plot(humansFiltered_sub$avg_d13C_org, humansFiltered_sub$avg_d15N, pch = 16, col=humansFiltered_sub$cluster9, ylim=c(5,25),xlim=c(-30,0), cex=1, main="human diets")
points(kellis$avg_d13C_org, kellis$avg_d15N, pch = 16, col=kellis$cluster9, cex=1)
points(kellisjuveniles$avg_d13C_org, kellisjuveniles$avg_d15N, pch = 16, cex=0.75, col="white")
points(kellisjuveniles$avg_d13C_org, kellisjuveniles$avg_d15N, pch = 16, cex=0.5, col=kellisjuveniles$cluster9)
points(kellisadults$avg_d13C_org, kellisadults$avg_d15N, pch = 16, cex=0.4, col="black")
plot(kellis$avg_d13C_org, kellis$avg_d15N, pch = 16, col=kellis$cluster9, ylim=c(5,25),xlim=c(-30,0), cex=1, main="Identified juveniles: Kellis")
points(kellisjuveniles$avg_d13C_org, kellisjuveniles$avg_d15N, pch = 16, cex=0.75, col="white")
points(kellisjuveniles$avg_d13C_org, kellisjuveniles$avg_d15N, pch = 16, cex=0.5, col=kellisjuveniles$cluster9)
points(kellisadults$avg_d13C_org, kellisadults$avg_d15N, pch = 16, cex=0.4, col="black")
dev.off()
###################
leptiminus = humansFiltered_sub[humansFiltered_sub$Site=="Leptiminus",]
leptiminusjuveniles = leptiminus[leptiminus$Age=="Juvenile",]
leptiminusadults = leptiminus[leptiminus$Age=="Adult",]
leptiminusadults<-leptiminusadults[!is.na(leptiminusadults$Site),]
pdf("[path]leptiminusjuveniles.pdf")
par(mfrow=c(2,2))
plot(humansFiltered_sub$avg_d13C_org, humansFiltered_sub$avg_d15N, pch = 16, col=humansFiltered_sub$cluster9, ylim=c(5,25),xlim=c(-30,0), cex=1, main="human diets")
points(leptiminus$avg_d13C_org, leptiminus$avg_d15N, pch = 16, col=leptiminus$cluster9, cex=1)
points(leptiminusjuveniles$avg_d13C_org, leptiminusjuveniles$avg_d15N, pch = 16, cex=0.75, col="white")
points(leptiminusjuveniles$avg_d13C_org, leptiminusjuveniles$avg_d15N, pch = 16, cex=0.5, col=leptiminusjuveniles$cluster9)
points(leptiminusadults$avg_d13C_org, leptiminusadults$avg_d15N, pch = 16, cex=0.4, col="black")
plot(leptiminus$avg_d13C_org, leptiminus$avg_d15N, pch = 16, col=leptiminus$cluster9, ylim=c(5,25),xlim=c(-30,0), cex=1, main="Identified juveniles: Leptiminus")
points(leptiminusjuveniles$avg_d13C_org, leptiminusjuveniles$avg_d15N, pch = 16, cex=0.75, col="white")
points(leptiminusjuveniles$avg_d13C_org, leptiminusjuveniles$avg_d15N, pch = 16, cex=0.5, col=leptiminusjuveniles$cluster9)
points(leptiminusadults$avg_d13C_org, leptiminusadults$avg_d15N, pch = 16, cex=0.4, col="black")
dev.off()
#################
sanga = humansFiltered_sub[humansFiltered_sub$Site=="Sanga",]
sangajuveniles = sanga[sanga$Age=="Juvenile",]
sangaadults = sanga[sanga$Age=="Adult",]
sangaadults<-sangaadults[!is.na(sangaadults$Site),]
pdf("[path]sangajuveniles.pdf")
par(mfrow=c(2,2))
plot(humansFiltered_sub$avg_d13C_org, humansFiltered_sub$avg_d15N, pch = 16, col=humansFiltered_sub$cluster9, ylim=c(5,25),xlim=c(-30,0), cex=1, main="human diets")
points(sanga$avg_d13C_org, sanga$avg_d15N, pch = 16, col=sanga$cluster9, cex=1)
points(sangajuveniles$avg_d13C_org, sangajuveniles$avg_d15N, pch = 16, cex=0.75, col="white")
points(sangajuveniles$avg_d13C_org, sangajuveniles$avg_d15N, pch = 16, cex=0.5, col=sangajuveniles$cluster9)
points(sangaadults$avg_d13C_org, sangaadults$avg_d15N, pch = 16, cex=0.4, col="black")
plot(sanga$avg_d13C_org, sanga$avg_d15N, pch = 16, col=sanga$cluster9, ylim=c(5,25),xlim=c(-30,0), cex=1, main="Identified juveniles: sanga")
points(sangajuveniles$avg_d13C_org, sangajuveniles$avg_d15N, pch = 16, cex=0.75, col="white")
points(sangajuveniles$avg_d13C_org, sangajuveniles$avg_d15N, pch = 16, cex=0.5, col=sangajuveniles$cluster9)
points(sangaadults$avg_d13C_org, sangaadults$avg_d15N, pch = 16, cex=0.4, col="black")
dev.off()
#################
noma = humansFiltered_sub[humansFiltered_sub$Site=="N!oma",]
nomajuveniles = noma[noma$Age=="Juvenile",]
nomaadults = noma[noma$Age=="Adult",]
nomaadults<-nomaadults[!is.na(nomaadults$Site),]
pdf("[path]nomajuvenilesNWBOTSWANA.pdf")
par(mfrow=c(2,2))
plot(humansFiltered_sub$avg_d13C_org, humansFiltered_sub$avg_d15N, pch = 16, col=humansFiltered_sub$cluster9, ylim=c(5,25),xlim=c(-30,0), cex=1, main="human diets")
points(noma$avg_d13C_org, noma$avg_d15N, pch = 16, col=noma$cluster9, cex=1)
points(nomajuveniles$avg_d13C_org, nomajuveniles$avg_d15N, pch = 16, cex=0.75, col="white")
points(nomajuveniles$avg_d13C_org, nomajuveniles$avg_d15N, pch = 16, cex=0.5, col=nomajuveniles$cluster9)
points(nomaadults$avg_d13C_org, nomaadults$avg_d15N, pch = 16, cex=0.4, col="black")
plot(noma$avg_d13C_org, noma$avg_d15N, pch = 16, col=noma$cluster9, ylim=c(5,25),xlim=c(-30,0), cex=1, main="Identified juveniles: N!oma (nw Bots.)")
points(nomajuveniles$avg_d13C_org, nomajuveniles$avg_d15N, pch = 16, cex=0.75, col="white")
points(nomajuveniles$avg_d13C_org, nomajuveniles$avg_d15N, pch = 16, cex=0.5, col=nomajuveniles$cluster9)
points(nomaadults$avg_d13C_org, nomaadults$avg_d15N, pch = 16, cex=0.4, col="black")
dev.off()
############################
#EasternBotswana
eBotswana = humansFiltered_sub[humansFiltered_sub$Site=="Thatswane" | 
                                 humansFiltered_sub$Site=="Kgaswe"|
                                 humansFiltered_sub$Site=="Toutswemogala" |
                                 humansFiltered_sub$Site=="Bonwapitse" |
                                 humansFiltered_sub$Site=="Taukome" |
                                 humansFiltered_sub$Site=="Bosutswe",]
eBotswanajuveniles = eBotswana[eBotswana$Age=="Juvenile",]
eBotswanaadults = eBotswana[eBotswana$Age=="Adult",]
eBotswanaadults<-eBotswanaadults[!is.na(eBotswanaadults$Site),]
pdf("[path]eBotswanaJuveniles.pdf")
par(mfrow=c(2,2))
plot(humansFiltered_sub$avg_d13C_org, humansFiltered_sub$avg_d15N, pch = 16, col=humansFiltered_sub$cluster9, ylim=c(5,25),xlim=c(-30,0), cex=1, main="human diets")
points(eBotswana$avg_d13C_org, eBotswana$avg_d15N, pch = 16, col=eBotswana$cluster9, cex=1)
points(eBotswanajuveniles$avg_d13C_org, eBotswanajuveniles$avg_d15N, pch = 16, cex=0.75, col="white")
points(eBotswanajuveniles$avg_d13C_org, eBotswanajuveniles$avg_d15N, pch = 16, cex=0.5, col=eBotswanajuveniles$cluster9)
points(eBotswanaadults$avg_d13C_org, eBotswanaadults$avg_d15N, pch = 16, cex=0.4, col="black")
plot(eBotswana$avg_d13C_org, eBotswana$avg_d15N, pch = 16, col=eBotswana$cluster9, ylim=c(5,25),xlim=c(-30,0), cex=1, main="Identified juveniles: eastern Botswana")
points(eBotswanajuveniles$avg_d13C_org, eBotswanajuveniles$avg_d15N, pch = 16, cex=0.75, col="white")
points(eBotswanajuveniles$avg_d13C_org, eBotswanajuveniles$avg_d15N, pch = 16, cex=0.5, col=eBotswanajuveniles$cluster9)
points(eBotswanaadults$avg_d13C_org, eBotswanaadults$avg_d15N, pch = 16, cex=0.4, col="black")
dev.off()
```


```{r}

#CHECKS
C4 = humans_corr[humans_corr$cluster2=="blue",]
C3 = humans_corr[humans_corr$cluster2=="green",]
unique(C4$Site_Country)
unique(C3$Site_Country)
'%!in%' <- function(x,y)!('%in%'(x,y))
solelyC3green = C3[C3$Site %!in% C4$Site & C3$cluster9=="green",]
solelyC3purple = C3[C3$Site %!in% C4$Site & C3$cluster9=="darkorchid",]
solelyC4 = C4[C4$Site %!in% C3$Site,]
######
unique(humans_corr$cluster9)
sitenum = c(length(unique(blueHumanDescrip$Site)),
length(unique(greenHumanDescrip$Site)),
length(unique(yellowHumanDescrip$Site)),
length(unique(orangeHumanDescrip$Site)),
length(unique(purpleHumanDescrip$Site)),
length(unique(redHumanDescrip$Site)),
length(unique(grayHumanDescrip$Site)),
length(unique(blueHumanDescrip$Site))+length(unique(redHumanDescrip$Site)),
length(unique(purpleHumanDescrip$Site))+length(unique(greenHumanDescrip$Site)) )
CoV_d13C = c(cv(blueHumanDescrip$avg_d13C_org),
cv(greenHumanDescrip$avg_d13C_org),cv(yellowHumanDescrip$avg_d13C_org),
cv(orangeHumanDescrip$avg_d13C_org),cv(purpleHumanDescrip$avg_d13C_org),
cv(redHumanDescrip$avg_d13C_org),cv(grayHumanDescrip$avg_d13C_org),
cv(humans_corr$avg_d13C_org[humans_corr$cluster9=="blue"|humans_corr$cluster9=="red"]),
cv(humans_corr$avg_d13C_org[humans_corr$cluster9=="purple"|humans_corr$cluster9=="green"]))
CoV_d15N = c(cv(blueHumanDescrip$avg_d15N),
cv(greenHumanDescrip$avg_d15N),cv(yellowHumanDescrip$avg_d15N),
cv(orangeHumanDescrip$avg_d15N),cv(purpleHumanDescrip$avg_d15N),
cv(redHumanDescrip$avg_d15N),cv(grayHumanDescrip$avg_d15N),
cv(humans_corr$avg_d15N[humans_corr$cluster9=="blue"|humans_corr$cluster9=="red"]),
cv(humans_corr$avg_d15N[humans_corr$cluster9=="purple"|humans_corr$cluster9=="green"]))
nnum = c(nrow(unique(blueHumanDescrip)),
nrow(unique(greenHumanDescrip)),
nrow(unique(yellowHumanDescrip)),
nrow(unique(orangeHumanDescrip)),
nrow(unique(purpleHumanDescrip)),
nrow(unique(redHumanDescrip)),
nrow(unique(grayHumanDescrip)),
nrow(unique(redHumanDescrip))+nrow(unique(blueHumanDescrip)),
nrow(unique(purpleHumanDescrip))+nrow(unique(greenHumanDescrip)) )
color = c("blue","green","yellow","orange","purple","red","gray","blue-red","purple-green")
sitenumcat = data.frame(color,sitenum,nnum,CoV_d13C,CoV_d15N)
#
#% of sites including agro-pastoralism
(length(unique(blueHumanDescrip$Site))+length(unique(redHumanDescrip$Site)))/length(unique(humans_corr$Site))
#% of sites including C3-crop cultivation
(length(unique(purpleHumanDescrip$Site))+length(unique(greenHumanDescrip$Site)))/length(unique(humans_corr$Site))
#% of sites centred on aquatic protein
(length(unique(yellowHumanDescrip$Site)))/length(unique(humans_corr$Site))
#
(nrow(unique(blueHumanDescrip))+nrow(unique(redHumanDescrip)))/nrow(unique(humans_corr))
(nrow(unique(purpleHumanDescrip))+nrow(unique(greenHumanDescrip)))/nrow(unique(humans_corr))
(nrow(unique(yellowHumanDescrip)))/nrow(unique(humans_corr))
test1<-data.frame(table(humans_corr$Site))
test2<-data.frame(table(humans_corr$cluster9,humans_corr$Site))
nrow(C4)/nrow(humans_corr)
nrow(C3)/nrow(humans_corr)
```


```{r}

#Figure S4: comparison by site(s)
humdom = rbind(humans_corr[,c("avg_d13C_org","avg_d15N")],dom_corr[,c("avg_d13C_org","avg_d15N")])
#
pdf("[path].pdf")
par(mfrow=c(2,2))
for(site in c("Bosutswe","Kgaswe","Leptiminus","Kellis","N!oma","Thatswane","Kerma","Takarkori Rock Shelter","Toutswemogala")){
  df = humans_corr[humans_corr$Site==site,]
  mini = min(df$Date_mean)
  maxi = max(df$Date_mean)
  dfwild = wild_corr[wild_corr$Site == site & wild_corr$Date_mean >= mini &
                       wild_corr$Date_mean <= maxi ,]
  dfdom = dom_corr[dom_corr$Site == site & dom_corr$Date_mean >= mini &
                       dom_corr$Date_mean <= maxi ,]
  plot(humdom$avg_d13C_org, humdom$avg_d15N,col="white", pch=17,cex=0,main=site)
  points(df$avg_d13C_org, df$avg_d15N,col=df$cluster9, pch=17, cex=1.5)
  points(dfdom$avg_d13C_org, dfdom$avg_d15N,col=dfdom$cluster9,pch=16,cex=1.25)
  points(dfwild$avg_d13C_org, dfwild$avg_d15N,col="black",pch=15,cex=1)}
dev.off()
#
#COMPARISON BY CLUSTER
humdom = rbind(humans_corr[,c("avg_d13C_org","avg_d15N")],dom_corr[,c("avg_d13C_org","avg_d15N")])
plot(humdom$avg_d13C_org, humdom$avg_d15N,col="white", pch=17)
  points(humans_corr$avg_d13C_org, humans_corr$avg_d15N,
         col=humans_corr$cluster9, pch=17,cex=2)
  dom_corrFilt = dom_corr[dom_corr$CN_ratio >= 2.9 & dom_corr$CN_ratio <= 3.6,]
  points(dom_corrFilt$avg_d13C_org,dom_corrFilt$avg_d15N,
         col=dom_corrFilt$cluster9,pch=16,cex=1.5)
df = humans_corr
mini = min(df$Date_min)
maxi = max(df$Date_max)
dfwild = wild_corr[wild_corr$Site %in% humans_corr$Site & wild_corr$Date_mean >= mini &
                     wild_corr$Date_mean <= maxi,]
points(dfwild$avg_d13C_org, dfwild$avg_d15N,col="black",pch=15,cex=0.5)
pdf("[path]clusters.pdf")
par(mfrow=c(2,2))
for( cluster in c("darkorchid","green","orange","red","yellow","gray","blue")){
  df = humans_corr[humans_corr$cluster9==cluster,]
  mini = min(df$Date_min)
  maxi = max(df$Date_max)
  dfwild = wild_corr[wild_corr$Site %in% df$Site & wild_corr$Date_mean >= mini & 
                       wild_corr$Date_mean <= maxi,]
  dfdom = dom_corrFilt[dom_corrFilt$Site %in% df$Site & dom_corrFilt$Date_mean >= mini & 
                       dom_corrFilt$Date_mean <= maxi,]
  plot(humdom$avg_d13C_org, humdom$avg_d15N,col="white",cex=0, pch=17,main = cluster)
  points(df$avg_d13C_org, df$avg_d15N,col=df$cluster9, pch=17,cex=2)
  points(dfdom$avg_d13C_org, dfdom$avg_d15N,col=dfdom$cluster9,pch=16, cex=1.5)
  points(dfwild$avg_d13C_org, dfwild$avg_d15N,col="black",pch=15,cex = 0.5)}
dev.off()
#
humdom = rbind(humans_corr[,c("avg_d13C_org","avg_d15N")],dom_corr[,c("avg_d13C_org","avg_d15N")])
plot(humdom$avg_d13C_org, humdom$avg_d15N,col="white", pch=17)
  points(humans_corr$avg_d13C_org, humans_corr$avg_d15N,
         col=humans_corr$cluster9, pch=17,cex=2)
  dom_corrFilt = dom_corr[dom_corr$CN_ratio >= 2.9 & dom_corr$CN_ratio <= 3.6,]
  points(dom_corrFilt$avg_d13C_org,dom_corrFilt$avg_d15N,
         col=dom_corrFilt$cluster9,pch=16,cex=1.5)
  points(wild_corr$avg_d13C_org, wild_corr$avg_d15N,col="black",pch=16,cex=0.5)
```


```{r}
#FIGURE 2: domestic scatterplots
dom_corr_sub = dom_corr
dom_corr_sub[dom_corr_sub =="darkorange"]<-"darkorange3"
dom_corr_sub$cluster3[dom_corr_sub$cluster3=="forestgreen"]<-"green4"
dom_corr_sub$cluster3[dom_corr_sub$cluster3=="dodgerblue"]<-"blue4"
dom_corr_sub$cluster3[dom_corr_sub$cluster3=="firebrick"]<-"yellow2"
pdf("[path]0_Fig8_scatterplot_clust_dom_corr_sub_a.pdf")
par(mfrow=c(2,2))
plot(dom_corr_sub$avg_d13C_org, dom_corr_sub$avg_d15N, pch = 25, bg=dom_corr_sub$cluster2, col=dom_corr_sub$cluster2,ylim=c(0,17),xlim=c(-31,-4),cex=0.65,
     main="dom_corr_subestic cluster 2")
plot(dom_corr_sub$avg_d13C_org, dom_corr_sub$avg_d15N, pch = 25, bg=dom_corr_sub$cluster3, col=dom_corr_sub$cluster3,ylim=c(0,17),xlim=c(-31,-4),cex=0.65,
     main="dom_corr_subestic cluster 3")
plot(dom_corr_sub$avg_d13C_org, dom_corr_sub$avg_d15N, pch = 25, bg=dom_corr_sub$cluster4, col=dom_corr_sub$cluster4,ylim=c(0,17),xlim=c(-31,-4),cex=0.65,
     main="dom_corr_subestic cluster 4")
plot(dom_corr_sub$avg_d13C_org, dom_corr_sub$avg_d15N, pch = 25, bg=dom_corr_sub$cluster5, col=dom_corr_sub$cluster5,ylim=c(0,17),xlim=c(-31,-4),cex=0.65,
     main="dom_corr_subestic cluster 5")
plot(dom_corr_sub$avg_d13C_org, dom_corr_sub$avg_d15N, pch = 25, bg=dom_corr_sub$cluster6, col=dom_corr_sub$cluster6,ylim=c(0,17),xlim=c(-31,-4),cex=0.65,
     main="dom_corr_subestic cluster 6")
plot(dom_corr_sub$avg_d13C_org, dom_corr_sub$avg_d15N, pch = 25, bg=dom_corr_sub$cluster8, col=dom_corr_sub$cluster8,ylim=c(0,17),xlim=c(-31,-4),cex=0.65,
     main="dom_corr_subestic cluster8")
plot(dom_corr_sub$avg_d13C_org, dom_corr_sub$avg_d15N, pch = 25, bg=dom_corr_sub$cluster7, col=dom_corr_sub$cluster7,ylim=c(0,17),xlim=c(-31,-4),cex=0.65,
     main="dom_corr_subestic cluster7")
plot(dom_corr_sub$avg_d13C_org, dom_corr_sub$avg_d15N, pch = 25, bg=dom_corr_sub$cluster8, col=dom_corr_sub$cluster8,ylim=c(0,17),xlim=c(-31,-4),cex=0.65,
     main="dom_corr_subestic cluster8")
plot(dom_corr_sub$avg_d13C_org, dom_corr_sub$avg_d15N, pch = 25, bg=dom_corr_sub$cluster9, col=dom_corr_sub$cluster9,ylim=c(0,17),xlim=c(-31,-4),cex=0.65,
     main="dom_corr_subestic cluster9")
dev.off()
```


```{r}

#FIGURE 1: MAPFOR HUMAN CLUSTERS 
C3_humans = humans_corr[humans_corr$cluster2=="green",]
C4_humans = humans_corr[humans_corr$cluster2=="blue",]
yellow_humans = humans_corr[humans_corr$cluster9=="yellow",]
green_humans = humans_corr[humans_corr$cluster9=="green",]
blue_humans = humans_corr[humans_corr$cluster9=="blue",]
darkorchid_humans = humans_corr[humans_corr$cluster9=="darkorchid",]
red_humans = humans_corr[humans_corr$cluster9=="red",]
gray_humans = humans_corr[humans_corr$cluster9=="gray",]
orange_humans = humans_corr[humans_corr$cluster9=="orange",]
rbPal = colorRampPalette(c("black","gray100"))
cols = rbPal(500)
```


```{r}
#Figure 2: Map domestic clusters
domenamel_corr[domenamel_corr=="darkorange"]<-"orange"
dom_corr[dom_corr=="darkorange"]<-"orange"
###############################
dom_corr_sub = dom_corr
domenamel_corr_sub = domenamel_corr
domenamel_corr_sub<-domenamel_corr_sub[!is.na(domenamel_corr_sub$Site),]
dodgerblue_dom = dom_corr_sub[dom_corr_sub$cluster8=="dodgerblue",]
forestgreen_dom = dom_corr_sub[dom_corr_sub$cluster8=="forestgreen",]
cornsilk_dom = dom_corr_sub[dom_corr_sub$cluster8=="cornsilk",]
firebrick_dom = dom_corr_sub[dom_corr_sub$cluster8=="firebrick",]
orange_dom = dom_corr_sub[dom_corr_sub$cluster8=="orange"| dom_corr_sub$cluster8=="darkorange",]
tan_dom = dom_corr_sub[dom_corr_sub$cluster8=="tan",]
dodgerblue_domenamel = domenamel_corr_sub[domenamel_corr_sub$clusterManualGeneral=="dodgerblue",] 
forestgreen_domenamel = domenamel_corr_sub[domenamel_corr_sub$clusterManualGeneral=="forestgreen",] 
cornsilk_domenamel = domenamel_corr_sub[domenamel_corr_sub$clusterManualSpecific=="cornsilk",]
cornsilk_domenamel = cornsilk_domenamel[!is.na(cornsilk_domenamel$Site),]
orange_domenamel = domenamel_corr_sub[domenamel_corr_sub$clusterManualSpecific=="orange" | domenamel_corr_sub$clusterManualSpecific=="darkorange",]
orange_domenamel = orange_domenamel[!is.na(orange_domenamel$Site),]
C4dom = dom_corr[dom_corr$cluster3=="dodgerblue",]
C3dom = dom_corr[dom_corr$cluster3=="forestgreen",]
C4domenamel = domenamel_corr[domenamel_corr$clusterManualGeneral=="dodgerblue",]
C3domenamel = domenamel_corr[domenamel_corr$clusterManualGeneral=="forestgreen",]
###########################################################
```


```{r}
#combine datasets for lm
subset1<-humans_corr[,c("Site","Site_Country","Longitude","Latitude","Kingdom","Class","Family","Taxon","Taxon_Common_Name","Category","Lab_ID","Date_max","Date_min","Material_Type", "avg_d13C_org","avg_d15N","avg_d13C_inorg","Date_mean","cluster2","cluster3","cluster4","bioclim1","bioclim12","bioclim15","elev","Age")]
subset1<-dom_corr[,c("Site","Site_Country","Longitude","Latitude","Kingdom","Class","Family","Taxon","Taxon_Common_Name","Category","Lab_ID","Date_max","Date_min","Material_Type", "avg_d13C_org","avg_d15N","avg_d13C_inorg","Date_mean","cluster2","cluster3","cluster4","cluster5","cluster6","cluster7","bioclim1","bioclim12","bioclim15","elev")]
humanblue = data.frame(humans_corr[humans_corr$cluster3=="blue",])
humangreen = data.frame(humans_corr[humans_corr$cluster3=="green",])
humanyellow = data.frame(humans_corr[humans_corr$cluster3=="yellow",])

#REGIONAL DESIGNATIONS
all_corr = rbind(humans_corr[,c("Site","Latitude","Longitude","Taxon_Common_Name")],dom_corr[,c("Site","Latitude","Longitude","Taxon_Common_Name")],dom_corr[,c("Site","Latitude","Longitude","Taxon_Common_Name")],dom_corr[,c("Site","Latitude","Longitude","Taxon_Common_Name")],domenamel_corr[,c("Site","Latitude","Longitude","Taxon_Common_Name")],wild_corr[,c("Site","Latitude","Longitude","Taxon_Common_Name")],humenamel_corr[,c("Site","Latitude","Longitude","Taxon_Common_Name")],wildenamel_corr[,c("Site","Latitude","Longitude","Taxon_Common_Name")])
db_selecting = db[db$Site %in% all_corr$Site,]
for(i in 1:4){
            if(i == 1){dummy = humans_corr}
            if(i == 2){dummy = dom_corr}
            if(i == 3){dummy = db_selecting}
              dummy$slice = as.factor(i)
              dummy$region2 = NA
              
 dummy$region2[dummy$Latitude < -20 & 
                 dummy$Site_Country=="South Africa"|
                 dummy$Site_Country=="Botswana"|
                 dummy$Site_Country=="Namibia"|
                 dummy$Site_Country=="Lesotho" | 
                 dummy$Site_Country=="Zimbabwe" |
                 dummy$Site_Country=="Mozambique"]<-10 
              dummy$region2[  dummy$Latitude > -15 &  #Malawi, Ethiopia removed: avoid skewing regional trends
                              dummy$Latitude <= 10 &
                                dummy$Site_Country=="Kenya" |
                                dummy$Site_Country=="Ethiopia" |
                                dummy$Site_Country=="Uganda" | 
                                dummy$Site_Country=="Rwanda"|
                                dummy$Site_Country=="Tanzania" | 
                                dummy$Site_Country=="Mozambique" ]<-20
              dummy$region2[dummy$region2==20 & dummy$Latitude > 10]<-NA
              dummy$region2[dummy$region2==20 & dummy$Latitude <= -15]<-NA
              dummy$region2[dummy$Site_Country=="Egypt"|
                              dummy$Site_Country=="Sudan"]<-30 #removed Tunisia - otherwise skews regional results
              dummy$region2[ dummy$region2 == 30 & dummy$Latitude < 18]<-70
              dummy$region2[dummy$Site_Country=="Cameroon"|
                              dummy$Site_Country=="Liberia"|
                              dummy$Site_Country=="Sierra Leone"]<-50
              dummy$region2[dummy$Site_Country=="Algeria" | 
                              dummy$Site_Country=="Libya" |
                              dummy$Site_Country=="Mauritania" | 
                              dummy$Site_Country=="Mali"|
                              dummy$Site_Country=="Niger" |
                              dummy$Site_Country=="Chad" |
                              dummy$Site_Country=="Western Sahara"|
                              dummy$Site_Country=="Benin"|
                              dummy$Site_Country=="Burkina Faso"]<-60
              dummy$region2[dummy$region2==60 & dummy$Latitude < 18 & dummy$Latitude > 10]<-70
              dummy$region2[dummy$region2==60 & dummy$Latitude <= 10]<-50
              dummy$region2[dummy$Site_Country=="Democratic Republic of the Congo"|
                              dummy$Site_Country=="Angola"]<-80 
              dummy$slice<-NA
              if(i == 1){humansAndHumenamel_select = dummy}
              if(i == 2){domAndDomenamel_select = dummy}
              if(i == 3){db_region_select = dummy}}
humansAndHumenamel_select<-humansAndHumenamel_select[!is.na(humansAndHumenamel_select$Site),]
domAndDomenamel_select<-domAndDomenamel_select[!is.na(domAndDomenamel_select$Site),]
db_region_select<-db_region_select[!is.na(db_region_select$Site),]
db_region_select<-db_region_select[db_region_select$Material_Type=="Bone"|
                                    db_region_select$Material_Type=="Enamel",]
#
HAH_ne = humansAndHumenamel_select[humansAndHumenamel_select$region2 == 30,]
HAH_sahel = humansAndHumenamel_select[humansAndHumenamel_select$region2 == 70,]
HAH_e = humansAndHumenamel_select[humansAndHumenamel_select$region2 == 20,]
HAH_s = humansAndHumenamel_select[humansAndHumenamel_select$region2 == 10,]
HAH_w = humansAndHumenamel_select[humansAndHumenamel_select$region2 == 50,]
HAH_c = humansAndHumenamel_select[humansAndHumenamel_select$region2 == 80,]
DADE_ne = domAndDomenamel_select[domAndDomenamel_select$region2 == 30,]
DADE_sahel = domAndDomenamel_select[domAndDomenamel_select$region2 == 70,]
DADE_e = domAndDomenamel_select[domAndDomenamel_select$region2 == 20,]
DADE_s = domAndDomenamel_select[domAndDomenamel_select$region2 == 10,]
DADE_w = domAndDomenamel_select[domAndDomenamel_select$region2 == 50,]
DADE_c = domAndDomenamel_select[domAndDomenamel_select$region2 == 80,]
all_s = db_region_select[db_region_select$region2 == 10,]
all_e = db_region_select[db_region_select$region2 == 20,]
all_ne = db_region_select[db_region_select$region2 == 30,]
all_sahel = db_region_select[db_region_select$region2 == 70,]
all_w = db_region_select[db_region_select$region2 == 50,]
all_c = db_region_select[db_region_select$region2 == 80,]
```


```{r}
#Figure 4: mapped pathways - info

#AQUATIC-oriented (H-G-F+)
humanyellow = humans_corr[humans_corr$cluster9=="yellow" ,]
humangray = humans_corr[humans_corr$cluster9=="gray" ,]
domfirebrick = dom_corr[dom_corr$cluster8 == "firebrick",]
############################
#C4 PASTORAL-oriented
humanblue = humans_corr[humans_corr$cluster9=="blue" ,]
humangrayC4 = humans_corr[humans_corr$cluster9=="gray" & humans_corr$avg_d13C_org > -10.40,]
humanblue = rbind(humanblue,humangrayC4)
humanredC4 = humans_corr[humans_corr$cluster9=="red" & humans_corr$avg_d13C_org > -13.3,]
domdodgerblue = dom_corr[dom_corr$cluster8 == "dodgerblue"|
                          dom_corr$cluster8 == "cornsilk",] 
domenameldodgerblue = domenamel_corr[domenamel_corr$clusterManualGeneral == "dodgerblue",]
domforestgreenblue = dom_corr[dom_corr$cluster8 == "forestgreen",] 
domenamelforestgreenblue = domenamel_corr[domenamel_corr$clusterManualSpecific == "forestgreen",] 
###############################
#C3 cultivation-oriented
humangreen = humans_corr[humans_corr$cluster9=="green"|humans_corr$cluster9=="darkorchid",]
humangreen = humangreen[humangreen$Site_Country != "South Africa",]
domforestgreen = dom_corr[dom_corr$cluster8 == "forestgreen",] 
domStockkeeping = dom_corr[dom_corr$cluster8 == "orange"|
                            dom_corr$cluster8 == "darkorange2"|
                            dom_corr$cluster8 == "darkorange"|
                            dom_corr$cluster8 == "tan",] 
domenamelforestgreen = domenamel_corr[domenamel_corr$clusterManualSpecific == "forestgreen",] 
domenamelStockkeeping = domenamel_corr[domenamel_corr$clusterManualSpecific == "orange",] 
##################################
#terrestrial H-G-F oriented
humanred = humans_corr[humans_corr$cluster9=="red" & humans_corr$ID != 308,] #isolate non H-G livelihood (Egypt)
humanredEgypt = humans_corr[humans_corr$cluster9=="red" & humans_corr$ID == 308,]
humanorange = humans_corr[humans_corr$cluster9=="orange" ,]
humanorangeNorth = humanorange[humanorange$Latitude > 14 ,]
humanorangeSubsaharan = humanorange[humanorange$Latitude < 14 ,]
humanorange<-NA
humangreenSouth = humans_corr[humans_corr$cluster9=="green"|humans_corr$cluster9=="darkorchid",]
humangreenSouth = humangreenSouth[humangreenSouth$Site_Country == "South Africa",]
#######################################################################
#DEFINE DATE/COLOUR/SIZE SCHEME
datecomb = rbind(humanyellow[,c("Date_mean")],
                 domfirebrick[,c("Date_mean")],
                 humangray[,c("Date_mean")],
                 humanblue[,c("Date_mean")],
                 humanredC4[,c("Date_mean")],
                 domdodgerblue[,c("Date_mean")],
                 domenameldodgerblue[,c("Date_mean")],
                 humangreen[,c("Date_mean")],
                 domforestgreen[,c("Date_mean")],
                 domenamelforestgreen[,c("Date_mean")],
                 domStockkeeping[,c("Date_mean")],
                 domenamelStockkeeping[,c("Date_mean")],
                 humanorangeSubsaharan[,c("Date_mean")],
                 humanorangeNorth[,c("Date_mean")],
                 humanred[,c("Date_mean")],
                 humanredEgypt[,c("Date_mean")],
                 humangreenSouth[,c("Date_mean")])
datecomb<-datecomb[!is.na(datecomb$Date_mean),]
dates = seq(round(min(datecomb$Date_mean),digits=0),
            round(max(datecomb$Date_mean),digits=0),by=1)
Q1=dates[length(dates)/8]
Q2=dates[(length(dates)/8)*2]
Q3=dates[(length(dates)/8)*3]
Q4=dates[(length(dates)/8)*4]
Q5=dates[(length(dates)/8)*5]
Q6=dates[(length(dates)/8)*6]
Q7=dates[(length(dates)/8)*7]
Q8=dates[(length(dates))]
```



```{r}
#Figure 5b TIME TRENDS
humans_corr_sub = humans_corr
unique(humans_corr_sub$cluster9)
colours_human = c(unique(humans_corr_sub$cluster9))
length(colours_human)
humans_corr_sub$adj_Date_mean<-"hi"
de_neg = humans_corr_sub[humans_corr_sub$Date_mean<0,]
de_neg$adj_Date_mean = de_neg$Date_mean*-1+2000
de_pos = humans_corr_sub[humans_corr_sub$Date_mean>=0,]
de_pos$adj_Date_mean = 2000 - de_pos$Date_mean
humans_corr_sub<-rbind(de_neg,de_pos)
#
dom_corr_sub$adj_Date_mean<-"hi"
de_neg = dom_corr_sub[dom_corr_sub$Date_mean<0,]
de_neg$adj_Date_mean = de_neg$Date_mean*-1+2000
de_pos = dom_corr_sub[dom_corr_sub$Date_mean>=0,]
de_pos$adj_Date_mean = 2000 - de_pos$Date_mean
dom_corr_sub<-rbind(de_neg,de_pos)
#
dom_sub = dom_corr
dom_sub[dom_sub=="cornsilk"]<-"cornsilk3"
dom_sub[dom_sub=="darkorange3"]<-"orange"
dom_sub[dom_sub=="darkorange"]<-"orange"
colours_dom = c(unique(dom_sub$cluster8))
length(colours_dom)
dom_sub$adj_Date_mean<-"hi"
de_neg = dom_sub[dom_sub$Date_mean<0,]
de_neg$adj_Date_mean = de_neg$Date_mean*-1+2000
de_pos = dom_sub[dom_sub$Date_mean>=0,]
de_pos$adj_Date_mean = 2000 - de_pos$Date_mean
dom_sub<-rbind(de_neg,de_pos)
#
#SPLIT REGIONAL TRENDS: North vs. south Africa
greenSA = humans_corr_sub[humans_corr_sub$cluster9=="green" & humans_corr_sub$Latitude < -9,]
greenNorth = humans_corr_sub[humans_corr_sub$cluster9=="green" & humans_corr_sub$Latitude >= -9,]
blueSA = humans_corr_sub[humans_corr_sub$cluster9=="blue" & humans_corr_sub$Latitude < -9,]
blueNorth = humans_corr_sub[humans_corr_sub$cluster9=="blue" & humans_corr_sub$Latitude >= -9,]
redSA = humans_corr_sub[humans_corr_sub$cluster9=="red" & humans_corr_sub$Latitude < -9,]
redNorth = humans_corr_sub[humans_corr_sub$cluster9=="red" & humans_corr_sub$Latitude >= -9,]
orangeSA = humans_corr_sub[humans_corr_sub$cluster9=="orange" & humans_corr_sub$Latitude < -9,]
orangeNorth = humans_corr_sub[humans_corr_sub$cluster9=="orange" & humans_corr_sub$Latitude >= -9,]
#Human - south
greenSATime13C <- glm(avg_d13C_org ~ adj_Date_mean, data=greenSA, family = "gaussian")
greenSATime15N <- glm(avg_d15N ~ adj_Date_mean, data=greenSA, family = "gaussian")
greenSATimeBioclim1 <- glm(bioclim1 ~ adj_Date_mean, data=greenSA, family = "gaussian")
greenSATimeBioclim12 <- glm(bioclim12 ~ adj_Date_mean, data=greenSA, family = "gaussian")
greenSATimeBioclim15 <- glm(bioclim15 ~ adj_Date_mean, data=greenSA, family = "gaussian")
greenSATimeelev <- glm(elev ~ adj_Date_mean, data=greenSA, family = "gaussian")
blueSATime13C <- glm(avg_d13C_org ~ adj_Date_mean, data=blueSA, family = "gaussian")
blueSATime15N <- glm(avg_d15N ~ adj_Date_mean, data=blueSA, family = "gaussian")
blueSATimeBioclim1 <- glm(bioclim1 ~ adj_Date_mean, data=blueSA, family = "gaussian")
blueSATimeBioclim12 <- glm(bioclim12 ~ adj_Date_mean, data=blueSA, family = "gaussian")
blueSATimeBioclim15 <- glm(bioclim15 ~ adj_Date_mean, data=blueSA, family = "gaussian")
blueSATimeelev <- glm(elev ~ adj_Date_mean, data=blueSA, family = "gaussian")
redSATime13C <- glm(avg_d13C_org ~ adj_Date_mean, data=redSA, family = "gaussian")
redSATime15N <- glm(avg_d15N ~ adj_Date_mean, data=redSA, family = "gaussian")
redSATimeBioclim1 <- glm(bioclim1 ~ adj_Date_mean, data=redSA, family = "gaussian")
redSATimeBioclim12 <- glm(bioclim12 ~ adj_Date_mean, data=redSA, family = "gaussian")
redSATimeBioclim15 <- glm(bioclim15 ~ adj_Date_mean, data=redSA, family = "gaussian")
redSATimeelev <- glm(elev ~ adj_Date_mean, data=redSA, family = "gaussian")
orangeSATime13C <- glm(avg_d13C_org ~ adj_Date_mean, data=orangeSA, family = "gaussian")
orangeSATime15N <- glm(avg_d15N ~ adj_Date_mean, data=orangeSA, family = "gaussian")
orangeSATimeBioclim1 <- glm(bioclim1 ~ adj_Date_mean, data=orangeSA, family = "gaussian")
orangeSATimeBioclim12 <- glm(bioclim12 ~ adj_Date_mean, data=orangeSA, family = "gaussian")
orangeSATimeBioclim15 <- glm(bioclim15 ~ adj_Date_mean, data=orangeSA, family = "gaussian")
orangeSATimeelev <- glm(elev ~ adj_Date_mean, data=orangeSA, family = "gaussian")
#Human- North
greenNorthTime13C <- glm(avg_d13C_org ~ adj_Date_mean, data=greenNorth, family = "gaussian")
greenNorthTime15N <- glm(avg_d15N ~ adj_Date_mean, data=greenNorth, family = "gaussian")
greenNorthTimeBioclim1 <- glm(bioclim1 ~ adj_Date_mean, data=greenNorth, family = "gaussian")
greenNorthTimeBioclim12 <- glm(bioclim12 ~ adj_Date_mean, data=greenNorth, family = "gaussian")
greenNorthTimeBioclim15 <- glm(bioclim15 ~ adj_Date_mean, data=greenNorth, family = "gaussian")
greenNorthTimeelev <- glm(elev ~ adj_Date_mean, data=greenNorth, family = "gaussian")
blueNorthTime13C <- glm(avg_d13C_org ~ adj_Date_mean, data=blueNorth, family = "gaussian")
blueNorthTime15N <- glm(avg_d15N ~ adj_Date_mean, data=blueNorth, family = "gaussian")
blueNorthTimeBioclim1 <- glm(bioclim1 ~ adj_Date_mean, data=blueNorth, family = "gaussian")
blueNorthTimeBioclim12 <- glm(bioclim12 ~ adj_Date_mean, data=blueNorth, family = "gaussian")
blueNorthTimeBioclim15 <- glm(bioclim15 ~ adj_Date_mean, data=blueNorth, family = "gaussian")
blueNorthTimeelev <- glm(elev ~ adj_Date_mean, data=blueNorth, family = "gaussian")
redNorthTime13C <- glm(avg_d13C_org ~ adj_Date_mean, data=redNorth, family = "gaussian")
redNorthTime15N <- glm(avg_d15N ~ adj_Date_mean, data=redNorth, family = "gaussian")
redNorthTimeBioclim1 <- glm(bioclim1 ~ adj_Date_mean, data=redNorth, family = "gaussian")
redNorthTimeBioclim12 <- glm(bioclim12 ~ adj_Date_mean, data=redNorth, family = "gaussian")
redNorthTimeBioclim15 <- glm(bioclim15 ~ adj_Date_mean, data=redNorth, family = "gaussian")
redNorthTimeelev <- glm(elev ~ adj_Date_mean, data=redNorth, family = "gaussian")
orangeNorthTime13C <- glm(avg_d13C_org ~ adj_Date_mean, data=orangeNorth, family = "gaussian")
orangeNorthTime15N <- glm(avg_d15N ~ adj_Date_mean, data=orangeNorth, family = "gaussian")
orangeNorthTimeBioclim1 <- glm(bioclim1 ~ adj_Date_mean, data=orangeNorth, family = "gaussian")
orangeNorthTimeBioclim12 <- glm(bioclim12 ~ adj_Date_mean, data=orangeNorth, family = "gaussian")
orangeNorthTimeBioclim15 <- glm(bioclim15 ~ adj_Date_mean, data=orangeNorth, family = "gaussian")
orangeNorthTimeelev <- glm(elev ~ adj_Date_mean, data=orangeNorth, family = "gaussian")
#
dodgerblueSA = dom_corr_sub[dom_corr_sub$cluster9=="dodgerblue" & dom_corr_sub$Latitude < -9,]
dodgerblueNorth = dom_corr_sub[dom_corr_sub$cluster9=="dodgerblue" & dom_corr_sub$Latitude >= -9,]
cornsilkSA = dom_corr_sub[dom_corr_sub$cluster9=="cornsilk" & dom_corr_sub$Latitude < -9,]
cornsilkNorth = dom_corr_sub[dom_corr_sub$cluster9=="cornsilk" & dom_corr_sub$Latitude >= -9,]
forestgreenSA = dom_corr_sub[dom_corr_sub$cluster9=="forestgreen" & dom_corr_sub$Latitude < -9,]
forestgreenNorth = dom_corr_sub[dom_corr_sub$cluster9=="forestgreen" & dom_corr_sub$Latitude >= -9,]
firebrickSA = dom_corr_sub[dom_corr_sub$cluster9=="firebrick" & dom_corr_sub$Latitude < -9,]
firebrickNorth = dom_corr_sub[dom_corr_sub$cluster9=="firebrick" & dom_corr_sub$Latitude >= -9,]
#dom - south
dodgerblueSAdomTime13C <- glm(avg_d13C_org ~ adj_Date_mean, data=dodgerblueSA, family = "gaussian")
dodgerblueSAdomTime15N <- glm(avg_d15N ~ adj_Date_mean, data=dodgerblueSA, family = "gaussian")
dodgerblueSAdomTimeBioclim1 <- glm(bioclim1 ~ adj_Date_mean, data=dodgerblueSA, family = "gaussian")
dodgerblueSAdomTimeBioclim12 <- glm(bioclim12 ~ adj_Date_mean, data=dodgerblueSA, family = "gaussian")
dodgerblueSAdomTimeBioclim15 <- glm(bioclim15 ~ adj_Date_mean, data=dodgerblueSA, family = "gaussian")
dodgerblueSAdomTimeelev <- glm(elev ~ adj_Date_mean, data=dodgerblueSA, family = "gaussian")
cornsilkSAdomTime13C <- glm(avg_d13C_org ~ adj_Date_mean, data=cornsilkSA, family = "gaussian")
cornsilkSAdomTime15N <- glm(avg_d15N ~ adj_Date_mean, data=cornsilkSA, family = "gaussian")
cornsilkSAdomTimeBioclim1 <- glm(bioclim1 ~ adj_Date_mean, data=cornsilkSA, family = "gaussian")
cornsilkSAdomTimeBioclim12 <- glm(bioclim12 ~ adj_Date_mean, data=cornsilkSA, family = "gaussian")
cornsilkSAdomTimeBioclim15 <- glm(bioclim15 ~ adj_Date_mean, data=cornsilkSA, family = "gaussian")
cornsilkSAdomTimeelev <- glm(elev ~ adj_Date_mean, data=cornsilkSA, family = "gaussian")
forestgreenSAdomTime13C <- glm(avg_d13C_org ~ adj_Date_mean, data=forestgreenSA, family = "gaussian")
forestgreenSAdomTime15N <- glm(avg_d15N ~ adj_Date_mean, data=forestgreenSA, family = "gaussian")
forestgreenSAdomTimeBioclim1 <- glm(bioclim1 ~ adj_Date_mean, data=forestgreenSA, family = "gaussian")
forestgreenSAdomTimeBioclim12 <- glm(bioclim12 ~ adj_Date_mean, data=forestgreenSA, family = "gaussian")
forestgreenSAdomTimeBioclim15 <- glm(bioclim15 ~ adj_Date_mean, data=forestgreenSA, family = "gaussian")
forestgreenSAdomTimeelev <- glm(elev ~ adj_Date_mean, data=forestgreenSA, family = "gaussian")
# firebrickSAdomTime13C <- glm(avg_d13C_org ~ adj_Date_mean, data=firebrickSA, family = "gaussian")
# firebrickSAdomTime15N <- glm(avg_d15N ~ adj_Date_mean, data=firebrickSA, family = "gaussian")
# firebrickSAdomTimeBioclim1 <- glm(bioclim1 ~ adj_Date_mean, data=firebrickSA, family = "gaussian")
# firebrickSAdomTimeBioclim12 <- glm(bioclim12 ~ adj_Date_mean, data=firebrickSA, family = "gaussian")
# firebrickSAdomTimeBioclim15 <- glm(bioclim15 ~ adj_Date_mean, data=firebrickSA, family = "gaussian")
# firebrickSAdomTimeelev <- glm(elev ~ adj_Date_mean, data=firebrickSA, family = "gaussian")
#dom - north
dodgerblueNorthdomTime13C <- glm(avg_d13C_org ~ adj_Date_mean, data=dodgerblueNorth, family = "gaussian")
dodgerblueNorthdomTime15N <- glm(avg_d15N ~ adj_Date_mean, data=dodgerblueNorth, family = "gaussian")
dodgerblueNorthdomTimeBioclim1 <- glm(bioclim1 ~ adj_Date_mean, data=dodgerblueNorth, family = "gaussian")
dodgerblueNorthdomTimeBioclim12 <- glm(bioclim12 ~ adj_Date_mean, data=dodgerblueNorth, family = "gaussian")
dodgerblueNorthdomTimeBioclim15 <- glm(bioclim15 ~ adj_Date_mean, data=dodgerblueNorth, family = "gaussian")
dodgerblueNorthdomTimeelev <- glm(elev ~ adj_Date_mean, data=dodgerblueNorth, family = "gaussian")
cornsilkNorthdomTime13C <- glm(avg_d13C_org ~ adj_Date_mean, data=cornsilkNorth, family = "gaussian")
cornsilkNorthdomTime15N <- glm(avg_d15N ~ adj_Date_mean, data=cornsilkNorth, family = "gaussian")
cornsilkNorthdomTimeBioclim1 <- glm(bioclim1 ~ adj_Date_mean, data=cornsilkNorth, family = "gaussian")
cornsilkNorthdomTimeBioclim12 <- glm(bioclim12 ~ adj_Date_mean, data=cornsilkNorth, family = "gaussian")
cornsilkNorthdomTimeBioclim15 <- glm(bioclim15 ~ adj_Date_mean, data=cornsilkNorth, family = "gaussian")
cornsilkNorthdomTimeelev <- glm(elev ~ adj_Date_mean, data=cornsilkNorth, family = "gaussian")
forestgreenNorthdomTime13C <- glm(avg_d13C_org ~ adj_Date_mean, data=forestgreenNorth, family = "gaussian")
forestgreenNorthdomTime15N <- glm(avg_d15N ~ adj_Date_mean, data=forestgreenNorth, family = "gaussian")
forestgreenNorthdomTimeBioclim1 <- glm(bioclim1 ~ adj_Date_mean, data=forestgreenNorth, family = "gaussian")
forestgreenNorthdomTimeBioclim12 <- glm(bioclim12 ~ adj_Date_mean, data=forestgreenNorth, family = "gaussian")
forestgreenNorthdomTimeBioclim15 <- glm(bioclim15 ~ adj_Date_mean, data=forestgreenNorth, family = "gaussian")
forestgreenNorthdomTimeelev <- glm(elev ~ adj_Date_mean, data=forestgreenNorth, family = "gaussian")
firebrickNorthdomTime13C <- glm(avg_d13C_org ~ adj_Date_mean, data=firebrickNorth, family = "gaussian")
firebrickNorthdomTime15N <- glm(avg_d15N ~ adj_Date_mean, data=firebrickNorth, family = "gaussian")
firebrickNorthdomTimeBioclim1 <- glm(bioclim1 ~ adj_Date_mean, data=firebrickNorth, family = "gaussian")
firebrickNorthdomTimeBioclim12 <- glm(bioclim12 ~ adj_Date_mean, data=firebrickNorth, family = "gaussian")
firebrickNorthdomTimeBioclim15 <- glm(bioclim15 ~ adj_Date_mean, data=firebrickNorth, family = "gaussian")
firebrickNorthdomTimeelev <- glm(elev ~ adj_Date_mean, data=firebrickNorth, family = "gaussian")
#
summary(greenNorthTime13C)$coefficients[,4][2]
summary(greenNorthTimeBioclim1)$coefficients[,4][2]
summary(greenNorthTimeBioclim12)$coefficients[,4][2]
summary(greenNorthTimeBioclim15)$coefficients[,4][2]
summary(greenNorthTimeelev)$coefficients[,4][2]
summary(blueSATime13C)$coefficients[,4][2] 
summary(blueSATimeBioclim1)$coefficients[,4][2] 
summary(blueSATimeelev)$coefficients[,4][2] 
summary(blueNorthTime13C)$coefficients[,4][2]
summary(blueNorthTimeBioclim1)$coefficients[,4][2]
summary(blueNorthTimeBioclim12)$coefficients[,4][2]
summary(blueNorthTimeelev)$coefficients[,4][2]
summary(redSATime13C)$coefficients[,4][2] 
summary(redSATime15N)$coefficients[,4][2] 
summary(redSATimeBioclim1)$coefficients[,4][2] 
summary(redSATimeBioclim12)$coefficients[,4][2] 
summary(redSATimeBioclim15)$coefficients[,4][2]
summary(redSATimeelev)$coefficients[,4][2] 
summary(orangeNorthTimeBioclim12)$coefficients[,4][2]
#
# summary(forestgreenNorthdomTime13C)$coefficients[,4][2]
summary(forestgreenNorthdomTimeBioclim1)$coefficients[,4][2]
# summary(forestgreenNorthdomTimeBioclim12)$coefficients[,4][2]
summary(forestgreenNorthdomTimeBioclim15)$coefficients[,4][2]
# summary(forestgreenNorthdomTimeelev)$coefficients[,4][2]
# summary(forestgreenSAdomTime13C)$coefficients[,4][2]
# summary(forestgreenSAdomTimeBioclim1)$coefficients[,4][2]
# summary(forestgreenSAdomTimeBioclim12)$coefficients[,4][2]
# summary(forestgreenSAdomTimeBioclim15)$coefficients[,4][2]
# summary(forestgreenSAdomTimeelev)$coefficients[,4][2]
# summary(dodgerblueNorthdomTime13C)$coefficients[,4][2]
summary(dodgerblueNorthdomTimeBioclim1)$coefficients[,4][2]
summary(dodgerblueNorthdomTimeBioclim12)$coefficients[,4][2]
summary(dodgerblueNorthdomTimeBioclim15)$coefficients[,4][2]
summary(dodgerblueNorthdomTimeelev)$coefficients[,4][2]
# summary(dodgerblueSAdomTime13C)$coefficients[,4][2]
summary(dodgerblueSAdomTimeBioclim1)$coefficients[,4][2]
summary(dodgerblueSAdomTimeBioclim12)$coefficients[,4][2]
summary(dodgerblueSAdomTimeBioclim15)$coefficients[,4][2]
summary(dodgerblueSAdomTimeelev)$coefficients[,4][2]
# summary(cornsilkNorthdomTime13C)$coefficients[,4][2]
summary(cornsilkNorthdomTimeBioclim1)$coefficients[,4][2]
summary(cornsilkNorthdomTimeBioclim12)$coefficients[,4][2]
summary(cornsilkNorthdomTimeBioclim15)$coefficients[,4][2]
summary(cornsilkNorthdomTimeelev)$coefficients[,4][2]
# summary(cornsilkSAdomTime13C)$coefficients[,4][2]
summary(cornsilkSAdomTimeBioclim1)$coefficients[,4][2]
# summary(cornsilkSAdomTimeBioclim12)$coefficients[,4][2]
summary(cornsilkSAdomTimeBioclim15)$coefficients[,4][2]
# summary(cornsilkSAdomTimeelev)$coefficients[,4][2]
# summary(firebrickNorthdomTime13C)$coefficients[,4][2]
# summary(firebrickNorthdomTimeBioclim1)$coefficients[,4][2]
# summary(firebrickNorthdomTimeBioclim12)$coefficients[,4][2]
# summary(firebrickNorthdomTimeBioclim15)$coefficients[,4][2]
# summary(firebrickNorthdomTimeelev)$coefficients[,4][2]
#############
#
nk = vector()
lm_Human_d13C=list()
lm_Human_d15N=list()
for(mod in 1:6){
  lm_Human_d13C[[mod]]=list()
  lm_Human_d15N[[mod]]=list()
  for(i in 1:7){
  object = humans_corr_sub[humans_corr_sub$cluster9==colours_human[i],]
lm_Human_d13C[[1]][[i]] = lm( avg_d13C_org ~ adj_Date_mean, data=object) 
lm_Human_d15N[[1]][[i]] = lm( avg_d15N ~ adj_Date_mean, data=object)
  nk[i] = nrow(unique(object))/2}}
#
familytype = c("lm","gaussian","Gamma","inverse.gaussian","quasi","quasipoisson")
  #(quasi)binomial [probability], poisson [integer/discrete] removed: NA
  for(mod in 2:6){
  for(i in 1:7){ 
      object = humans_corr_sub[humans_corr_sub$cluster9==colours_human[i],]
      lm_Human_d13C[[mod]][[i]] = glm( adj_avg_d13C_org ~ adj_Date_mean, 
                           data=object, family=familytype[mod])
      lm_Human_d15N[[mod]][[i]] = glm( avg_d15N ~ adj_Date_mean, 
                           data=object, family=familytype[mod])}}
lm_dom_d13C=list()
lm_dom_d15N=list()
for(mod in 1:6){
  lm_dom_d13C[[mod]]=list()
  lm_dom_d15N[[mod]]=list()
  for(i in 1:6){
  object = dom_sub[dom_sub$cluster8==colours_dom[i],]
lm_dom_d13C[[1]][[i]] = lm( avg_d13C_org ~ adj_Date_mean, data=object) 
lm_dom_d15N[[1]][[i]] = lm( avg_d15N ~ adj_Date_mean, data=object)}}
#
familytype = c("lm","gaussian","Gamma","inverse.gaussian","quasi","quasipoisson")
  #(quasi)binomial [probability], poisson [integer/discrete] removed: NA
  for(mod in 2:6){
  for(i in 1:6){ 
      object = dom_sub[dom_sub$cluster8==colours_dom[i],]
      lm_dom_d13C[[mod]][[i]] = glm( adj_avg_d13C_org ~ adj_Date_mean, 
                           data=object, family=familytype[mod])
      lm_dom_d15N[[mod]][[i]] = glm( avg_d15N ~ adj_Date_mean, 
                           data=object, family=familytype[mod])}}

AICscores_d13C=list()
BICscores_d13C=list()
AICscores_d15N=list()
BICscores_d15N=list()
AICscores_dom_d13C=list()
BICscores_dom_d13C=list()
AICscores_dom_d15N=list()
BICscores_dom_d15N=list()
#
#Burnham et al 2004: use AICc when #observations/#estParameters < 40
library(MuMIn)
for(mod in 1:6){AICscores_d13C[[mod]]=c(AICc(lm_Human_d13C[[mod]][[1]]),AICc(lm_Human_d13C[[mod]][[2]]),
                                   AICc(lm_Human_d13C[[mod]][[3]]),AICc(lm_Human_d13C[[mod]][[4]]),
                                   AICc(lm_Human_d13C[[mod]][[5]]),AICc(lm_Human_d13C[[mod]][[6]]),
                                   AICc(lm_Human_d13C[[mod]][[7]]))
                BICscores_d13C[[mod]]=c(BIC(lm_Human_d13C[[mod]][[1]]),BIC(lm_Human_d13C[[mod]][[2]]),
                                   BIC(lm_Human_d13C[[mod]][[3]]),BIC(lm_Human_d13C[[mod]][[4]]),
                                   BIC(lm_Human_d13C[[mod]][[5]]),BIC(lm_Human_d13C[[mod]][[6]]),
                                   BIC(lm_Human_d13C[[mod]][[7]]))
                AICscores_d15N[[mod]]=c(AICc(lm_Human_d15N[[mod]][[1]]),AICc(lm_Human_d15N[[mod]][[2]]),
                                   AICc(lm_Human_d15N[[mod]][[3]]),AICc(lm_Human_d15N[[mod]][[4]]),
                                   AICc(lm_Human_d15N[[mod]][[5]]),AICc(lm_Human_d15N[[mod]][[6]]),
                                   AICc(lm_Human_d15N[[mod]][[7]]))
                BICscores_d15N[[mod]]=c(BIC(lm_Human_d15N[[mod]][[1]]),BIC(lm_Human_d15N[[mod]][[2]]),
                                   BIC(lm_Human_d15N[[mod]][[3]]),BIC(lm_Human_d15N[[mod]][[4]]),
                                   BIC(lm_Human_d15N[[mod]][[5]]),BIC(lm_Human_d15N[[mod]][[6]]),
                                   BIC(lm_Human_d15N[[mod]][[7]]))}
for(mod in 1:6){AICscores_dom_d13C[[mod]]=c(AICc(lm_dom_d13C[[mod]][[1]]),AICc(lm_dom_d13C[[mod]][[2]]),
                                   AICc(lm_dom_d13C[[mod]][[3]]),AICc(lm_dom_d13C[[mod]][[4]]),
                                   AICc(lm_dom_d13C[[mod]][[5]]),AICc(lm_dom_d13C[[mod]][[6]]))
                BICscores_dom_d13C[[mod]]=c(BIC(lm_dom_d13C[[mod]][[1]]),BIC(lm_dom_d13C[[mod]][[2]]),
                                   BIC(lm_dom_d13C[[mod]][[3]]),BIC(lm_dom_d13C[[mod]][[4]]),
                                   BIC(lm_dom_d13C[[mod]][[5]]),BIC(lm_dom_d13C[[mod]][[6]]))
                AICscores_dom_d15N[[mod]]=c(AICc(lm_dom_d15N[[mod]][[1]]),AICc(lm_dom_d15N[[mod]][[2]]),
                                   AICc(lm_dom_d15N[[mod]][[3]]),AICc(lm_dom_d15N[[mod]][[4]]),
                                   AICc(lm_dom_d15N[[mod]][[5]]),AICc(lm_dom_d15N[[mod]][[6]]))
                BICscores_dom_d15N[[mod]]=c(BIC(lm_dom_d15N[[mod]][[1]]),BIC(lm_dom_d15N[[mod]][[2]]),
                                   BIC(lm_dom_d15N[[mod]][[3]]),BIC(lm_dom_d15N[[mod]][[4]]),
                                   BIC(lm_dom_d15N[[mod]][[5]]),BIC(lm_dom_d15N[[mod]][[6]]))}
#
pval_d13C = list()
pval_d15N = list()
pval_dom_d13C = list()
pval_dom_d15N = list()
for(mod in 1:6){pval_d13C[[mod]]=list()
                pval_d15N[[mod]]=list()
                pval_dom_d13C[[mod]]=list()
                pval_dom_d15N[[mod]]=list()}
for(mod in 1:6){
  for(i in 1:7){pval_d13C[[mod]][[i]] = round(summary(lm_Human_d13C[[mod]][[i]])$coefficients[,4][2],
                                         digits = 10)
                pval_d15N[[mod]][[i]] = round(summary(lm_Human_d15N[[mod]][[i]])$coefficients[,4][2],
                                         digits = 10)}
  for(i in 1:6){pval_dom_d13C[[mod]][[i]] = round(summary(lm_dom_d13C[[mod]][[i]])$coefficients[,4][2],
                                         digits = 10)
                pval_dom_d15N[[mod]][[i]] = round(summary(lm_dom_d15N[[mod]][[i]])$coefficients[,4][2],
                                         digits = 10)}}
###################################################################
AICscores_d13C_df=list()
AICscores_d15N_df=list()
BICscores_d13C_df=list()
BICscores_d15N_df=list()
AICscores_dom_d13C_df=list()
AICscores_dom_d15N_df=list()
BICscores_dom_d13C_df=list()
BICscores_dom_d15N_df=list()
pval_d13C_df=list()
pval_d15N_df=list()
pval_dom_d13C_df=list()
pval_dom_d15N_df=list()
for(mod in 1:6){AICscores_d13C_df[[mod]] <- c(do.call(rbind,lapply(AICscores_d13C[[mod]], data.frame)))
                AICscores_d15N_df[[mod]] <- c(do.call(rbind,lapply(AICscores_d15N[[mod]], data.frame)))
                pval_d13C_df[[mod]] <- c(do.call(rbind,lapply(pval_d13C[[mod]], data.frame)))
                pval_d15N_df[[mod]] <- c(do.call(rbind,lapply(pval_d15N[[mod]], data.frame)))}
ALLAIC_d13C = data.frame(AICscores_d13C_df[[1]]$X..i..,AICscores_d13C_df[[2]]$X..i..,
                         AICscores_d13C_df[[3]]$X..i..,AICscores_d13C_df[[4]]$X..i..,
                         AICscores_d13C_df[[5]]$X..i..,AICscores_d13C_df[[6]]$X..i..)
ALLAIC_d15N = data.frame(AICscores_d15N_df[[1]]$X..i..,AICscores_d15N_df[[2]]$X..i..,
                         AICscores_d15N_df[[3]]$X..i..,AICscores_d15N_df[[4]]$X..i..,
                         AICscores_d15N_df[[5]]$X..i..,AICscores_d15N_df[[6]]$X..i..)
for(mod in 1:6){AICscores_dom_d13C_df[[mod]] <- c(do.call(rbind,lapply(AICscores_dom_d13C[[mod]], data.frame)))
                AICscores_dom_d15N_df[[mod]] <- c(do.call(rbind,lapply(AICscores_dom_d15N[[mod]], data.frame)))
                pval_dom_d13C_df[[mod]] <- c(do.call(rbind,lapply(pval_dom_d13C[[mod]], data.frame)))
                pval_dom_d15N_df[[mod]] <- c(do.call(rbind,lapply(pval_dom_d15N[[mod]], data.frame)))}
ALLAIC_dom_d13C = data.frame(AICscores_dom_d13C_df[[1]]$X..i..,AICscores_dom_d13C_df[[2]]$X..i..,
                         AICscores_dom_d13C_df[[3]]$X..i..,AICscores_dom_d13C_df[[4]]$X..i..,
                         AICscores_dom_d13C_df[[5]]$X..i..,AICscores_dom_d13C_df[[6]]$X..i..)
ALLAIC_dom_d15N = data.frame(AICscores_dom_d15N_df[[1]]$X..i..,AICscores_dom_d15N_df[[2]]$X..i..,
                         AICscores_dom_d15N_df[[3]]$X..i..,AICscores_dom_d15N_df[[4]]$X..i..,
                         AICscores_dom_d15N_df[[5]]$X..i..,AICscores_dom_d15N_df[[6]]$X..i..)
for(mod in 1:6){BICscores_d13C_df[[mod]] <- c(do.call(rbind,lapply(BICscores_d13C[[mod]], data.frame)))
                BICscores_d15N_df[[mod]] <- c(do.call(rbind,lapply(BICscores_d15N[[mod]], data.frame)))
                pval_d13C_df[[mod]] <- c(do.call(rbind,lapply(pval_d13C[[mod]], data.frame)))
                pval_d15N_df[[mod]] <- c(do.call(rbind,lapply(pval_d15N[[mod]], data.frame)))}
ALLBIC_d13C = data.frame(BICscores_d13C_df[[1]]$X..i..,BICscores_d13C_df[[2]]$X..i..,
                         BICscores_d13C_df[[3]]$X..i..,BICscores_d13C_df[[4]]$X..i..,
                         BICscores_d13C_df[[5]]$X..i..,BICscores_d13C_df[[6]]$X..i..)
ALLBIC_d15N = data.frame(BICscores_d15N_df[[1]]$X..i..,BICscores_d15N_df[[2]]$X..i..,
                         BICscores_d15N_df[[3]]$X..i..,BICscores_d15N_df[[4]]$X..i..,
                         BICscores_d15N_df[[5]]$X..i..,BICscores_d15N_df[[6]]$X..i..)
for(mod in 1:6){BICscores_dom_d13C_df[[mod]] <- c(do.call(rbind,lapply(BICscores_dom_d13C[[mod]], data.frame)))
                BICscores_dom_d15N_df[[mod]] <- c(do.call(rbind,lapply(BICscores_dom_d15N[[mod]], data.frame)))
                pval_dom_d13C_df[[mod]] <- c(do.call(rbind,lapply(pval_dom_d13C[[mod]], data.frame)))
                pval_dom_d15N_df[[mod]] <- c(do.call(rbind,lapply(pval_dom_d15N[[mod]], data.frame)))}
ALLBIC_dom_d13C = data.frame(BICscores_dom_d13C_df[[1]]$X..i..,BICscores_dom_d13C_df[[2]]$X..i..,
                         BICscores_dom_d13C_df[[3]]$X..i..,BICscores_dom_d13C_df[[4]]$X..i..,
                         BICscores_dom_d13C_df[[5]]$X..i..,BICscores_dom_d13C_df[[6]]$X..i..)
ALLBIC_dom_d15N = data.frame(BICscores_dom_d15N_df[[1]]$X..i..,BICscores_dom_d15N_df[[2]]$X..i..,
                         BICscores_dom_d15N_df[[3]]$X..i..,BICscores_dom_d15N_df[[4]]$X..i..,
                         BICscores_dom_d15N_df[[5]]$X..i..,BICscores_dom_d15N_df[[6]]$X..i..)
ALLpval_d13C = data.frame(pval_d13C_df[[1]]$X..i..,pval_d13C_df[[2]]$X..i..,
                         pval_d13C_df[[3]]$X..i..,pval_d13C_df[[4]]$X..i..,
                         pval_d13C_df[[5]]$X..i..,pval_d13C_df[[6]]$X..i..)
ALLpval_d15N = data.frame(pval_d15N_df[[1]]$X..i..,pval_d15N_df[[2]]$X..i..,
                         pval_d15N_df[[3]]$X..i..,pval_d15N_df[[4]]$X..i..,
                         pval_d15N_df[[5]]$X..i..,pval_d15N_df[[6]]$X..i..)
ALLpval_dom_d13C = data.frame(pval_dom_d13C_df[[1]]$X..i..,pval_dom_d13C_df[[2]]$X..i..,
                         pval_dom_d13C_df[[3]]$X..i..,pval_dom_d13C_df[[4]]$X..i..,
                         pval_dom_d13C_df[[5]]$X..i..,pval_dom_d13C_df[[6]]$X..i..)
ALLpval_dom_d15N = data.frame(pval_dom_d15N_df[[1]]$X..i..,pval_dom_d15N_df[[2]]$X..i..,
                         pval_dom_d15N_df[[3]]$X..i..,pval_dom_d15N_df[[4]]$X..i..,
                         pval_dom_d15N_df[[5]]$X..i..,pval_dom_d15N_df[[6]]$X..i..)
####################################
colnames(ALLAIC_d13C)<-c(familytype)
colnames(ALLAIC_d15N)<-c(familytype)
colnames(ALLBIC_d13C)<-c(familytype)
colnames(ALLBIC_d15N)<-c(familytype)
colnames(ALLpval_d13C)<-c(familytype)
colnames(ALLpval_d15N)<-c(familytype)
colnames(ALLAIC_dom_d13C)<-c(familytype)
colnames(ALLAIC_dom_d15N)<-c(familytype)
colnames(ALLBIC_dom_d13C)<-c(familytype)
colnames(ALLBIC_dom_d15N)<-c(familytype)
colnames(ALLpval_dom_d13C)<-c(familytype)
colnames(ALLpval_dom_d15N)<-c(familytype)
#
ALLAIC_d13C$isotope<-"d13C"
ALLAIC_d13C$cluster<-rownames(ALLAIC_d13C)
ALLAIC_d15N$isotope<-"d15N"
ALLAIC_d15N$cluster<-rownames(ALLAIC_d15N)
ALLBIC_d13C$isotope<-"d13C"
ALLBIC_d13C$cluster<-rownames(ALLBIC_d13C)
ALLBIC_d15N$isotope<-"d15N"
ALLBIC_d15N$cluster<-rownames(ALLBIC_d15N)
ALLpval_d13C$isotope<-"d13C"
ALLpval_d13C$cluster<-rownames(pval_d13C)
ALLpval_d15N$isotope<-"d15N"
ALLpval_d15N$cluster<-rownames(pval_d15N)
ALLAIC_dom_d13C$isotope<-"d13C"
ALLAIC_dom_d13C$cluster<-rownames(ALLAIC_dom_d13C)
ALLAIC_dom_d15N$isotope<-"d15N"
ALLAIC_dom_d15N$cluster<-rownames(ALLAIC_dom_d15N)
ALLBIC_dom_d13C$isotope<-"d13C"
ALLBIC_dom_d13C$cluster<-rownames(ALLBIC_dom_d13C)
ALLBIC_dom_d15N$isotope<-"d15N"
ALLBIC_dom_d15N$cluster<-rownames(ALLBIC_dom_d15N)
ALLpval_dom_d13C$isotope<-"d13C"
ALLpval_dom_d13C$cluster<-rownames(pval_dom_d13C)
ALLpval_dom_d15N$isotope<-"d15N"
ALLpval_dom_d15N$cluster<-rownames(pval_dom_d15N)
#
ALLAIC = rbind(ALLAIC_d13C,ALLAIC_d15N)
ALLAIC_dom = rbind(ALLAIC_dom_d13C,ALLAIC_dom_d15N)
ALLAIC$test = "AICc"
ALLAIC_dom$test = "AICc"
ALLBIC = rbind(ALLBIC_d13C,ALLBIC_d15N)
ALLBIC_dom = rbind(ALLBIC_dom_d13C,ALLBIC_dom_d15N)
ALLBIC$test = "BIC"
ALLBIC_dom$test = "BIC"
ALLpval = rbind(ALLpval_d13C,ALLpval_d15N)
ALLpval_dom = rbind(ALLpval_dom_d13C,ALLpval_dom_d15N)
ALLAIC$family = NA
ALLBIC$family = NA
ALLAIC_dom$family = NA
ALLBIC_dom$family = NA
for(row in 1:nrow(ALLAIC)){
  ALLAIC[row,][,"family"]<-names(ALLAIC[row,][,2:4])[apply(ALLAIC[row,][,2:4], MARGIN = 1, FUN = which.min)]}
for(row in 1:nrow(ALLAIC_dom)){
  ALLAIC_dom[row,][,"family"]<-names(ALLAIC_dom[row,][,2:4])[apply(ALLAIC_dom[row,][,2:4], MARGIN = 1, FUN = which.min)]}
#
ALLtests = ALLAIC
ALLtests_dom = ALLAIC_dom
for(i in 1:7){ALLtests$cluster[ALLtests$cluster==i]<-colours_human[i]}
for(i in 1:6){ALLtests_dom$cluster[ALLtests_dom$cluster==i]<-colours_dom[i]}
ALLAIC$clustercol = ALLAIC$cluster
ALLAIC_dom$clustercol = ALLAIC_dom$cluster
for (i in 1:7){ALLAIC[i,][,"clustercol"]<-colours_human[i]}
for (i in 1:7){ALLAIC[i+7,][,"clustercol"]<-colours_human[i]}
for (i in 1:6){ALLAIC_dom[i,][,"clustercol"]<-colours_dom[i]}
for (i in 1:6){ALLAIC_dom[i+6,][,"clustercol"]<-colours_dom[i]}
ALLAIC$pval<-ALLAIC$family
ALLAIC_dom$pval<-ALLAIC_dom$family
for(row in 1:nrow(ALLAIC)){
  family = ALLAIC[row,][,"family"]
  if(!is.na(family)){ALLAIC[row,][,"pval"] <- ALLpval[row,][,family]}}
for(row in 1:nrow(ALLAIC_dom)){
  family = ALLAIC_dom[row,][,"family"]
  if(!is.na(family)){ALLAIC_dom[row,][,"pval"] <- ALLpval_dom[row,][,family]}}
ALLAIC_dom$family
ALLAIC_dom$pval 
#
ALLAIC$pvalstat = as.numeric(ALLAIC$pval)
ALLAIC_dom$pvalstat = as.numeric(ALLAIC_dom$pval)
ALLAIC$pvalstat[ALLAIC$pvalstat<0.001]<-"***"
ALLAIC$pvalstat[ALLAIC$pvalstat<=0.1 & ALLAIC$pvalstat >= 0.05]<-"."
ALLAIC$pvalstat[ALLAIC$pvalstat<0.05 & ALLAIC$pvalstat >= 0.01]<-"*"
ALLAIC$pvalstat[ALLAIC$pvalstat<0.01 & ALLAIC$pvalstat >= 0.001]<-"**"
ALLAIC$pvalstat[ALLAIC$pvalstat>0.1]<-"nonsig"
ALLAIC_dom$pvalstat[ALLAIC_dom$pvalstat<0.001]<-"***"
ALLAIC_dom$pvalstat[ALLAIC_dom$pvalstat<=0.1 & ALLAIC_dom$pvalstat >= 0.05]<-"."
ALLAIC_dom$pvalstat[ALLAIC_dom$pvalstat<0.05 & ALLAIC_dom$pvalstat >= 0.01]<-"*"
ALLAIC_dom$pvalstat[ALLAIC_dom$pvalstat<0.01 & ALLAIC_dom$pvalstat >= 0.001]<-"**"
ALLAIC_dom$pvalstat[ALLAIC_dom$pvalstat>0.1]<-"nonsig"
#
#PLOTS
xmin = min(humans_corr_sub$adj_Date_mean,na.rm=TRUE)
xmax = max(humans_corr_sub$adj_Date_mean,na.rm=TRUE)
ALLAIC_human_select<-ALLAIC[as.numeric(ALLAIC$pval) <= 0.1,]
ALLAIC_human_select<-ALLAIC_human_select[,c("isotope","clustercol","family","pvalstat","cluster")]
ALLAIC_human_select$familyName<-ALLAIC_human_select$family
ALLAIC_human_select$family[ALLAIC_human_select$family=="gaussian"]<-2
ALLAIC_human_select$family[ALLAIC_human_select$family=="Gamma"]<-3
ALLAIC_human_select$family[ALLAIC_human_select$family=="inverse.gaussian"]<-4
ALLAIC_dom_select<-ALLAIC_dom[as.numeric(ALLAIC_dom$pval) <= 0.1,]
ALLAIC_dom_select<-ALLAIC_dom_select[,c("isotope","clustercol","family","pvalstat","cluster")]
ALLAIC_dom_select$familyName<-ALLAIC_dom_select$family
ALLAIC_dom_select$family[ALLAIC_dom_select$family=="gaussian"]<-2
ALLAIC_dom_select$family[ALLAIC_dom_select$family=="Gamma"]<-3
ALLAIC_dom_select$family[ALLAIC_dom_select$family=="inverse.gaussian"]<-4
yellowHumanSub = humans_corr_sub[humans_corr_sub$cluster9=="yellow",]
orangeHumanSub = humans_corr_sub[humans_corr_sub$cluster9=="orange",]
greenHumanSub = humans_corr_sub[humans_corr_sub$cluster9=="green",]
purpleHumanSub = humans_corr_sub[humans_corr_sub$cluster9=="darkorchid",]
redHumanSub = humans_corr_sub[humans_corr_sub$cluster9=="red",]
blueHumanSub = humans_corr_sub[humans_corr_sub$cluster9=="blue",]
grayHumanSub = humans_corr_sub[humans_corr_sub$cluster9=="gray",]
groups = list(yellowHumanSub,orangeHumanSub,greenHumanSub,purpleHumanSub,redHumanSub,blueHumanSub,grayHumanSub)
cornsilkDomSub = dom_sub[dom_sub$cluster8=="cornsilk3",]
blueDomSub = dom_sub[dom_sub$cluster8=="dodgerblue",]
greenDomSub = dom_sub[dom_sub$cluster8=="forestgreen",]
redDomSub = dom_sub[dom_sub$cluster8=="firebrick",]
orangeDomSub = dom_sub[dom_sub$cluster8=="darkorange2",]
tanDomSub = dom_sub[dom_sub$cluster8=="tan",]
groups_dom = list(cornsilkDomSub,blueDomSub,greenDomSub,redDomSub,orangeDomSub,tanDomSub)
######################################
#TIME TRENDS d15N
all <- do.call(rbind,lapply(groups, data.frame))
ymin = min(all$avg_d15N,na.rm=TRUE)
ymax = max(all$avg_d15N,na.rm=TRUE)
ymin_d15N = min(all$avg_d15N,na.rm=TRUE)
ymax_d15N = max(all$avg_d15N,na.rm=TRUE)
xmin = min(all$adj_Date_mean,na.rm=TRUE)
xmax = max(all$adj_Date_mean,na.rm=TRUE)
pdf("[path].pdf")
plot(blueHumanSub$adj_Date_mean, blueHumanSub$avg_d15N, col=blueHumanSub$cluster9, ylim=c(ymin,ymax),xlim=c(xmax-1500, xmin))
for(i in 1:7){
  df = groups[[i]]
  if(df$cluster9 == "yellow"){ df$cluster9<-"yellow2"}
  if(df$cluster9 == "green"){ df$cluster9<-"green2"}
  if(df$cluster9 == "blue"){ df$cluster9<-"dodgerblue"}
  points(df$adj_Date_mean,df$avg_d15N,col=df$cluster9)}
testiq<-ALLAIC_human_select[ALLAIC_human_select$isotope=="d15N",]
testiq<-testiq[!is.na(testiq$isotope),]
for(row in 1:nrow(testiq)){
  if(testiq[row,][,"pvalstat"]=="."){lwd_index = 1}
  if(testiq[row,][,"pvalstat"]=="*"){lwd_index = 2.5}
  if(testiq[row,][,"pvalstat"]=="**"){lwd_index = 3}
  if(testiq[row,][,"pvalstat"]=="***"){lwd_index = 4}
  subglm = lm_Human_d15N[[ as.numeric(testiq[row,][,"family"]) ]] [[ as.numeric(testiq[row,][,"cluster"])]]
  subset = humans_corr_sub[humans_corr_sub$cluster9 == testiq[row,][,"clustercol"],]
  color = paste( as.character(subset[1,][,"cluster9"]))
  if(color == "yellow"){ color<-"yellow2"}
  if(color == "green"){ color<-"green2"}
  if(color == "blue"){ color<-"dodgerblue"}
  logistic_model <- glm(avg_d15N~adj_Date_mean, data=subset, family="gaussian")
  Predicted_data <- data.frame(adj_Date_mean = seq(min(subset$adj_Date_mean), max(subset$adj_Date_mean),len=500))
  Predicted_data$avg_d15N = predict(logistic_model, Predicted_data)
  lines(avg_d15N ~ adj_Date_mean, Predicted_data, lwd=lwd_index, col=color)}
  Predicted_data<-data.frame(adj_Date_mean = seq(min(redSA$adj_Date_mean), max(redSA$adj_Date_mean), len = 500))
  Predicted_data$avg_d15N = predict(redSATime15N, Predicted_data)
  lines(avg_d15N ~ adj_Date_mean, Predicted_data, col="firebrick", lty = "dotted",lwd=2)
dev.off()
#
#TIME TRENDS d13C
all <- do.call(rbind,lapply(groups, data.frame))
ymin = min(all$avg_d13C_org,na.rm=TRUE)
ymax = max(all$avg_d13C_org,na.rm=TRUE)
ymin_d13C = min(all$avg_d13C_org,na.rm=TRUE)
ymax_d13C = max(all$avg_d13C_org,na.rm=TRUE)
pdf("[path].pdf")
plot(blueHumanSub$adj_Date_mean, blueHumanSub$avg_d13C_org, col=blueHumanSub$cluster9, ylim=c(ymin,ymax),xlim=c(xmax-1500, xmin))
for(i in 1:7){
  df = groups[[i]]
  if(df$cluster9 == "yellow"){ df$cluster9<-"yellow2"}
  if(df$cluster9 == "green"){ df$cluster9<-"green2"}
  if(df$cluster9 == "blue"){ df$cluster9<-"dodgerblue"}
  points(df$adj_Date_mean,df$avg_d13C_org,col=df$cluster9)}
testiq<-ALLAIC_human_select[ALLAIC_human_select$isotope=="d13C",]
testiq<-testiq[!is.na(testiq$isotope),]
for(row in 1:nrow(testiq)){
  if(testiq[row,][,"pvalstat"]=="."){lwd_index = 1}
  if(testiq[row,][,"pvalstat"]=="*"){lwd_index = 2.5}
  if(testiq[row,][,"pvalstat"]=="**"){lwd_index = 3}
  if(testiq[row,][,"pvalstat"]=="***"){lwd_index = 4}
  subglm = lm_Human_d13C[[ as.numeric(testiq[row,][,"family"]) ]] [[ as.numeric(testiq[row,][,"cluster"])]]
  subset = humans_corr_sub[humans_corr_sub$cluster9 == testiq[row,][,"clustercol"],]
  color = paste( as.character(subset[1,][,"cluster9"]))
  if(color == "yellow"){ color<-"yellow2"}
  if(color == "green"){ color<-"green2"}
  if(color == "blue"){ color<-"dodgerblue"}
  logistic_model <- glm(avg_d13C_org~adj_Date_mean, data=subset, family="gaussian")
  Predicted_data <- data.frame(adj_Date_mean = seq(min(subset$adj_Date_mean), max(subset$adj_Date_mean),len=500))
  Predicted_data$avg_d13C_org = predict(logistic_model, Predicted_data)
  lines(avg_d13C_org ~ adj_Date_mean, Predicted_data, lwd=lwd_index, col=color) }
  Predicted_data<-data.frame(adj_Date_mean = seq(min(greenNorth$adj_Date_mean), max(greenNorth$adj_Date_mean), len = 500))
  Predicted_data$avg_d13C_org = predict(greenNorthTime13C, Predicted_data)
  lines(avg_d13C_org ~ adj_Date_mean, Predicted_data, col="darkgreen", lty = "dashed",lwd=2)
  Predicted_data<-data.frame(adj_Date_mean = seq(min(blueNorth$adj_Date_mean), max(blueNorth$adj_Date_mean), len = 500))
  Predicted_data$avg_d13C_org = predict(blueNorthTime13C, Predicted_data)
  lines(avg_d13C_org ~ adj_Date_mean, Predicted_data, col="dodgerblue", lty = "dashed",lwd=2)
  Predicted_data<-data.frame(adj_Date_mean = seq(min(blueSA$adj_Date_mean), max(blueSA$adj_Date_mean), len = 500))
  Predicted_data$avg_d13C_org = predict(blueSATime13C, Predicted_data)
  lines(avg_d13C_org ~ adj_Date_mean, Predicted_data, col="dodgerblue", lty = "dotted",lwd=2)
  Predicted_data<-data.frame(adj_Date_mean = seq(min(redSA$adj_Date_mean), max(redSA$adj_Date_mean), len = 500))
  Predicted_data$avg_d13C_org = predict(redSATime13C, Predicted_data)
  lines(avg_d13C_org ~ adj_Date_mean, Predicted_data, col="red", lty = "dotted",lwd=2)
  dev.off()
######################################
#DOMESTIC VERSION
all <- do.call(rbind,lapply(groups_dom, data.frame))
ymin = min(all$avg_d13C_org,na.rm=TRUE)
ymax = max(all$avg_d13C_org,na.rm=TRUE)
pdf("[path].pdf")
plot(blueDomSub$adj_Date_mean, blueDomSub$avg_d13C_org, col=blueDomSub$cluster8, ylim=c(ymin_d13C,ymax_d13C),xlim=c(xmax-1500, xmin))
for(i in 1:6){
  df = groups_dom[[i]]
  if(df$cluster8 == "yellow"){ df$cluster8<-"yellow2"}
  if(df$cluster8 == "green"){ df$cluster8<-"green2"}
  if(df$cluster8 == "blue"){ df$cluster8<-"dodgerblue"}
  points(df$adj_Date_mean,df$avg_d13C_org,col=df$cluster8)}
testiq<-ALLAIC_dom_select[ALLAIC_dom_select$isotope=="d13C",]
testiq<-testiq[!is.na(testiq$isotope),]
#
for(row in 1:nrow(testiq)){
  if(testiq[row,][,"pvalstat"]=="."){lwd_index = 1}
  if(testiq[row,][,"pvalstat"]=="*"){lwd_index = 2.5}
  if(testiq[row,][,"pvalstat"]=="**"){lwd_index = 3}
  if(testiq[row,][,"pvalstat"]=="***"){lwd_index = 4}
  subglm = lm_dom_d13C[[ as.numeric(testiq[row,][,"family"]) ]] [[ as.numeric(testiq[row,][,"cluster"])]]
  subset = dom_sub[dom_sub$cluster8 == testiq[row,][,"clustercol"],]
  color = paste( as.character(subset[1,][,"cluster8"]))
  if(color == "yellow"){ color<-"yellow2"}
  if(color == "green"){ color<-"green2"}
  if(color == "blue"){ color<-"dodgerblue"}
  logistic_model <- glm(avg_d13C_org~adj_Date_mean, data=subset, family="gaussian")
  Predicted_data <- data.frame(adj_Date_mean = seq(min(subset$adj_Date_mean), max(subset$adj_Date_mean),len=500))
  Predicted_data$avg_d13C_org = predict(logistic_model, Predicted_data)
  lines(avg_d13C_org ~ adj_Date_mean, Predicted_data, lwd=lwd_index, col=color) }
dev.off()
################################################
all <- do.call(rbind,lapply(groups_dom, data.frame))
ymin = min(all$avg_d15N,na.rm=TRUE)
ymax = max(all$avg_d15N,na.rm=TRUE)
pdf("[path].pdf")
plot(blueDomSub$adj_Date_mean, blueDomSub$avg_d15N, col=blueDomSub$cluster8, ylim=c(ymin_d15N,ymax_d15N),xlim=c(xmax-1500, xmin))
for(i in 1:6){
  df = groups_dom[[i]]
  if(df$cluster8 == "yellow"){ df$cluster8<-"yellow2"}
  if(df$cluster8 == "green"){ df$cluster8<-"green2"}
  if(df$cluster8 == "blue"){ df$cluster8<-"dodgerblue"}
  points(df$adj_Date_mean,df$avg_d15N,col=df$cluster8)}
testiq<-ALLAIC_dom_select[ALLAIC_dom_select$isotope=="d15N",]
testiq<-testiq[!is.na(testiq$isotope),]
```



```{r}

#FIGURE 5 REGIONAL LM PLOTS
all_h_e = humans_corr[humans_corr$Site %in% all_e$Site,]
all_h_ne = humans_corr[humans_corr$Site %in% all_ne$Site,]
all_h_s = humans_corr[humans_corr$Site %in% all_s$Site,]
all_h_w = humans_corr[humans_corr$Site %in% all_w$Site,] # n = 5
all_h_c = humans_corr[humans_corr$Site %in% all_c$Site,]
all_h_sahel = humans_corr[humans_corr$Site %in% all_sahel$Site,] #n = 1
all_dom_e = domenamel_corr[domenamel_corr$Site %in% all_e$Site,] #ENAMEL!
all_dom_ne = dom_corr[dom_corr$Site %in% all_ne$Site,]
all_dom_s = dom_corr[dom_corr$Site %in% all_s$Site,]
all_dom_w = dom_corr[dom_corr$Site %in% all_w$Site,] # n = 5
all_dom_c = dom_corr[dom_corr$Site %in% all_c$Site,]
all_dom_sahel = dom_corr[dom_corr$Site %in% all_sahel$Site,] #n = 1
all_wild_e = wildenamel_corr[wildenamel_corr$Site %in% all_e$Site,] #enamel!
all_wild_ne = wild_corr[wild_corr$Site %in% all_ne$Site,]
all_wild_s = wild_corr[wild_corr$Site %in% all_s$Site,]
all_wild_w = wild_corr[wild_corr$Site %in% all_w$Site,] # n = 5
all_wild_c = wild_corr[wild_corr$Site %in% all_c$Site,]
all_wild_sahel = wild_corr[wild_corr$Site %in% all_sahel$Site,] #n = 1
summary(lm(all_h_e$avg_d13C_org~all_h_e$Date_mean)) #F = 4.504; p = 0.03744
summary(lm(all_h_e$avg_d15N~all_h_e$Date_mean)) #F = 8.119; p = 0.005792
##########
tAHP_ne = all_h_ne[all_h_ne$Date_mean > -1500,] #3500 BP  - 10k BP
AHP_ne = all_h_ne[all_h_ne$Date_mean < -1500 & all_h_ne$Date_mean >-9700,]  #0 - 3500 BP
entire_ne = all_h_ne
tAHP_dom_ne = all_dom_ne[all_dom_ne$Date_mean > -1500,] #3500 BP  - 10k BP
AHP_dom_ne = all_dom_ne[all_dom_ne$Date_mean < -1500 & all_dom_ne$Date_mean >-9700,]  #0 - 3500 BP
entire_dom_ne = all_dom_ne
tAHP_wild_ne = all_wild_ne[all_wild_ne$Date_mean > -1500,] #3500 BP  - 10k BP
AHP_wild_ne = all_wild_ne[all_wild_ne$Date_mean < -1500 & all_wild_ne$Date_mean >-9700,]  #0 - 3500 BP
entire_wild_ne = all_wild_ne
tAHP_e = all_h_e[all_h_e$Date_mean > -1500,] #3500 BP  - 10k BP
AHP_e = all_h_e[all_h_e$Date_mean < -1500 & all_h_e$Date_mean >-9700,]  #0 - 3500 BP
entire_e = all_h_e
tAHP_dom_e = all_dom_e[all_dom_e$Date_mean > -1500,] #3500 BP  - 10k BP
AHP_dom_e = all_dom_e[all_dom_e$Date_mean < -1500 & all_dom_e$Date_mean >-9700,]  #0 - 3500 BP
entire_dom_e = all_dom_e
tAHP_wild_e = all_wild_e[all_wild_e$Date_mean > -1500,] #3500 BP  - 10k BP
AHP_wild_e = all_wild_e[all_wild_e$Date_mean < -1500 & all_wild_e$Date_mean >-9700,]  #0 - 3500 BP
entire_wild_e = all_wild_e
tAHP_s = all_h_s[all_h_s$Date_mean > -1500,] #3500 BP  - 10k BP
AHP_s = all_h_s[all_h_s$Date_mean < -1500 & all_h_s$Date_mean >-9700,]  #0 - 3500 BP
entire_s = all_h_s
tAHP_dom_s = all_dom_s[all_dom_s$Date_mean > -1500,] #3500 BP  - 10k BP
AHP_dom_s = all_dom_s[all_dom_s$Date_mean < -1500 & all_dom_s$Date_mean >-9700,]  #0 - 3500 BP
entire_dom_s = all_dom_s
tAHP_wild_s = all_wild_s[all_wild_s$Date_mean > -1500,] #3500 BP  - 10k BP
AHP_wild_s = all_wild_s[all_wild_s$Date_mean < -1500 & all_wild_s$Date_mean >-9700,]  #0 - 3500 BP
entire_wild_s = all_wild_s
tAHP_c = all_h_c[all_h_c$Date_mean > -1500,] #3500 BP  - 10k BP
AHP_c = all_h_c[all_h_c$Date_mean < -1500 & all_h_c$Date_mean >-9700,]  #0 - 3500 BP
entire_c = all_h_c
tAHP_dom_c = all_dom_c[all_dom_c$Date_mean > -1500,] #3500 BP  - 10k BP
AHP_dom_c = all_dom_c[all_dom_c$Date_mean < -1500 & all_dom_c$Date_mean >-9700,]  #0 - 3500 BP
entire_dom_c = all_dom_c
tAHP_wild_c = all_wild_c[all_wild_c$Date_mean > -1500,] #3500 BP  - 10k BP
AHP_wild_c = all_wild_c[all_wild_c$Date_mean < -1500 & all_wild_c$Date_mean >-9700,]  #0 - 3500 BP
entire_wild_c = all_wild_c
##########################

ne_lmAHP_d13c = lm(AHP_ne$avg_d13C_org~AHP_ne$Date_mean)
ne_lmAHP_d15n = lm(AHP_ne$avg_d15N~AHP_ne$Date_mean)
ne_lmtAHP_d13c = lm(tAHP_ne$avg_d13C_org~tAHP_ne$Date_mean)
ne_lmtAHP_d15n = lm(tAHP_ne$avg_d15N~tAHP_ne$Date_mean)
ne_lmentire_d13c = lm(entire_ne$avg_d13C_org~entire_ne$Date_mean)
ne_lmentire_d15n = lm(entire_ne$avg_d15N~entire_ne$Date_mean)
ne_dom_lmAHP_d13c = lm(AHP_dom_ne$avg_d13C_org~AHP_dom_ne$Date_mean)
ne_dom_lmAHP_d15n = lm(AHP_dom_ne$avg_d15N~AHP_dom_ne$Date_mean)
ne_dom_lmtAHP_d13c = lm(tAHP_dom_ne$avg_d13C_org~tAHP_dom_ne$Date_mean)
ne_dom_lmtAHP_d15n = lm(tAHP_dom_ne$avg_d15N~tAHP_dom_ne$Date_mean)
ne_dom_lmentire_d13c = lm(entire_dom_ne$avg_d13C_org~entire_dom_ne$Date_mean)
ne_dom_lmentire_d15n = lm(entire_dom_ne$avg_d15N~entire_dom_ne$Date_mean)
ne_wild_lmAHP_d13c = lm(AHP_wild_ne$avg_d13C_org~AHP_wild_ne$Date_mean)
ne_wild_lmAHP_d15n = lm(AHP_wild_ne$avg_d15N~AHP_wild_ne$Date_mean)
ne_wild_lmtAHP_d13c = lm(tAHP_wild_ne$avg_d13C_org~tAHP_wild_ne$Date_mean)
ne_wild_lmtAHP_d15n = lm(tAHP_wild_ne$avg_d15N~tAHP_wild_ne$Date_mean)
ne_wild_lmentire_d13c = lm(entire_wild_ne$avg_d13C_org~entire_wild_ne$Date_mean)
ne_wild_lmentire_d15n = lm(entire_wild_ne$avg_d15N~entire_wild_ne$Date_mean)
e_lmAHP_d13c = lm(AHP_e$avg_d13C_org~AHP_e$Date_mean)
e_lmAHP_d15n = lm(AHP_e$avg_d15N~AHP_e$Date_mean)
e_lmtAHP_d13c = lm(tAHP_e$avg_d13C_org~tAHP_e$Date_mean)
e_lmtAHP_d15n = lm(tAHP_e$avg_d15N~tAHP_e$Date_mean)
e_lmentire_d13c = lm(entire_e$avg_d13C_org~entire_e$Date_mean)
e_lmentire_d15n = lm(entire_e$avg_d15N~entire_e$Date_mean)
e_dom_lmtAHP_d13c = lm(tAHP_dom_e$avg_d13C_inorg~tAHP_dom_e$Date_mean)
e_dom_lmentire_d13c = lm(entire_dom_e$avg_d13C_inorg~entire_dom_e$Date_mean)
e_wild_lmAHP_d13c = lm(AHP_wild_e$avg_d13C_inorg~AHP_wild_e$Date_mean)
e_wild_lmtAHP_d13c = lm(tAHP_wild_e$avg_d13C_inorg~tAHP_wild_e$Date_mean)
e_wild_lmentire_d13c = lm(entire_wild_e$avg_d13C_inorg~entire_wild_e$Date_mean)
s_lmAHP_d13c = lm(AHP_s$avg_d13C_org~AHP_s$Date_mean)
s_lmAHP_d15n = lm(AHP_s$avg_d15N~AHP_s$Date_mean)
s_lmtAHP_d13c = lm(tAHP_s$avg_d13C_org~tAHP_s$Date_mean)
s_lmtAHP_d15n = lm(tAHP_s$avg_d15N~tAHP_s$Date_mean)
s_lmentire_d13c = lm(entire_s$avg_d13C_org~entire_s$Date_mean)
s_lmentire_d15n = lm(entire_s$avg_d15N~entire_s$Date_mean)
s_dom_lmtAHP_d13c = lm(tAHP_dom_s$avg_d13C_org~tAHP_dom_s$Date_mean)
s_dom_lmtAHP_d15n = lm(tAHP_dom_s$avg_d15N~tAHP_dom_s$Date_mean)
s_dom_lmentire_d13c = lm(entire_dom_s$avg_d13C_org~entire_dom_s$Date_mean)
s_dom_lmentire_d15n = lm(entire_dom_s$avg_d15N~entire_dom_s$Date_mean)
s_wild_lmtAHP_d13c = lm(tAHP_wild_s$avg_d13C_org~tAHP_wild_s$Date_mean)
s_wild_lmtAHP_d15n = lm(tAHP_wild_s$avg_d15N~tAHP_wild_s$Date_mean)
s_wild_lmentire_d13c = lm(entire_wild_s$avg_d13C_org~entire_wild_s$Date_mean)
s_wild_lmentire_d15n = lm(entire_wild_s$avg_d15N~entire_wild_s$Date_mean)
# ################
#SPLIT BY REGION
pdf("[path].pdf")
par(mfrow=c(4,2))
plot(AHP_ne$Date_mean, AHP_ne$avg_d13C_org,col=AHP_ne$cluster9,main=paste("r^2: ",
     round(summary(ne_lmAHP_d13c)$r.squared,digits=5),"; pval: ", round(summary(ne_lmAHP_d13c)$coefficients[,4][2],digits = 4),sep=""),ylim=c(-30,0))
abline(ne_lmAHP_d13c,col="goldenrod3",lwd=4)
points(AHP_ne$Date_mean, AHP_ne$avg_d13C_org,col=AHP_ne$cluster9)
plot(AHP_ne$Date_mean, AHP_ne$avg_d15N,col=AHP_ne$cluster9,main=paste("r^2: ",
     round(summary(ne_lmAHP_d15n)$r.squared,digits=5),"; pval: ", round(summary(ne_lmAHP_d15n)$coefficients[,4][2],digits = 4),sep=""),ylim=c(0,30))
abline(ne_lmAHP_d15n,col="orange",lwd=4)
points(AHP_ne$Date_mean, AHP_ne$avg_d15N,col=AHP_ne$cluster9)
plot(tAHP_ne$Date_mean, tAHP_ne$avg_d13C_org,col=tAHP_ne$cluster9,main=paste("r^2: ",
     round(summary(ne_lmtAHP_d13c)$r.squared,digits=5),"; pval: ", round(summary(ne_lmtAHP_d13c)$coefficients[,4][2],digits = 4),sep=""),ylim=c(-30,0))
abline(ne_lmtAHP_d13c,col="goldenrod3",lwd=4)
points(tAHP_ne$Date_mean, tAHP_ne$avg_d13C_org,col=tAHP_ne$cluster9)
plot(tAHP_ne$Date_mean, tAHP_ne$avg_d15N,col=tAHP_ne$cluster9,main=paste("r^2: ",
     round(summary(ne_lmtAHP_d15n)$r.squared,digits=5),"; pval: ", round(summary(ne_lmtAHP_d15n)$coefficients[,4][2],digits = 4),sep=""),ylim=c(0,30))
abline(ne_lmtAHP_d15n,col="orange",lwd=4)
points(tAHP_ne$Date_mean, tAHP_ne$avg_d15N,col=tAHP_ne$cluster9)
dev.off()
#
pdf("[path].pdf")
par(mfrow=c(4,2))
plot(entire_ne$Date_mean, entire_ne$avg_d13C_org,col=entire_ne$cluster9,main=paste("r^2: ",
     round(summary(ne_lmentire_d13c)$r.squared,digits=5),"; pval: ", round(summary(ne_lmentire_d13c)$coefficients[,4][2],digits = 4),sep=""),ylim=c(-30,0))
abline(ne_lmentire_d13c,col="goldenrod3",lwd=4)
points(entire_ne$Date_mean, entire_ne$avg_d13C_org,col=entire_ne$cluster9)
plot(entire_ne$Date_mean, entire_ne$avg_d15N,col=entire_ne$cluster9,main=paste("r^2: ",
     round(summary(ne_lmentire_d15n)$r.squared,digits=5),"; pval: ", round(summary(ne_lmentire_d15n)$coefficients[,4][2],digits = 4),sep=""),ylim=c(0,30))
abline(ne_lmentire_d15n,col="orange",lwd=4)
points(entire_ne$Date_mean, entire_ne$avg_d15N,col=entire_ne$cluster9)
dev.off()
###########################
pdf("[path].pdf")
par(mfrow=c(4,2))
plot(AHP_e$Date_mean, AHP_e$avg_d13C_org,col=AHP_e$cluster9,main=paste("r^2: ",
     round(summary(e_lmAHP_d13c)$r.squared,digits=5),"; pval: ", round(summary(e_lmAHP_d13c)$coefficients[,4][2],digits =4),sep=""),ylim=c(-20,0))
abline(e_lmAHP_d13c,col="blue",lwd=4)
points(AHP_e$Date_mean, AHP_e$avg_d13C_org,col=AHP_e$cluster9)
plot(AHP_e$Date_mean, AHP_e$avg_d15N,col=AHP_e$cluster9,main=paste("r^2: ",
     round(summary(e_lmAHP_d15n)$r.squared,digits=5),"; pval: ", round(summary(e_lmAHP_d15n)$coefficients[,4][2],digits = 4),sep=""),ylim=c(0,20))
abline(e_lmAHP_d15n,col="dodgerblue",lwd=4)
points(AHP_e$Date_mean, AHP_e$avg_d15N,col=AHP_e$cluster9)
plot(tAHP_e$Date_mean, tAHP_e$avg_d13C_org,col=tAHP_e$cluster9,main=paste("r^2: ",
     round(summary(e_lmtAHP_d13c)$r.squared,digits=5),"; pval: ", round(summary(e_lmtAHP_d13c)$coefficients[,4][2],digits = 4),sep=""),ylim=c(-20,0))
abline(e_lmtAHP_d13c,col="blue",lwd=4)
points(tAHP_e$Date_mean, tAHP_e$avg_d13C_org,col=tAHP_e$cluster9)
plot(tAHP_e$Date_mean, tAHP_e$avg_d15N,col=tAHP_e$cluster9,main=paste("r^2: ",
     round(summary(e_lmtAHP_d15n)$r.squared,digits=5),"; pval: ", round(summary(e_lmtAHP_d15n)$coefficients[,4][2],digits = 4),sep=""),ylim=c(0,20))
abline(e_lmtAHP_d15n,col="dodgerblue",lwd=4)
points(tAHP_e$Date_mean, tAHP_e$avg_d15N,col=tAHP_e$cluster9)
dev.off()
#
pdf("[path].pdf")
par(mfrow=c(4,2))
plot(entire_e$Date_mean, entire_e$avg_d13C_org,col=entire_e$cluster9,main=paste("r^2: ",
     round(summary(e_lmentire_d13c)$r.squared,digits=5),"; pval: ", round(summary(e_lmentire_d13c)$coefficients[,4][2],digits = 4),sep=""),ylim=c(-20,0))
abline(e_lmentire_d13c,col="blue",lwd=4)
points(entire_e$Date_mean, entire_e$avg_d13C_org,col=entire_e$cluster9)
#
plot(entire_e$Date_mean, entire_e$avg_d15N,col=entire_e$cluster9,main=paste("r^2: ",
     round(summary(e_lmentire_d15n)$r.squared,digits=5),"; pval: ", round(summary(e_lmentire_d15n)$coefficients[,4][2],digits = 4),sep=""),ylim=c(0,20))
abline(e_lmentire_d15n,col="dodgerblue",lwd=4)
points(entire_e$Date_mean, entire_e$avg_d15N,col=entire_e$cluster9)
dev.off()
###############################################
pdf("[path].pdf")
par(mfrow=c(4,2))
plot(AHP_wild_e$Date_mean, AHP_wild_e$avg_d13C_inorg,col="blue",main=paste("r^2: ",
     round(summary(e_wild_lmAHP_d13c)$r.squared,digits=5),"; pval: ", round(summary(e_wild_lmAHP_d13c)$coefficients[,4][2],digits = 4),sep=""),ylim=c(-10,10))
abline(e_wild_lmAHP_d13c,col="blue",lwd=4)
plot(tAHP_wild_e$Date_mean, tAHP_wild_e$avg_d13C_inorg,col="white",main = "NA: inorg",ylim=c(-10,10))
plot(tAHP_wild_e$Date_mean, tAHP_wild_e$avg_d13C_inorg,col="blue",main=paste("r^2: ",
     round(summary(e_wild_lmtAHP_d13c)$r.squared,digits=5),"; pval: ", round(summary(e_wild_lmtAHP_d13c)$coefficients[,4][2],digits = 4),sep=""),ylim=c(-10,10))
abline(e_wild_lmtAHP_d13c,col="blue",lwd=4)
plot(tAHP_wild_e$Date_mean, tAHP_wild_e$avg_d13C_inorg,col="white",main = "NA: inorg",ylim=c(-10,10))
dev.off()
pdf("[path].pdf")
par(mfrow=c(4,2))
plot(entire_wild_e$Date_mean, entire_wild_e$avg_d13C_inorg,col="blue",main=paste("r^2: ",
     round(summary(e_wild_lmentire_d13c)$r.squared,digits=5),"; pval: ", round(summary(e_wild_lmentire_d13c)$coefficients[,4][2],digits = 4),sep=""),ylim=c(-10,10))
abline(e_wild_lmentire_d13c,col="blue",lwd=4)
plot(tAHP_wild_e$Date_mean, tAHP_wild_e$avg_d13C_inorg,col="white",main = "NA: inorg",ylim=c(-10,10))
dev.off()
###########################
pdf("[path].pdf")
par(mfrow=c(4,2))
plot(AHP_s$Date_mean, AHP_s$avg_d13C_org,col=AHP_s$cluster9,main=paste("r^2: ",
     round(summary(s_lmAHP_d13c)$r.squared,digits=5),"; pval: ", round(summary(s_lmAHP_d13c)$coefficients[,4][2],digits = 4),sep=""),ylim=c(-30,0))
abline(s_lmAHP_d13c,col="darkorchid",lwd=4)
points(AHP_s$Date_mean, AHP_s$avg_d13C_org,col=AHP_s$cluster9)
plot(AHP_s$Date_mean, AHP_s$avg_d15N,col=AHP_s$cluster9,main=paste("r^2: ",
     round(summary(s_lmAHP_d15n)$r.squared,digits=5),"; pval: ", round(summary(s_lmAHP_d15n)$coefficients[,4][2],digits = 4),sep=""),ylim=c(0,30))
abline(s_lmAHP_d15n,col="violet",lwd=4)
points(AHP_s$Date_mean, AHP_s$avg_d15N,col=AHP_s$cluster9)
plot(tAHP_s$Date_mean, tAHP_s$avg_d13C_org,col=tAHP_s$cluster9,main=paste("r^2: ",
     round(summary(s_lmtAHP_d13c)$r.squared,digits=5),"; pval: ", round(summary(s_lmtAHP_d13c)$coefficients[,4][2],digits = 4),sep=""),ylim=c(-30,0))
abline(s_lmtAHP_d13c,col="darkorchid",lwd=4)
points(tAHP_s$Date_mean, tAHP_s$avg_d13C_org,col=tAHP_s$cluster9)
plot(tAHP_s$Date_mean, tAHP_s$avg_d15N,col=tAHP_s$cluster9,main=paste("r^2: ",
     round(summary(s_lmtAHP_d15n)$r.squared,digits=5),"; pval: ", round(summary(s_lmtAHP_d15n)$coefficients[,4][2],digits = 4),sep=""),ylim=c(0,30))
abline(s_lmtAHP_d15n,col="violet",lwd=4)
points(tAHP_s$Date_mean, tAHP_s$avg_d15N,col=tAHP_s$cluster9)
dev.off()
#
pdf("[path].pdf")
par(mfrow=c(4,2))
plot(entire_s$Date_mean, entire_s$avg_d13C_org,col=entire_s$cluster9,main=paste("r^2: ",
     round(summary(s_lmentire_d13c)$r.squared,digits=5),"; pval: ", round(summary(s_lmentire_d13c)$coefficients[,4][2],digits = 4),sep=""),ylim=c(-30,0))
abline(s_lmentire_d13c,col="darkorchid",lwd=4)
points(entire_s$Date_mean, entire_s$avg_d13C_org,col=entire_s$cluster9)
plot(entire_s$Date_mean, entire_s$avg_d15N,col=entire_s$cluster9,main=paste("r^2: ",
     round(summary(s_lmentire_d15n)$r.squared,digits=5),"; pval: ", round(summary(s_lmentire_d15n)$coefficients[,4][2],digits = 4),sep=""),ylim=c(0,30))
abline(s_lmentire_d15n,col="violet",lwd=4)
points(entire_s$Date_mean, entire_s$avg_d15N,col=entire_s$cluster9)
dev.off()
summary(lm(AHP_ne$avg_d13C_org~AHP_ne$Date_mean))
```


```{r}

#FIGURE 1/3
dodgerblue = dom_corr[dom_corr$cluster8=="dodgerblue",]
cornsilk = dom_corr[dom_corr$cluster8=="cornsilk",]
forestgreen = dom_corr[dom_corr$cluster8=="forestgreen",]
firebrick = dom_corr[dom_corr$cluster8=="firebrick",]
orange = dom_corr[dom_corr$cluster8=="darkorange2",]
tan = dom_corr[dom_corr$cluster8=="tan",]
humans_corr_sub = humans_corr
redhuman = humans_corr_sub[humans_corr_sub$cluster9=="red",]
bluehuman = humans_corr_sub[humans_corr_sub$cluster9=="blue",]
yellowhuman = humans_corr_sub[humans_corr_sub$cluster9=="yellow",]
grayhuman = humans_corr_sub[humans_corr_sub$cluster9=="gray" | humans_corr_sub$cluster9=="black",]
greenhuman = humans_corr_sub[humans_corr_sub$cluster9=="green",]
orangehuman = humans_corr_sub[humans_corr_sub$cluster9=="orange",]
purplehuman = humans_corr_sub[humans_corr_sub$cluster9=="darkorchid",]
yellowhuman3 = humans_corr_sub[humans_corr_sub$cluster9=="yellow",] #aquatic-centred
bluehuman3 = humans_corr_sub[humans_corr_sub$cluster9=="blue" |
                               humans_corr_sub$cluster9=="red" |
                               humans_corr_sub$cluster9=="gray",] #C4-centred (pastoral)
greenhuman3 = humans_corr_sub[humans_corr_sub$cluster9=="green"|
                                humans_corr_sub$cluster9=="darkorchid"|
                                humans_corr_sub$cluster9=="orange",] #C3-centred (cult/forage)
redwild = wild_corr[wild_corr$Site %in% redhuman$Site,]
bluewild = wild_corr[wild_corr$Site %in% bluehuman$Site,]
yellowwild = wild_corr[wild_corr$Site %in% yellowhuman$Site & wild_corr$Taxon_Common_Name!="Camel",]
graywild = wild_corr[wild_corr$Site %in% grayhuman$Site,]
greenwild = wild_corr[wild_corr$Site %in% greenhuman$Site & wild_corr$Taxon_Common_Name!="Camel",]
orangewild = wild_corr[wild_corr$Site %in% orangehuman$Site,]
purplewild = wild_corr[wild_corr$Site %in% purplehuman$Site & wild_corr$Taxon_Common_Name!="Camel",]
bluewild3 = wild_corr[wild_corr$Site %in% bluehuman3$Site,]
yellowwild3 = wild_corr[wild_corr$Site %in% yellowhuman3$Site,]
greenwild3 = wild_corr[wild_corr$Site %in% greenhuman3$Site,]
reddom = dom_corr[dom_corr$Site %in% redhuman$Site,]
bluedom = dom_corr[dom_corr$Site %in% bluehuman$Site,]
yellowdom = dom_corr[dom_corr$Site %in% yellowhuman$Site,]
graydom = dom_corr[dom_corr$Site %in% grayhuman$Site,]
greendom = dom_corr[dom_corr$Site %in% greenhuman$Site,]
orangedom = dom_corr[dom_corr$Site %in% orangehuman$Site,]
purpledom = dom_corr[dom_corr$Site %in% purplehuman$Site,]
#
pdf("[path].pdf")
par(mfrow=c(2,2))
library(car)
plot(humans_corr_sub$avg_d15N, humans_corr_sub$avg_d13C_org, pch = 16, col="gray40", ylim=c(2,25),xlim=c(-27,-2.5), cex=1, main="human diets")
points(redhuman$avg_d13C_org, redhuman$avg_d15N, pch = 16, col="red",cex=1)
points(bluehuman$avg_d13C_org, bluehuman$avg_d15N, pch = 16, col="blue",cex=1)
points(yellowhuman$avg_d13C_org, yellowhuman$avg_d15N, pch = 16, col="yellow",cex=1)
points(grayhuman$avg_d13C_org, grayhuman$avg_d15N, pch = 16, col="darkgray",cex=1)
points(greenhuman$avg_d13C_org, greenhuman$avg_d15N, pch = 16, col="green",cex=1)
points(orangehuman$avg_d13C_org, orangehuman$avg_d15N, pch = 16, col="orange3",cex=1)
points(purplehuman$avg_d13C_org, purplehuman$avg_d15N, pch = 16, col="violet",cex=1)
for(i in c("red","blue","yellow","gray","green","orange","purple")){
  if(i == "red"){colour = "firebrick3"; group = redhuman}
  if(i == "blue"){colour = "darkblue"; group = bluehuman}
  if(i == "yellow"){colour = "yellow3"; group = yellowhuman}
  if(i == "gray"){colour = "gray60"; group = grayhuman}
  if(i == "green"){colour = "green2"; group = greenhuman}
  if(i == "orange"){colour = "orange"; group = orangehuman}
  if(i == "purple"){colour = "darkorchid"; group = purplehuman}
dataEllipse(group$avg_d13C_org, group$avg_d15N, col=colour,
            levels=c(0.9), center.pch=19, center.cex=3, robust=FALSE,
            add=TRUE,plot.points = FALSE) } #ellipse.label = "HGFs"
dev.off()
#############
pdf("[path].pdf")
par(mfrow=c(2,2))
plot(dom_corr$avg_d13C_org, dom_corr$avg_d15N, pch = 16, col="gray40", ylim=c(2,25),xlim=c(-27,-2.5),cex=1,main="livelihoods")
points(dodgerblue$avg_d13C_org, dodgerblue$avg_d15N, pch = 16, col="dodgerblue",cex=1)
points(cornsilk$avg_d13C_org, cornsilk$avg_d15N, pch = 16, col="cornsilk2",cex=1)
points(forestgreen$avg_d13C_org, forestgreen$avg_d15N, pch = 16, col="forestgreen",cex=1)
# points(darkgray$avg_d13C_org, darkgray$avg_d15N, pch = 16, col="gray50",cex=1)
points(firebrick$avg_d13C_org, firebrick$avg_d15N, pch = 16, col="firebrick",cex=1)
points(orange$avg_d13C_org, orange$avg_d15N, pch = 16, col="orange",cex=1)
points(tan$avg_d13C_org, tan$avg_d15N, pch = 16, col="tan",cex=1)
for(i in c("dodgerblue","cornsilk","forestgreen","firebrick","orange","tan")){
  if(i == "dodgerblue"){colour = "dodgerblue"; group = dodgerblue}
  if(i == "cornsilk"){colour = "cornsilk3"; group = cornsilk}
  if(i == "forestgreen"){colour = "darkgreen"; group = forestgreen}
  if(i == "firebrick"){colour = "firebrick4"; group = firebrick}
  # if(i == "orange"){colour = "darkorange2"; group = orange}
  if(i == "tan"){colour = "tan"; group = tan}
dataEllipse(group$avg_d13C_org, group$avg_d15N, col=colour,
            levels=c(0.9), center.pch=18, center.cex=3, robust=FALSE,
            add=TRUE,plot.points = FALSE) } #ellipse.label = "HGFs"
dev.off()
#
bovid = wild_corr[wild_corr$Family=="Bovidae",]
w_elephant = wild_corr[wild_corr$Taxon_Common_Name == "African elephant",]
w_smBovidGraze = wild_corr[wild_corr$Taxon_Common_Name == "Dik dik" | 
                       wild_corr$Taxon_Common_Name == "Common duiker",]
w_smBovidBrowse = wild_corr[wild_corr$Taxon_Common_Name == "Steenbok/Grysbok" | 
                       wild_corr$Taxon_Common_Name == "Steenbok"|
                        wild_corr$Taxon_Common_Name == "Gazelle",]
w_lgBovidBrowse = wild_corr[wild_corr$Taxon_Common_Name == "Common eland" | 
                               wild_corr$Taxon_Common_Name == "Red hartebeest",]
w_lgBovidGraze = wild_corr[wild_corr$Taxon_Common_Name == "Buffalo" | 
                               wild_corr$Taxon_Common_Name == "Common tsessebe",]
w_hippo = wild_corr[wild_corr$Taxon_Common_Name == "Hippopotamus",]
w_seal = wild_corr[wild_corr$Taxon_Common_Name == "Cape fur seal",]
w_croc = wild_corr[wild_corr$Taxon_Common_Name == "Nile crocodile"|
                   wild_corr$Taxon_Common_Name == "Crocodile",]
w_hare = wild_corr[wild_corr$Taxon_Common_Name == "Hare",]
w_francolin = wild_corr[wild_corr$Taxon_Common_Name == "Francolin",]
w_terrpred = wild_corr[wild_corr$Category == "terrestrial predator",]
#
pdf("[path].pdf")
par(mfrow=c(2,2))
library(car)
plot(w_elephant$avg_d13C_org, w_elephant$avg_d15N, pch=25, col="gray40", bg="gray40",
     ylim=c(2,25),xlim=c(-27,-2.5),cex=1,main="wild")
points(w_smBovidBrowse$avg_d13C_org, w_smBovidBrowse$avg_d15N, pch=25,
       col="lightblue",bg="lightblue",cex=1)
points(w_smBovidGraze$avg_d13C_org, w_smBovidGraze$avg_d15N, pch=25,
       col="forestgreen",bg="forestgreen",cex=1)
points(w_lgBovidBrowse$avg_d13C_org, w_lgBovidBrowse$avg_d15N, pch=25,
       col="darkorange",bg="darkorange",cex=1)
points(w_lgBovidGraze$avg_d13C_org, w_lgBovidGraze$avg_d15N, pch=25, 
       col="gold",bg = "gold",cex=1)
points(w_hippo$avg_d13C_org, w_hippo$avg_d15N, pch=25, col="darkorchid",
       bg="darkorchid",cex=1)
points(w_seal$avg_d13C_org, w_seal$avg_d15N, pch=25, col="blue",bg="blue",
       cex=1)
points(w_croc$avg_d13C_org, w_croc$avg_d15N, pch=25, col="green",bg="green",
       cex=1)
points(w_terrpred$avg_d13C_org, w_terrpred$avg_d15N, pch=25, col="hotpink",bg="hotpink",cex=1)
points(w_hare$avg_d13C_org, w_hare$avg_d15N, pch=25, col="brown",bg="brown",cex=1)
points(w_francolin$avg_d13C_org, w_francolin$avg_d15N, pch=25, col="tan",
       bg="tan",cex=1)
points(w_smBovidBrowse$avg_d13C_org, w_smBovidBrowse$avg_d15N, pch=25,
       col="lightblue",bg="lightblue",cex=1)
points(w_smBovidGraze$avg_d13C_org, w_smBovidGraze$avg_d15N, pch=25,
       col="forestgreen",bg="forestgreen",cex=1)
points(w_lgBovidBrowse$avg_d13C_org, w_lgBovidBrowse$avg_d15N, pch=25,
       col="darkorange",bg="darkorange",cex=1)
points(w_lgBovidGraze$avg_d13C_org, w_lgBovidGraze$avg_d15N, pch=25, 
       col="gold",bg = "gold",cex=1)
points(w_hippo$avg_d13C_org, w_hippo$avg_d15N, pch=25, col="darkorchid",
       bg="darkorchid",cex=1)
points(w_seal$avg_d13C_org, w_seal$avg_d15N, pch=25, col="dodgerblue",bg="dodgerblue",
       cex=1)
points(w_croc$avg_d13C_org, w_croc$avg_d15N, pch=25, col="green",bg="green",
       cex=1)
points(w_hare$avg_d13C_org, w_hare$avg_d15N, pch=25, col="brown",bg="brown",cex=1)
points(w_francolin$avg_d13C_org, w_francolin$avg_d15N, pch=25, col="tan",
       bg="tan",cex=1)
dev.off()
#
pdf("[path].pdf")
par(mfrow=c(2,2))
plot(dom_corr$bioclim15, dom_corr$elev, pch = 16, col="black", ylim=c(0,2800),xlim=c(-1,180),cex=1,main="elev. by precip season.")
points(dodgerblue$bioclim15, dodgerblue$elev, pch = 16, col="black",cex=4.25)
points(dodgerblue$bioclim15, dodgerblue$elev, pch = 16, col="dodgerblue",cex=4)
points(cornsilk$bioclim15, cornsilk$elev, pch = 16, col="cornsilk2",cex=2.75)
points(forestgreen$bioclim15, forestgreen$elev, pch = 16, col="forestgreen",cex=2.25)
points(firebrick$bioclim15, firebrick$elev, pch = 16, col="firebrick",cex=1.75)
points(orange$bioclim15, orange$elev, pch = 16, col="orange",cex=1)
dev.off()
#
pdf("[path].pdf")
par(mfrow=c(2,2))
plot(dom_corr$bioclim1, dom_corr$bioclim12, pch = 16, col="black", ylim=c(-15,600),xlim=c(160,285),cex=1,main="temp by precip.")
points(dodgerblue$bioclim1, dodgerblue$bioclim12, pch = 16, col="black",cex=4.25)
points(dodgerblue$bioclim1, dodgerblue$bioclim12, pch = 16, col="dodgerblue",cex=4)
points(cornsilk$bioclim1, cornsilk$bioclim12, pch = 16, col="cornsilk2",cex=2.75)
points(forestgreen$bioclim1, forestgreen$bioclim12, pch = 16, col="forestgreen",cex=2.25)
points(firebrick$bioclim1, firebrick$bioclim12, pch = 16, col="firebrick",cex=1.75)
points(orange$bioclim1, orange$bioclim12, pch = 16, col="orange",cex=1)
dev.off()
#
pdf("[path].pdf")
par(mfrow=c(2,2))
plot(dom_corr$avg_d13C_org, dom_corr$avg_d15N, pch = 16, col="black", ylim=c(-3.5,21.5),xlim=c(-34,-3.5),cex=1,main="13c by 15N.")
points(dodgerblue$avg_d13C_org, dodgerblue$avg_d15N, pch = 16, col="black",cex=4.25)
points(dodgerblue$avg_d13C_org, dodgerblue$avg_d15N, pch = 16, col="dodgerblue",cex=4)
# points(darkgray$avg_d13C_org, darkgray$avg_d15N, pch = 16, col="darkgray",cex=3.25)
points(cornsilk$avg_d13C_org, cornsilk$avg_d15N, pch = 16, col="cornsilk2",cex=2.75)
points(forestgreen$avg_d13C_org, forestgreen$avg_d15N, pch = 16, col="forestgreen",cex=2.25)
points(firebrick$avg_d13C_org, firebrick$avg_d15N, pch = 16, col="firebrick",cex=1.75)
points(orange$avg_d13C_org, orange$avg_d15N, pch = 16, col="orange",cex=1)
dev.off()
#
animalbased = bluehuman3
plantbased = greenhuman3
fishbased = yellowhuman3
#
pdf("[path]0_FigG_diet-livelihood_comb_new.pdf")
par(mfrow=c(2,2))
library(car)
plot(humans_corr$avg_d15N, humans_corr$avg_d13C_org, pch = 16, col="black", ylim=c(2,25),xlim=c(-27,-2.5), cex=1, main="human diets")
points(w_elephant$avg_d13C_org, w_elephant$avg_d15N, pch=25, col="gray30", bg="gray30",cex=0.7)
points(w_smBovidBrowse$avg_d13C_org, w_smBovidBrowse$avg_d15N, pch=25,
       col="gray30",bg="gray30",cex=0.7)
points(w_smBovidGraze$avg_d13C_org, w_smBovidGraze$avg_d15N, pch=25,
       col="gray30",bg="gray30",cex=0.7)
points(w_lgBovidBrowse$avg_d13C_org, w_lgBovidBrowse$avg_d15N, pch=25,
       col="gray30",bg="gray30",cex=0.7)
points(w_lgBovidGraze$avg_d13C_org, w_lgBovidGraze$avg_d15N, pch=25, 
       col="gray30",bg = "gray30",cex=0.7)
points(w_hippo$avg_d13C_org, w_hippo$avg_d15N, pch=25, col="gray30",
       bg="gray30",cex=0.7)
points(w_seal$avg_d13C_org, w_seal$avg_d15N, pch=25, col="gray30",bg="gray30",
       cex=0.7)
points(w_croc$avg_d13C_org, w_croc$avg_d15N, pch=25, col="gray30",bg="gray30",
       cex=0.7)
points(w_terrpred$avg_d13C_org, w_terrpred$avg_d15N, pch=25, col="gray30",bg="gray30",cex=0.7)
points(w_hare$avg_d13C_org, w_hare$avg_d15N, pch=25, col="gray30",bg="gray30",cex=0.7)
points(w_francolin$avg_d13C_org, w_francolin$avg_d15N, pch=25, col="gray30",
       bg="gray30",cex=0.7)
points(w_smBovidBrowse$avg_d13C_org, w_smBovidBrowse$avg_d15N, pch=25,
       col="gray30",bg="gray30",cex=0.7)
points(w_smBovidGraze$avg_d13C_org, w_smBovidGraze$avg_d15N, pch=25,
       col="gray30",bg="gray30",cex=0.7)
points(w_lgBovidBrowse$avg_d13C_org, w_lgBovidBrowse$avg_d15N, pch=25,
       col="gray30",bg="gray30",cex=0.7)
points(w_lgBovidGraze$avg_d13C_org, w_lgBovidGraze$avg_d15N, pch=25, 
       col="gray30",bg = "gray30",cex=0.7)
points(w_hippo$avg_d13C_org, w_hippo$avg_d15N, pch=25, col="gray30",
       bg="gray30",cex=0.7)
points(w_seal$avg_d13C_org, w_seal$avg_d15N, pch=25, col="gray30",bg="gray30",
       cex=0.7)
points(w_croc$avg_d13C_org, w_croc$avg_d15N, pch=25, col="gray30",bg="gray30",
       cex=0.7)
points(w_hare$avg_d13C_org, w_hare$avg_d15N, pch=25, col="gray30",bg="gray30",cex=0.7)
points(w_francolin$avg_d13C_org, w_francolin$avg_d15N, pch=25, col="gray30",
       bg="gray30",cex=0.7)
for(i in c("red","blue","yellow","gray","green","orange","purple")){
  if(i == "red"){colour = "red"; group = redhuman}
  if(i == "yellow"){colour = "yellow2"; group = yellowhuman}
  if(i == "gray"){colour = "gray60"; group = grayhuman}
  if(i == "green"){colour = "green2"; group = greenhuman}
  if(i == "orange"){colour = "orange"; group = orangehuman}
  if(i == "purple"){colour = "darkorchid"; group = purplehuman}
  if(i == "blue"){colour = "blue"; group = bluehuman}
dataEllipse(group$avg_d13C_org, group$avg_d15N, col=colour,
            levels=c(0), center.pch=19, center.cex=4, robust=FALSE,
            add=TRUE,plot.points = FALSE) } #ellipse.label = "HGFs"
for(i in c("dodgerblue","cornsilk","forestgreen","firebrick","orange","tan")){
  if(i == "dodgerblue"){colour = "dodgerblue"; group = dodgerblue}
  if(i == "cornsilk"){colour = "cornsilk"; group = cornsilk}
  if(i == "forestgreen"){colour = "darkgreen"; group = forestgreen}
  # if(i == "darkgray"){colour = "gray30"; group = darkgray}
  if(i == "firebrick"){colour = "firebrick"; group = firebrick}
  if(i == "orange"){colour = "darkorange2"; group = orange}
  if(i == "tan"){colour = "tan"; group = tan}
dataEllipse(group$avg_d13C_org, group$avg_d15N, col=colour,
            levels=c(0), center.pch=18, center.cex=3, robust=FALSE,
            add=TRUE,plot.points = FALSE) } #ellipse.label = "HGFs"
for(i in c("blue")){
  if(i == "blue"){colour = "blue"; group = bluehuman}
dataEllipse(group$avg_d13C_org, group$avg_d15N, col=colour,
            levels=c(0), center.pch=19, center.cex=3, robust=FALSE,
            add=TRUE,plot.points = FALSE) } #ellipse.label = "HGFs"
for(i in c("animalbased","plantbased","fishbased")){
  if(i == "animalbased"){colour = "#4e63f2"; group = animalbased}
  if(i == "plantbased"){colour = "green3"; group = plantbased}
  if(i == "fishbased"){colour = "yellow2"; group = fishbased}
dataEllipse(group$avg_d13C_org, group$avg_d15N, col=colour,
            levels=c(0.98), lwd =3, center.cex=0, robust=FALSE,
            add=TRUE,plot.points = FALSE) } #ellipse.label = "HGFs"
dev.off()
```


```{r}

#HERD COMPOSITION
Caprine = list()
Cattle = list()
Horse = list()
Donkey = list()
Camel = list()
Chicken = list()
Pig = list()
Dog = list()
CaprinePerc = vector()
CattlePerc = vector()
HorsePerc = vector()
DonkeyPerc = vector()
CamelPerc = vector()
ChickenPerc = vector()
PigPerc = vector()
DogPerc = vector()
sub_set = dom_corr_sub
sub_set$cluster7[sub_set$cluster7 == "darkorange3"]<-"orange"
unique(sub_set$cluster7)
colour = c("dodgerblue","darkgray","cornsilk","forestgreen","orange","firebrick","tan","dodgerblue","forestgreen")
for(i in 1:7){
group = colour[i]
Caprine[[i]]<-sub_set[sub_set$cluster7==group,]
Caprine[[i]]<-Caprine[[i]][Caprine[[i]]$Taxon_Common_Name=="Sheep/Goat" |
                             Caprine[[i]]$Taxon_Common_Name=="Sheep/goat" |
                             Caprine[[i]]$Taxon_Common_Name=="Sheep" |
                             Caprine[[i]]$Taxon_Common_Name=="Goat",]
Cattle[[i]]<-sub_set[sub_set$cluster7==group,]
Cattle[[i]]<-Cattle[[i]][Cattle[[i]]$Taxon_Common_Name=="Cattle",]
Horse[[i]]<-sub_set[sub_set$cluster7==group,]
Horse[[i]]<-Horse[[i]][Horse[[i]]$Taxon_Common_Name=="Horse",]
Donkey[[i]]<-sub_set[sub_set$cluster7==group,]
Donkey[[i]]<-Donkey[[i]][Donkey[[i]]$Taxon_Common_Name=="Donkey",]
Camel[[i]]<-sub_set[sub_set$cluster7==group,]
Camel[[i]]<-Camel[[i]][Camel[[i]]$Taxon_Common_Name=="Camel",]
Chicken[[i]]<-sub_set[sub_set$cluster7==group,]
Chicken[[i]]<-Chicken[[i]][Chicken[[i]]$Taxon_Common_Name=="Chicken",]
Pig[[i]]<-sub_set[sub_set$cluster7==group,]
Pig[[i]]<-Pig[[i]][Pig[[i]]$Taxon_Common_Name=="Pig",]
Dog[[i]]<-sub_set[sub_set$cluster7==group,]
Dog[[i]]<-Dog[[i]][Dog[[i]]$Taxon_Common_Name=="Dog",]}

for(i in 8:9){
group = colour[i]
Caprine[[i]]<-sub_set[sub_set$C3C4split==group,]
Caprine[[i]]<-Caprine[[i]][Caprine[[i]]$Taxon_Common_Name=="Sheep/Goat" |
                             Caprine[[i]]$Taxon_Common_Name=="Sheep/goat" |
                             Caprine[[i]]$Taxon_Common_Name=="Sheep" |
                             Caprine[[i]]$Taxon_Common_Name=="Goat",]
Cattle[[i]]<-sub_set[sub_set$C3C4split==group,]
Cattle[[i]]<-Cattle[[i]][Cattle[[i]]$Taxon_Common_Name=="Cattle",]
Horse[[i]]<-sub_set[sub_set$C3C4split==group,]
Horse[[i]]<-Horse[[i]][Horse[[i]]$Taxon_Common_Name=="Horse",]
Donkey[[i]]<-sub_set[sub_set$C3C4split==group,]
Donkey[[i]]<-Donkey[[i]][Donkey[[i]]$Taxon_Common_Name=="Donkey",]
Camel[[i]]<-sub_set[sub_set$C3C4split==group,]
Camel[[i]]<-Camel[[i]][Camel[[i]]$Taxon_Common_Name=="Camel",]
Chicken[[i]]<-sub_set[sub_set$C3C4split==group,]
Chicken[[i]]<-Chicken[[i]][Chicken[[i]]$Taxon_Common_Name=="Chicken",]
Pig[[i]]<-sub_set[sub_set$C3C4split==group,]
Pig[[i]]<-Pig[[i]][Pig[[i]]$Taxon_Common_Name=="Pig",]
Dog[[i]]<-sub_set[sub_set$C3C4split==group,]
Dog[[i]]<-Dog[[i]][Dog[[i]]$Taxon_Common_Name=="Dog",]}
########
for(i in 1:7){
group = colour[i]
CaprinePerc[i] <- round(nrow(Caprine[[i]])/nrow(sub_set[sub_set$cluster7 == group & 
                      sub_set$Family == "Bovidae",]),digits=2)*100
CattlePerc[i] <- round(nrow(Cattle[[i]])/nrow(sub_set[sub_set$cluster7 == group & 
                      sub_set$Family == "Bovidae",]),digits=2)*100
HorsePerc[i] <- round(nrow(Horse[[i]])/nrow(sub_set[sub_set$cluster7 == group,]),digits=2)*100
DonkeyPerc[i] <- round(nrow(Donkey[[i]])/nrow(sub_set[sub_set$cluster7 == group,]),digits=2)*100
CamelPerc[i] <- round(nrow(Camel[[i]])/nrow(sub_set[sub_set$cluster7 == group,]),digits=2)*100
ChickenPerc[i] <- round(nrow(Chicken[[i]])/nrow(sub_set[sub_set$cluster7 == group,]),digits=2)*100
PigPerc[i] <- round(nrow(Pig[[i]])/nrow(sub_set[sub_set$cluster7 == group,]),digits=2)*100
DogPerc[i] <- round(nrow(Dog[[i]])/nrow(sub_set[sub_set$cluster7 == group,]),digits=2)*100}
for(i in 8:9){
group = colour[i]
CaprinePerc[i] <- round(nrow(Caprine[[i]])/nrow(sub_set[sub_set$C3C4split == group & 
                      sub_set$Family == "Bovidae",]),digits=2)*100
CattlePerc[i] <- round(nrow(Cattle[[i]])/nrow(sub_set[sub_set$C3C4split == group & 
                      sub_set$Family == "Bovidae",]),digits=2)*100
HorsePerc[i] <- round(nrow(Horse[[i]])/nrow(sub_set[sub_set$C3C4split == group,]),digits=2)*100
DonkeyPerc[i] <- round(nrow(Donkey[[i]])/nrow(sub_set[sub_set$C3C4split == group,]),digits=2)*100
CamelPerc[i] <- round(nrow(Camel[[i]])/nrow(sub_set[sub_set$C3C4split == group,]),digits=2)*100
ChickenPerc[i] <- round(nrow(Chicken[[i]])/nrow(sub_set[sub_set$C3C4split == group,]),digits=2)*100
PigPerc[i] <- round(nrow(Pig[[i]])/nrow(sub_set[sub_set$C3C4split == group,]),digits=2)*100
DogPerc[i] <- round(nrow(Dog[[i]])/nrow(sub_set[sub_set$C3C4split == group,]),digits=2)*100}
#
combComp<-data.frame(CattlePerc,CaprinePerc,DonkeyPerc,CamelPerc,HorsePerc,ChickenPerc,PigPerc,DogPerc)
row.names(combComp)[1:7]<-colour[1:7]
row.names(combComp)[8:9]<-c("Alldodgerblue","Allforestgreen")
write.csv(combComp,file="[path]combComp.csv")
hi <- -11.5
hi2 <- hi+( -0.004*(2007-1860))
hi2
#
dodgerblueAll7 = sub_set[sub_set$cluster7=="dodgerblue",]
cornsilkAll7 = sub_set[sub_set$cluster7=="cornsilk",]
darkgrayAll7 = sub_set[sub_set$cluster7=="darkgray",]
forestgreenAll7 = sub_set[sub_set$cluster7=="forestgreen",]
purpleAll7 = sub_set[sub_set$cluster7=="purple",]
orangeAll7 = sub_set[sub_set$cluster7=="orange",]
firebrickAll7 = sub_set[sub_set$cluster7=="firebrick",]
nrow(yellow_humans)+nrow(yellow_humenamel)
nrow(green_humans)+nrow(green_humenamel)
nrow(blue_humans)+nrow(blue_humenamel)
#
yellow_sites = unique(rbind(yellow_humans[,c("Latitude","Longitude","Site")],yellow_humenamel[,c("Latitude","Longitude","Site")]))
blue_sites = unique(rbind(blue_humans[,c("Latitude","Longitude","Site")],blue_humenamel[,c("Latitude","Longitude","Site")]))
green_sites = unique(rbind(green_humans[,c("Latitude","Longitude","Site")],green_humenamel[,c("Latitude","Longitude","Site")]))
```


```{r}
#Figure 2 CoV (variability)

#HUMANS CV
clust1 = humans_corr[ humans_corr$cluster9=="blue",]
clust2 = humans_corr[ humans_corr$cluster9=="green",]
clust3 = humans_corr[ humans_corr$cluster9=="yellow",]
clust4 = humans_corr[ humans_corr$cluster9=="darkorchid",]
clust5 = humans_corr[ humans_corr$cluster9=="orange",]
clust6 = humans_corr[ humans_corr$cluster9=="red",]
clust7 = humans_corr[ humans_corr$cluster9=="gray",]
pdf("[path].pdf")
par(mfrow=c(2,2))
plot(cv(clust1$avg_d13C_org),cv(clust1$avg_d15N),pch=17,cex=5,col=clust1$cluster9,xlim=c(1.8,26),ylim=c(5,18))
points(cv(clust2$avg_d13C_org),cv(clust2$avg_d15N),pch=17,cex=5,col=clust2$cluster9)
points(cv(clust3$avg_d13C_org),cv(clust3$avg_d15N),pch=17,cex=5,col=clust3$cluster9)
points(cv(clust4$avg_d13C_org),cv(clust4$avg_d15N),pch=17,cex=5,col=clust4$cluster9)
points(cv(clust5$avg_d13C_org),cv(clust5$avg_d15N),pch=17,cex=5,col=clust5$cluster9)
points(cv(clust6$avg_d13C_org),cv(clust6$avg_d15N),pch=17,cex=5,col=clust6$cluster9)
points(cv(clust7$avg_d13C_org),cv(clust7$avg_d15N),pch=17,cex=5,col=clust7$cluster9)
points(cv(clust1$avg_d13C_org),cv(clust1$avg_d15N),pch=17,cex=5,col=clust1$cluster9)
dev.off()
###########################################
#DOMESTIC CV
dom_corr_sub[dom_corr_sub=="orange"]<-"darkorange2"
clust1 = dom_corr_sub[ dom_corr_sub$cluster9=="dodgerblue",]
clust2 = dom_corr_sub[ dom_corr_sub$cluster9=="forestgreen",]
clust3 = dom_corr_sub[ dom_corr_sub$cluster9=="firebrick",]
clust5 = dom_corr_sub[ dom_corr_sub$cluster9=="darkorange2",]
clust6 = dom_corr_sub[ dom_corr_sub$cluster9=="cornsilk",]
clust8 = dom_corr_sub[ dom_corr_sub$cluster9=="tan",]
pdf("[path].pdf")
par(mfrow=c(2,2))
plot(cv(clust1$avg_d13C_org),cv(clust1$avg_d15N),pch=17,cex=5,col=clust1$cluster9
     ,xlim=c(3,19),ylim=c(5,31))
points(cv(clust2$avg_d13C_org),cv(clust2$avg_d15N),pch=17,cex=5,col=clust2$cluster9)
points(cv(clust3$avg_d13C_org),cv(clust3$avg_d15N),pch=17,cex=5,col=clust3$cluster9)
points(cv(clust5$avg_d13C_org),cv(clust5$avg_d15N),pch=17,cex=5,col=clust5$cluster9)
points(cv(clust6$avg_d13C_org),cv(clust6$avg_d15N),pch=17,cex=5,col=clust6$cluster9)
points(cv(clust8$avg_d13C_org),cv(clust8$avg_d15N),pch=17,cex=5,col=clust8$cluster9)
points(cv(clust1$avg_d13C_org),cv(clust1$avg_d15N),pch=17,cex=5,col=clust1$cluster9)
dev.off()
```


```{r}
#TABLE S3 - site-based temporal trends

#NORTHEAST SITE BREAKDOWN
site_select_AHP = list() 
site_select_tAHP = list() 
lmsite_15N_AHP = list() 
lmsite_15N_tAHP = list() 
lmsite_13C_AHP = list() 
lmsite_13C_tAHP = list()
for(site in c("Kellis","Kerma","Gebelein","Unspecified Egypt")){
  site_select_AHP[[site]] = all_h_ne[all_h_ne$Site==site & 
                               all_h_ne$Date_mean <= -1500,]
  site_select_tAHP[[site]] = all_h_ne[all_h_ne$Site==site & 
                               all_h_ne$Date_mean > -1500,]}
north_mix = all_h_ne[all_h_ne$Site=="Unspecified Egypt" |
                       all_h_ne$Site=="Gebelein" | 
                       all_h_ne$Site=="Kerma" | 
                       all_h_ne$Site=="Kellis",] #wadi halfa removed
site_select_AHP[["northSiteMix"]] = north_mix[north_mix$Date_mean <= -1500,]
site_select_tAHP[["northSiteMix"]] = north_mix[north_mix$Date_mean > -1500,]
for(site in c("Kellis","Kerma","Gebelein","Unspecified Egypt", "northSiteMix")){
if(nrow(site_select_tAHP[[site]]) > 1 ){
  lmsite_15N_tAHP[[site]] <- lm(site_select_tAHP[[site]]$avg_d15N ~
                             site_select_tAHP[[site]]$Date_mean)
  lmsite_13C_tAHP[[site]] <- lm(site_select_tAHP[[site]]$avg_d13C_org ~
                             site_select_tAHP[[site]]$Date_mean)}else{
                             lmsite_15N_tAHP[[site]]=NA
                             lmsite_13C_tAHP[[site]]=NA}
if( nrow(site_select_AHP[[site]]) > 1 ){
  lmsite_15N_AHP[[site]] <- lm(site_select_AHP[[site]]$avg_d15N ~
                             site_select_AHP[[site]]$Date_mean)
  lmsite_13C_AHP[[site]] <- lm(site_select_AHP[[site]]$avg_d13C_org ~
                             site_select_AHP[[site]]$Date_mean)}else{
                             lmsite_15N_AHP[[site]]=NA
                             lmsite_13C_AHP[[site]]=NA}}
site = c("Kellis","Kerma","Gebelein","Unspecified Egypt","northSiteMix")
region=c("Northeast","Northeast","Northeast","Northeast","Northeast")
pval_15N_AHP=c()
pval_15N_tAHP=c()
pval_13C_AHP=c()
pval_13C_tAHP=c()
slope_15N_AHP=c()
slope_15N_tAHP=c()
slope_13C_AHP=c()
slope_13C_tAHP=c()
for(site in c("Kellis","Kerma","Gebelein","Unspecified Egypt", "northSiteMix")){
if(nrow(site_select_AHP[[site]]) > 1 ){
pval_15N_AHP[site] = 
  round(summary(lmsite_15N_AHP[[site]])$coefficients[,4][2],digits = 5)
pval_13C_AHP[site] = 
  round(summary(lmsite_13C_AHP[[site]])$coefficients[,4][2],digits = 5)
slope_15N_AHP[site]=
  round(lmsite_15N_AHP[[site]]$coefficients[2],digits = 5)
slope_13C_AHP[site]=
  round(lmsite_13C_AHP[[site]]$coefficients[2],digits = 5)}else{
  pval_15N_AHP[site] = NA
  pval_13C_AHP[site] = NA
  slope_15N_AHP[site]= NA
  slope_13C_AHP[site]= NA}
if(nrow(site_select_tAHP[[site]]) > 1 ){
pval_15N_tAHP[site] = 
  round(summary(lmsite_15N_tAHP[[site]])$coefficients[,4][2],digits = 5)
pval_13C_tAHP[site] = 
  round(summary(lmsite_13C_tAHP[[site]])$coefficients[,4][2],digits = 5)
slope_15N_tAHP[site]=
  round(lmsite_15N_tAHP[[site]]$coefficients[2],digits = 5)
slope_13C_tAHP[site]=
  round(lmsite_13C_tAHP[[site]]$coefficients[2],digits = 5)}else{
  pval_15N_tAHP[site] = NA
  pval_13C_tAHP[site] = NA
  slope_15N_tAHP[site]= NA
  slope_13C_tAHP[site]=NA}}
site = c("Kellis","Kerma","Gebelein","Unspecified Egypt","northSiteMix")
pre_AHP_NE <- data.frame(site, region, pval_13C_AHP, slope_13C_AHP, pval_15N_AHP, slope_15N_AHP)
pre_AHP_NE$timePeriod = "AHP"
colnames(pre_AHP_NE)<-c("site","region","pval_13C","slope_13C","pval_15N","slope_15N","timePeriod")
pre_tAHP_NE <- data.frame(site, region, pval_13C_tAHP, slope_13C_tAHP, pval_15N_tAHP, slope_15N_tAHP)
pre_tAHP_NE$timePeriod = "postAHP"
colnames(pre_tAHP_NE)<-c("site","region","pval_13C","slope_13C","pval_15N","slope_15N","timePeriod")
north<-rbind(pre_AHP_NE,pre_tAHP_NE)
row.names(north)<-NULL
northSiteMixEntire_15N <- lm(north_mix$avg_d15N~north_mix$Date_mean)
northSiteMixEntire_13C <- lm(north_mix$avg_d13C_org~north_mix$Date_mean)
north[nrow(north)+1,]<-c("northSiteMix","Northeast",
  round(summary(northSiteMixEntire_13C)$coefficients[,4][2],digits = 5),
  round(northSiteMixEntire_13C$coefficients[2],digits = 5),
  round(summary(northSiteMixEntire_15N)$coefficients[,4][2],digits = 5),
  round(northSiteMixEntire_15N$coefficients[2],digits = 5),"Holocene")
north<-north[!is.na(north$pval_13C) | !is.na(north$pval_15N),]
#####################################################################

#EAST SITE BREAKDOWN
sites=c("Deloraine Farm","Egerton Cave","Fingira","Gishimangeda Cave", "Keringet Cave", "Kisima Farm", "Lukenya Hill", "Makangale Cave", "Molo Cave", "Naivasha")
site_select_AHP = list() 
site_select_tAHP = list() 
lmsite_15N_AHP = list() 
lmsite_15N_tAHP = list() 
lmsite_13C_AHP = list() 
lmsite_13C_tAHP = list()
for(site in sites){
  site_select_AHP[[site]] = all_h_e[all_h_e$Site==site & 
                               all_h_e$Date_mean <= -1500,]
  site_select_tAHP[[site]] = all_h_e[all_h_e$Site==site & 
                               all_h_e$Date_mean > -1500,]}
east_mix = all_h_e[all_h_e$Site=="Deloraine Farm" | all_h_e$Site=="Egerton Cave" | all_h_e$Site=="Fingira" | all_h_e$Site=="Gishimangeda Cave" | all_h_e$Site=="Keringet Cave" | all_h_e$Site=="Keringet Cave" | all_h_e$Site=="Kisima Farm" |all_h_e$Site=="Molo Cave" | all_h_e$Site=="Naivasha",] #lukenya hill & Makangale Cave: removed <1000 year avg
site_select_AHP[["eastSiteMix"]] = east_mix[east_mix$Date_mean <= -1500,]
site_select_tAHP[["eastSiteMix"]] = east_mix[east_mix$Date_mean > -1500,]
sites=c("Deloraine Farm","Egerton Cave","Fingira","Gishimangeda Cave", "Keringet Cave", "Kisima Farm", "Lukenya Hill", "Makangale Cave", "Molo Cave", "Naivasha", "eastSiteMix")
for(site in sites){
if(nrow(site_select_tAHP[[site]]) > 1 ){
  lmsite_15N_tAHP[[site]] <- lm(site_select_tAHP[[site]]$avg_d15N ~
                             site_select_tAHP[[site]]$Date_mean)
  lmsite_13C_tAHP[[site]] <- lm(site_select_tAHP[[site]]$avg_d13C_org ~
                             site_select_tAHP[[site]]$Date_mean)}else{
                             lmsite_15N_tAHP[[site]]=NA
                             lmsite_13C_tAHP[[site]]=NA}
if( nrow(site_select_AHP[[site]]) > 1 ){
  lmsite_15N_AHP[[site]] <- lm(site_select_AHP[[site]]$avg_d15N ~
                             site_select_AHP[[site]]$Date_mean)
  lmsite_13C_AHP[[site]] <- lm(site_select_AHP[[site]]$avg_d13C_org ~
                             site_select_AHP[[site]]$Date_mean)}else{
                             lmsite_15N_AHP[[site]]=NA
                             lmsite_13C_AHP[[site]]=NA}}
region=c("East","East","East","East","East","East","East","East","East","East","East")
pval_15N_AHP=c()
pval_15N_tAHP=c()
pval_13C_AHP=c()
pval_13C_tAHP=c()
slope_15N_AHP=c()
slope_15N_tAHP=c()
slope_13C_AHP=c()
slope_13C_tAHP=c()
for(site in sites){
if(nrow(site_select_AHP[[site]]) > 1 ){
pval_15N_AHP[site] = 
  round(summary(lmsite_15N_AHP[[site]])$coefficients[,4][2],digits = 5)
pval_13C_AHP[site] = 
  round(summary(lmsite_13C_AHP[[site]])$coefficients[,4][2],digits = 5)
slope_15N_AHP[site]=
  round(lmsite_15N_AHP[[site]]$coefficients[2],digits = 5)
slope_13C_AHP[site]=
  round(lmsite_13C_AHP[[site]]$coefficients[2],digits = 5)}else{
  pval_15N_AHP[site] = NA
  pval_13C_AHP[site] = NA
  slope_15N_AHP[site]= NA
  slope_13C_AHP[site]= NA}
if(nrow(site_select_tAHP[[site]]) > 1 ){
pval_15N_tAHP[site] = 
  round(summary(lmsite_15N_tAHP[[site]])$coefficients[,4][2],digits = 5)
pval_13C_tAHP[site] = 
  round(summary(lmsite_13C_tAHP[[site]])$coefficients[,4][2],digits = 5)
slope_15N_tAHP[site]=
  round(lmsite_15N_tAHP[[site]]$coefficients[2],digits = 5)
slope_13C_tAHP[site]=
  round(lmsite_13C_tAHP[[site]]$coefficients[2],digits = 5)}else{
  pval_15N_tAHP[site] = NA
  pval_13C_tAHP[site] = NA
  slope_15N_tAHP[site]= NA
  slope_13C_tAHP[site]=NA}}
#
pre_AHP_NE <- data.frame(sites, region, pval_13C_AHP, slope_13C_AHP, pval_15N_AHP, slope_15N_AHP)
pre_AHP_NE$timePeriod = "AHP"
colnames(pre_AHP_NE)<-c("site","region","pval_13C","slope_13C","pval_15N","slope_15N","timePeriod")
pre_tAHP_NE <- data.frame(sites, region, pval_13C_tAHP, slope_13C_tAHP, pval_15N_tAHP, slope_15N_tAHP)
pre_tAHP_NE$timePeriod = "postAHP"
colnames(pre_tAHP_NE)<-c("site","region","pval_13C","slope_13C","pval_15N","slope_15N","timePeriod")
east<-rbind(pre_AHP_NE,pre_tAHP_NE)
row.names(east)<-NULL
eastSiteMixEntire_15N <- lm(east_mix$avg_d15N~east_mix$Date_mean)
eastSiteMixEntire_13C <- lm(east_mix$avg_d13C_org~east_mix$Date_mean)
east[nrow(east)+1,]<-c("eastSiteMix","East",
  round(summary(eastSiteMixEntire_13C)$coefficients[,4][2],digits = 5),
  round(eastSiteMixEntire_13C$coefficients[2],digits = 5),
  round(summary(eastSiteMixEntire_15N)$coefficients[,4][2],digits = 5),
  round(eastSiteMixEntire_15N$coefficients[2],digits = 5),"Holocene")
east<-east[!is.na(east$pval_13C) | !is.na(east$pval_15N),]
#SOUTH SITE BREAKDOWN
######################
sites=c("Zitzikama", "Whichers Cave", "Von Bonde's Cave", "Tucker's Cave","Pearly Beach", "Nelson Bay Cave", "Melkbosstrand", "Tinley Manor","Somnaas", "Sedgefield", "Robberg", "Plettenberg Bay","Oliphantspoort", "Oakhurst", "Matjes River", "Knysna", "Groot Brak River", "Drury's Cave", "Byneskranskop", "Ballito Bay")
site_select_AHP = list() 
site_select_tAHP = list() 
lmsite_15N_AHP = list() 
lmsite_15N_tAHP = list() 
lmsite_13C_AHP = list() 
lmsite_13C_tAHP = list()
for(site in sites){
  site_select_AHP[[site]] = all_h_s[all_h_s$Site==site & 
                               all_h_s$Date_mean <= -1500,]
  site_select_tAHP[[site]] = all_h_s[all_h_s$Site==site & 
                               all_h_s$Date_mean > -1500,]}
south_mix = all_h_s[all_h_s$Site %in% sites & 
                      all_h_s$Site!="Melkbosstrand" &
                      all_h_s$Site!="Oliphantspoort",] #remove
site_select_AHP[["southSiteMix"]] = south_mix[south_mix$Date_mean <= -1500,]
site_select_tAHP[["southSiteMix"]] = south_mix[south_mix$Date_mean > -1500,]
sites=c("Zitzikama", "Whichers Cave", "Von Bonde's Cave", "Tucker's Cave","Pearly Beach", "Nelson Bay Cave", "Melkbosstrand", "Tinley Manor","Somnaas", "Sedgefield", "Robberg", "Plettenberg Bay","Oliphantspoort", "Oakhurst", "Matjes River", "Knysna", "Groot Brak River", "Drury's Cave", "Byneskranskop", "Ballito Bay", "southSiteMix")
for(site in sites){
if(nrow(site_select_tAHP[[site]]) > 1 ){
  lmsite_15N_tAHP[[site]] <- lm(site_select_tAHP[[site]]$avg_d15N ~
                             site_select_tAHP[[site]]$Date_mean)
  lmsite_13C_tAHP[[site]] <- lm(site_select_tAHP[[site]]$avg_d13C_org ~
                             site_select_tAHP[[site]]$Date_mean)}else{
                             lmsite_15N_tAHP[[site]]=NA
                             lmsite_13C_tAHP[[site]]=NA}
if( nrow(site_select_AHP[[site]]) > 1 ){
  lmsite_15N_AHP[[site]] <- lm(site_select_AHP[[site]]$avg_d15N ~
                             site_select_AHP[[site]]$Date_mean)
  lmsite_13C_AHP[[site]] <- lm(site_select_AHP[[site]]$avg_d13C_org ~
                             site_select_AHP[[site]]$Date_mean)}else{
                             lmsite_15N_AHP[[site]]=NA
                             lmsite_13C_AHP[[site]]=NA}}
pval_15N_AHP=c()
pval_15N_tAHP=c()
pval_13C_AHP=c()
pval_13C_tAHP=c()
slope_15N_AHP=c()
slope_15N_tAHP=c()
slope_13C_AHP=c()
slope_13C_tAHP=c()
for(site in sites){
if(nrow(site_select_AHP[[site]]) > 1 ){
pval_15N_AHP[site] = 
  round(summary(lmsite_15N_AHP[[site]])$coefficients[,4][2],digits = 5)
pval_13C_AHP[site] = 
  round(summary(lmsite_13C_AHP[[site]])$coefficients[,4][2],digits = 5)
slope_15N_AHP[site]=
  round(lmsite_15N_AHP[[site]]$coefficients[2],digits = 5)
slope_13C_AHP[site]=
  round(lmsite_13C_AHP[[site]]$coefficients[2],digits = 5)}else{
  pval_15N_AHP[site] = NA
  pval_13C_AHP[site] = NA
  slope_15N_AHP[site]= NA
  slope_13C_AHP[site]= NA}
if(nrow(site_select_tAHP[[site]]) > 1 ){
pval_15N_tAHP[site] = 
  round(summary(lmsite_15N_tAHP[[site]])$coefficients[,4][2],digits = 5)
pval_13C_tAHP[site] = 
  round(summary(lmsite_13C_tAHP[[site]])$coefficients[,4][2],digits = 5)
slope_15N_tAHP[site]=
  round(lmsite_15N_tAHP[[site]]$coefficients[2],digits = 5)
slope_13C_tAHP[site]=
  round(lmsite_13C_tAHP[[site]]$coefficients[2],digits = 5)}else{
  pval_15N_tAHP[site] = NA
  pval_13C_tAHP[site] = NA
  slope_15N_tAHP[site]= NA
  slope_13C_tAHP[site]=NA}}
for(i in 1:length(sites) ){ region[i] = "South"}
pre_AHP_NE <- data.frame(sites, region, pval_13C_AHP, slope_13C_AHP, pval_15N_AHP, slope_15N_AHP)
pre_AHP_NE$timePeriod = "AHP"
colnames(pre_AHP_NE)<-c("site","region","pval_13C","slope_13C","pval_15N","slope_15N","timePeriod")
pre_tAHP_NE <- data.frame(sites, region, pval_13C_tAHP, slope_13C_tAHP, pval_15N_tAHP, slope_15N_tAHP)
pre_tAHP_NE$timePeriod = "postAHP"
colnames(pre_tAHP_NE)<-c("site","region","pval_13C","slope_13C","pval_15N","slope_15N","timePeriod")
#
south<-rbind(pre_AHP_NE,pre_tAHP_NE)
row.names(south)<-NULL
southSiteMixEntire_15N <- lm(south_mix$avg_d15N~south_mix$Date_mean)
southSiteMixEntire_13C <- lm(south_mix$avg_d13C_org~south_mix$Date_mean)
south[nrow(south)+1,]<-c("southSiteMix","south",
  round(summary(southSiteMixEntire_13C)$coefficients[,4][2],digits = 5),
  round(southSiteMixEntire_13C$coefficients[2],digits = 5),
  round(summary(southSiteMixEntire_15N)$coefficients[,4][2],digits = 5),
  round(southSiteMixEntire_15N$coefficients[2],digits = 5),"Holocene")
  south<-south[!is.na(south$pval_13C) | !is.na(south$pval_15N),]
###################################
sitebased = rbind(north,east,south)
sitebased<-sitebased[sitebased$pval_13C !="NaN",]
sitebased$pval_13C<-format(as.numeric(sitebased$pval_13C,scientific=FALSE))
sitebased$pval_15N<-format(as.numeric(sitebased$pval_15N,scientific=FALSE))
sitebased$slope_13C<-format(as.numeric(sitebased$slope_13C,scientific=FALSE))
sitebased$slope_15N<-format(as.numeric(sitebased$slope_15N,scientific=FALSE))
sitebased$pval_15N[sitebased$pval_15N<0.05]<-"*"
sitebased$pval_13C[sitebased$pval_13C<0.05]<-"*"
sitebased$pval_15N[sitebased$pval_15N<0.01]<-"**"
sitebased$pval_13C[sitebased$pval_13C<0.01]<-"**"
sitebased$pval_15N[sitebased$pval_15N<0.001]<-"***"
sitebased$pval_13C[sitebased$pval_13C<0.001]<-"***"
sitebased<-sitebased[sitebased$pval_13C !="NaN" & sitebased$pval_13C=="**" | sitebased$pval_13C=="*"  |sitebased$pval_15N=="**" | sitebased$pval_15N=="*" |
                      sitebased$pval_15N=="***" | sitebased$pval_13C=="***" ,]
sitebased<-sitebased[,c("site","region","pval_13C","slope_13C","pval_15N","slope_15N","timePeriod")]
write.csv(sitebased,file="[path]0_Table1.csv",row.names = FALSE)
#
mix_n_select = all_h_ne[all_h_ne$Site=="Kerma"|all_h_ne$Site=="Gebelein"|all_h_ne$Site=="Kellis" | all_h_ne$Site=="Unspecified Egypt",] #Wadi Halfa removed (<1000 average year span)
mix_e_select = all_h_e[all_h_e$Site=="Fingira"|all_h_e$Site=="Gishimangeda Cave" | all_h_e$Site=="Keringet Cave" | all_h_e$Site=="Kisima Farm" | all_h_e$Site=="Naivasha",]
mix_s_select = all_h_s[all_h_s$Site=="Ballito Bay" | all_h_s$Site=="Byneskranskop" | all_h_s$Site=="Cape Agulhas" | all_h_s$Site=="Drury's Cave"|all_h_s$Site=="Muvenjes River",]
lmmix_n = lm(mix_n_select$avg_d15N~mix_n_select$Date_mean)
lmmix_n_13C = lm(mix_n_select$avg_d13C_org~mix_n_select$Date_mean)
lmmix_e = lm(mix_e_select$avg_d15N~mix_e_select$Date_mean)
lmmix_e_13C = lm(mix_e_select$avg_d13C_org~mix_e_select$Date_mean)
lmmix_s = lm(mix_s_select$avg_d15N~mix_s_select$Date_mean)
lmmix_s_13C = lm(mix_s_select$avg_d13C_org~mix_s_select$Date_mean)
########################
```
